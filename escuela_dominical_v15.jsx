const { useState, useEffect, useCallback, useRef, useMemo } = React;

const LOGO_SRC = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAHFBDgDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9U6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACio2l2gnaeKUSBlyOfpz/KgB9FND5BOOlOoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiikzQK6FoppcAA9fpzQX57fXNAx1FMLnsOPenGjYNxaKTNGaVwFooopgFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFJn2pC2Bk+maAGCccZBAPQmg3CA9Rj17fnXic+u+Ifjbrup6b4b1iXw74J02Z7O61u0Cm71KdDtlit2YEJGhyrScnIwK2o/2Y/AQjJurLUtRuGGGur7WbyaY/8AA2lJrO73LsluepiZWB2kH6H8q5/xp8Q9C+H2jtqeu30dlbZ2ovLyTMfupGi5Ls3ZRya8P8YX+t/s567ocXhm51Txppuu3L2UPhG+vzc3UMpUlJoJpCZBEpA372O1W3ZyMV3ngD4S3Sawvi3xvdJr/jJizQ7hm10tD/yytk6L7ucs3rRzMOVFC28R/E74ku0uiaba/D/QHXMd9r0fn6lIP7y2ykLGv/XRt3+zU6fA/wASTpvvvi34tnuv+elutrAn/fCxf1r13y+MZx9OKfT5Rcx4y3h/4q+AYDcaV4itfiHaRn5tM1mCOzugv/TKeJQpb2dce9df8PPixo/xGguI7aO403WLN/LvtG1BPLu7R/R0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hyDu7dh9f8f0p9FFADdvXmkCEfxenbrT6KAEyKaVBGCQR9KXbRtoAQR4XaOB6Din0UUAN2e56Y5700RbQMHGPT61JRQAU3Z055xjPenUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAH/9k=";

const C = {
  purple:"#5B2D8E", purpleDark:"#3D1B6B",
  yellow:"#F5C842", cyan:"#4BBCE0", cyanDark:"#2A96BC",
  pink:"#E84F9B", white:"#FFFFFF",
  bg:"#F5F0FF", text:"#2D1B4E", textLight:"#7B6B9A",
  border:"#DDD0F0", success:"#4CAF50", danger:"#EF5350",
};
const ADMIN_PASSWORD = "0130";
const DEFAULT_TEACHER_PASSWORD = "1234";

function flipName(str) {
  if (!str) return str;
  const parts = str.trim().split(/\s+/).filter(Boolean);
  if (parts.length < 2) return str;
  let apellido, nombre;
  if (parts.length === 4) {
    apellido = parts[0] + " " + parts[1];
    nombre = parts[2] + " " + parts[3];
  } else {
    const connectors = ["del","de","la","las","los","el","van","von","di","da","dos"];
    const apellidoEnd = connectors.includes(parts[0].toLowerCase()) ? 2 : 1;
    apellido = parts.slice(0, apellidoEnd).join(" ");
    nombre = parts.slice(apellidoEnd).join(" ");
  }
  if (!nombre) return str;
  const primerNombres = ["jos","jose","juan","mara","maria","carlos","pedro","ana","diana","luz","martha","mabel","deisy","blanca","vernica","veronica","andrs","andres","alejandro","samuel","valeria","cindy","astrid","lucy","michael","rosy","ngel","angelo","david","daniel","javier","jos lus","jose luis"];
  const nomParts = nombre.split(" ");
  if (nomParts.length === 2 && primerNombres.includes(nomParts[1].toLowerCase()) && !primerNombres.includes(nomParts[0].toLowerCase())) {
    nombre = nomParts[1] + " " + nomParts[0];
  }
  return nombre + " " + apellido;
}
// Compara dos nombres de alumno (pueden estar en distinto orden: "Nombre Apellido" vs "Apellido Nombre")
function samePersonName(a,b){
  if(!a||!b)return false;
  const x=a.trim(),y=b.trim();
  if(x===y)return true;
  const norm=(s)=>s.toLowerCase().replace(/\s+/g," ").split(" ").sort().join(" ");
  if(norm(x)===norm(y))return true;
  try{ if(flipName(x)===y||x===flipName(y))return true; }catch(e){}
  return false;
}
function confirmDelete(msg="Ests seguro de que deseas eliminar este registro? Esta accin no se puede deshacer.") {
  return window.confirm(msg);
}
// Compress image to max 160x160px, quality 0.65, returns base64 data URI
function compressImage(file, maxDim=160, quality=0.65) {
  return new Promise((resolve) => {
    const reader = new FileReader();
    reader.onload = (e) => {
      const img = new Image();
      img.onload = () => {
        const scale = Math.min(maxDim / img.width, maxDim / img.height, 1);
        const w = Math.round(img.width * scale);
        const h = Math.round(img.height * scale);
        const canvas = document.createElement("canvas");
        canvas.width = w; canvas.height = h;
        const ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0, w, h);
        resolve(canvas.toDataURL("image/jpeg", quality));
      };
      img.src = e.target.result;
    };
    reader.readAsDataURL(file);
  });
}

const INITIAL_MAESTROS = [
  { id:1, nombre:"Arboleda Diana", cargo:"MAESTRO", clase:"CONQUISTADORES", cumpleanos:"26/05", certificado:"SI" },
  { id:2, nombre:"Bohrquez Luz Mery", cargo:"MAESTRO", clase:"CORDERITOS", cumpleanos:"13/03", certificado:"NO" },
  { id:3, nombre:"Cano Ana", cargo:"MAESTRO", clase:"VENCEDORES", cumpleanos:"24/04", certificado:"SI" },
  { id:4, nombre:"Caro Martha", cargo:"MAESTRO", clase:"ADOLESCENTES", cumpleanos:null, certificado:null },
  { id:5, nombre:"Castrilln Deisy", cargo:"AUXILIAR", clase:"CORDERITOS", cumpleanos:"28/08", certificado:"SI" },
  { id:6, nombre:"Ceballos Yuliet", cargo:"MAESTRO", clase:"ADOLESCENTES", cumpleanos:"01/07", certificado:"SI" },
  { id:7, nombre:"Cedeo Mabel", cargo:"MAESTRO", clase:"CORDERITOS", cumpleanos:"12/06", certificado:"SI" },
  { id:8, nombre:"Cruz Rosy", cargo:"MAESTRO", clase:"CORDERITOS", cumpleanos:"09/07", certificado:"SI" },
  { id:9, nombre:"Del Castillo Astrid", cargo:"MAESTRO", clase:"CONQUISTADORES", cumpleanos:"22/02", certificado:"SI" },
  { id:10, nombre:"Daz Jos Hernn", cargo:"MAESTRO", clase:"ADOLESCENTES", cumpleanos:"10/03", certificado:"SI" },
  { id:11, nombre:"Giraldo Samuel", cargo:"AUXILIAR", clase:"VENCEDORES", cumpleanos:"16/05", certificado:"NO" },
  { id:12, nombre:"Giraldo Valeria", cargo:"AUXILIAR", clase:"VENCEDORES", cumpleanos:"08/09", certificado:"NO" },
  { id:13, nombre:"Hernndez Ana Mara", cargo:"MAESTRO", clase:"ADOLESCENTES", cumpleanos:"27/05", certificado:"SI" },
  { id:14, nombre:"Hernndez Blanca", cargo:"AUXILIAR", clase:"CORDERITOS", cumpleanos:"15/12", certificado:"SI" },
  { id:15, nombre:"Lavaire Marcela", cargo:"MAESTRO", clase:"CORDERITOS", cumpleanos:"10/06", certificado:"NO" },
  { id:16, nombre:"Mrquez Vernica", cargo:"AUXILIAR", clase:"VENCEDORES", cumpleanos:null, certificado:"NO" },
  { id:17, nombre:"Martnez Mara Jos", cargo:"MAESTRO", clase:"VENCEDORES", cumpleanos:"20/09", certificado:"NO" },
  { id:18, nombre:"Mogolln Jos Luis", cargo:"MAESTRO", clase:"ADOLESCENTES", cumpleanos:"17/05", certificado:"SI" },
  { id:19, nombre:"Mora Ana", cargo:"AUXILIAR", clase:"CONQUISTADORES", cumpleanos:"12/05", certificado:"SI" },
  { id:20, nombre:"Mora Lucy", cargo:"MAESTRO", clase:"CORDERITOS", cumpleanos:"21/05", certificado:"SI" },
  { id:21, nombre:"Muoz Cindy", cargo:"MAESTRO", clase:"CONQUISTADORES", cumpleanos:"30/01", certificado:"SI" },
  { id:22, nombre:"Ocampo Alejandro", cargo:"MAESTRO", clase:"VENCEDORES", cumpleanos:"21/03", certificado:"SI" },
  { id:23, nombre:"Peralta Astrid", cargo:"AUXILIAR", clase:"CONQUISTADORES", cumpleanos:"20/10", certificado:"SI" },
  { id:24, nombre:"Rodrguez Carlos", cargo:"MAESTRO", clase:"CONQUISTADORES", cumpleanos:"06/06", certificado:"SI" },
  { id:25, nombre:"Rodrguez Michael", cargo:"MAESTRO", clase:"VENCEDORES", cumpleanos:"25/02", certificado:"SI" },
  { id:26, nombre:"Seplveda Andrs", cargo:"MAESTRO", clase:"CONQUISTADORES", cumpleanos:"02/10", certificado:"SI" },
];

const INITIAL_CLASES = {
  CONQUISTADORES:[
    {id:"c1",nombre:"Bautista Marcos",edad:11},{id:"c2",nombre:"Cruz Salom",edad:10},
    {id:"c3",nombre:"Dubon Wilson",edad:10},{id:"c4",nombre:"Lauren Tello",edad:null},
    {id:"c5",nombre:"Loaiza Martina",edad:9},{id:"c6",nombre:"Mogollon David Luis",edad:11},
    {id:"c7",nombre:"Ramos Salom",edad:null},{id:"c8",nombre:"Sanz Jos David",edad:null},
  ],
  VENCEDORES:[
    {id:"v1",nombre:"vila Gabriel",edad:5},{id:"v2",nombre:"Daz Alicia",edad:6},
    {id:"v3",nombre:"Daghouj Karim",edad:5},{id:"v4",nombre:"Escalante Matas",edad:7},
    {id:"v5",nombre:"Loaiza Julia",edad:5},{id:"v6",nombre:"Morales Eva",edad:5},
    {id:"v7",nombre:"Morales Sara",edad:7},{id:"v8",nombre:"Palacios Amy",edad:7},
    {id:"v9",nombre:"Redn Javier",edad:null},
  ],
  CORDERITOS:[
    {id:"co1",nombre:"Contreras Avril",edad:4},{id:"co2",nombre:"Morales Abraham",edad:4},
    {id:"co3",nombre:"Muoz Mariano",edad:2},{id:"co4",nombre:"Luna",edad:null},{id:"co5",nombre:"Sofia",edad:null},
  ],
  ADOLESCENTES:[
    {id:"a1",nombre:"vila ngelo Gael",edad:13},{id:"a2",nombre:"Mogolln Jos Luis",edad:12},
    {id:"a3",nombre:"Lozano Daniel",edad:11},{id:"a4",nombre:"Daghouj Karima",edad:12},
    {id:"a5",nombre:"Maya Alejandro",edad:13},{id:"a6",nombre:"Hernndez Jhonatahn",edad:13},
    {id:"a7",nombre:"Giraldo Valeria",edad:null},{id:"a8",nombre:"Liam",edad:null},
  ],
};

const INITIAL_CRONOGRAMA = [
  {id:1,fecha:"2026-03-01",grupo:"CORDERITOS",leccion:"#5",tema:"DIOS ES MI PADRE",maestro:"Mora Lucy",auxiliar:"Hernndez Blanca"},
  {id:2,fecha:"2026-03-01",grupo:"VENCEDORES",leccion:"#5",tema:"DIOS ES NUESTRO AMIGO",maestro:"Seplveda Andrs",auxiliar:"Giraldo Samuel"},
  {id:3,fecha:"2026-03-01",grupo:"CONQUISTADORES",leccion:"#5",tema:"LA OBRA CUMBRE DEL CREADOR",maestro:"Del Castillo Astrid",auxiliar:"Mora Ana"},
  {id:4,fecha:"2026-03-01",grupo:"ADOLESCENTES",leccion:"NO HAY CLASE",tema:"",maestro:null,auxiliar:null},
  {id:5,fecha:"2026-03-08",grupo:"CORDERITOS",leccion:"#6",tema:"DIOS ES AMOR",maestro:"Bohrquez Luz Mery",auxiliar:"Castrilln Deisy"},
  {id:6,fecha:"2026-03-08",grupo:"VENCEDORES",leccion:"#6",tema:"DIOS ES OMNISCIENTE",maestro:"Rodrguez Michael",auxiliar:"Giraldo Valeria"},
  {id:7,fecha:"2026-03-08",grupo:"CONQUISTADORES",leccion:"#6",tema:"LA PERFECCIN DE LAS SAGRADAS ESCRITURAS",maestro:"Muoz Cindy",auxiliar:"Martnez Mara Jos"},
  {id:8,fecha:"2026-03-08",grupo:"ADOLESCENTES",leccion:"#7",tema:"JVENES HAGAN LAS COSAS CON AMOR",maestro:"Hernndez Ana Mara",auxiliar:null},
  {id:9,fecha:"2026-03-15",grupo:"CORDERITOS",leccion:"#7",tema:"DIOS ES NUESTRO AYUDADOR",maestro:"Lavaire Marcela",auxiliar:"Hernndez Blanca"},
  {id:10,fecha:"2026-03-15",grupo:"VENCEDORES",leccion:"#7",tema:"DIOS NOS PUEDE LIBRAR",maestro:"Cedeo Mabel",auxiliar:"Mrquez Vernica"},
  {id:11,fecha:"2026-03-15",grupo:"CONQUISTADORES",leccion:"#7",tema:"LA CONVERSIN DEL PECADOR",maestro:"Rodrguez Carlos",auxiliar:"Peralta Astrid"},
  {id:12,fecha:"2026-03-15",grupo:"ADOLESCENTES",leccion:"NO HAY CLASE",tema:"",maestro:null,auxiliar:null},
  {id:13,fecha:"2026-03-22",grupo:"CORDERITOS",leccion:"DIA DEL PADRE",tema:"",maestro:null,auxiliar:null},
  {id:14,fecha:"2026-03-22",grupo:"VENCEDORES",leccion:"DIA DEL PADRE",tema:"",maestro:null,auxiliar:null},
  {id:15,fecha:"2026-03-22",grupo:"CONQUISTADORES",leccion:"DIA DEL PADRE",tema:"",maestro:null,auxiliar:null},
  {id:16,fecha:"2026-03-22",grupo:"ADOLESCENTES",leccion:"#8",tema:"JVENES QUE SE GOZAN EN EL SEOR",maestro:"Mogolln Jos Luis",auxiliar:null},
  {id:17,fecha:"2026-03-29",grupo:"CORDERITOS",leccion:"#8",tema:"DIOS ES NUESTRO GUARDADOR",maestro:"Cruz Rosy",auxiliar:"Castrilln Deisy"},
  {id:18,fecha:"2026-03-29",grupo:"VENCEDORES",leccion:"#8",tema:"DIOS ES TODOPODEROSO",maestro:"Ocampo Alejandro",auxiliar:"Martnez Mara Jos"},
  {id:19,fecha:"2026-03-29",grupo:"CONQUISTADORES",leccion:"#8",tema:"LA VIDA NUEVA DEL CRISTIANO",maestro:"Arboleda Diana",auxiliar:"Mrquez Vernica"},
  {id:20,fecha:"2026-03-29",grupo:"ADOLESCENTES",leccion:"NO HAY CLASE",tema:"",maestro:null,auxiliar:null},
];

const INITIAL_FAMILIAS = [
  {id:1,num:1,familia:"vila Cruz",padre:"Gabriel vila",madre:"Rosibel Cruz",telPadre:"",telMadre:"",alumno:"ngelo Gael vila Cruz",edad:"13 aos",cumpleanos:"19/06",nacimiento:"19/06/2011",clase:"ADOLESCENTES"},
  {id:2,num:1,familia:"vila Cruz",padre:"Gabriel vila",madre:"Rosibel Cruz",telPadre:"",telMadre:"",alumno:"Gabriel vila Cruz",edad:"5 aos",cumpleanos:"14/03",nacimiento:"14/03/2019",clase:"VENCEDORES"},
  {id:3,num:2,familia:"Contreras Cano",padre:"Jess Contreras",madre:"Ana Cano",telPadre:"",telMadre:"",alumno:"Avril Nicole Contreras",edad:"4 aos",cumpleanos:"25/08",nacimiento:"25/08/2020",clase:"CORDERITOS"},
  {id:4,num:3,familia:"Mogolln Muoz",padre:"Jos Mogolln",madre:"Cindy Muoz",telPadre:"",telMadre:"",alumno:"Jos Luis Mogolln Muoz",edad:"12 aos",cumpleanos:"15/12",nacimiento:"15/12/2012",clase:"ADOLESCENTES"},
  {id:5,num:3,familia:"Mogolln Muoz",padre:"Jos Mogolln",madre:"Cindy Muoz",telPadre:"",telMadre:"",alumno:"David Luis Mogolln Muoz",edad:"10 aos",cumpleanos:"07/11",nacimiento:"07/11/2014",clase:"CONQUISTADORES"},
  {id:6,num:4,familia:"Daz Hernndez",padre:"Jos Hernn Daz",madre:"Ana Mara Hernndez",telPadre:"",telMadre:"",alumno:"Alicia Daz Hernndez",edad:"6 aos",cumpleanos:"05/08",nacimiento:"05/08/2018",clase:"VENCEDORES"},
  {id:7,num:4,familia:"Daz Hernndez",padre:"Jos Hernn Daz",madre:"Ana Mara Hernndez",telPadre:"",telMadre:"",alumno:"Emily Daz Hernndez",edad:"7 meses",cumpleanos:"27/05",nacimiento:"27/05/2024",clase:"CORDERITOS"},
  {id:8,num:5,familia:"Morales Cedeo",padre:"Pierre Morales",madre:"Mabel Cedeo",telPadre:"",telMadre:"",alumno:"Sara Morales Cedeo",edad:"7 aos",cumpleanos:"02/09",nacimiento:"02/09/2017",clase:"VENCEDORES"},
  {id:9,num:5,familia:"Morales Cedeo",padre:"Pierre Morales",madre:"Mabel Cedeo",telPadre:"",telMadre:"",alumno:"Eva Morales Cedeo",edad:"5 aos",cumpleanos:"23/07",nacimiento:"23/07/2019",clase:"VENCEDORES"},
  {id:10,num:5,familia:"Morales Cedeo",padre:"Pierre Morales",madre:"Mabel Cedeo",telPadre:"",telMadre:"",alumno:"Abraham Morales Cedeo",edad:"4 aos",cumpleanos:"26/11",nacimiento:"26/11/2023",clase:"CORDERITOS"},
  {id:11,num:6,familia:"Loaiza Arboleda",padre:"Carlos Andrs Loaiza",madre:"Diana Arboleda",telPadre:"",telMadre:"",alumno:"Martina Loaiza Arboleda",edad:"9 aos",cumpleanos:"02/10",nacimiento:"02/10/2015",clase:"CONQUISTADORES"},
  {id:12,num:6,familia:"Loaiza Arboleda",padre:"Carlos Andrs Loaiza",madre:"Diana Arboleda",telPadre:"",telMadre:"",alumno:"Julia Loaiza Arboleda",edad:"5 aos",cumpleanos:"20/04",nacimiento:"20/04/2019",clase:"VENCEDORES"},
  {id:13,num:7,familia:"Palacio Obando",padre:"(No registra)",madre:"Gloria Palacios",telPadre:"",telMadre:"",alumno:"Amy Palacio Obando",edad:"7 aos",cumpleanos:"26/10",nacimiento:"26/10/2017",clase:"VENCEDORES"},
  {id:14,num:8,familia:"Lozano Lpez",padre:"Mauricio Lozano",madre:"Gloria Yolanda Lpez",telPadre:"",telMadre:"",alumno:"Daniel Lozano Lpez",edad:"11 aos",cumpleanos:"04/07",nacimiento:"04/07/2013",clase:"ADOLESCENTES"},
  {id:15,num:9,familia:"Daghouj Hernndez",padre:"Souliman Daghouj",madre:"Blanca Hernndez",telPadre:"",telMadre:"",alumno:"Karima Daghouj Hernndez",edad:"12 aos",cumpleanos:"16/10",nacimiento:"16/10/2012",clase:"ADOLESCENTES"},
  {id:16,num:9,familia:"Daghouj Hernndez",padre:"Souliman Daghouj",madre:"Blanca Hernndez",telPadre:"",telMadre:"",alumno:"Karim Daghouj Hernndez",edad:"5 aos",cumpleanos:"23/07",nacimiento:"23/07/2019",clase:"VENCEDORES"},
  {id:17,num:10,familia:"Muoz Garca",padre:"Juan Ramn Muoz",madre:"Luz Dary Garca",telPadre:"",telMadre:"",alumno:"Mariano Andrs Muoz Garca",edad:"2 aos",cumpleanos:"19/07",nacimiento:"19/07/2022",clase:"CORDERITOS"},
  {id:18,num:11,familia:"(Bautista)",padre:"(No registra)",madre:"(No registra)",telPadre:"",telMadre:"",alumno:"Marcos David Bautista",edad:"11 aos",cumpleanos:"05/01",nacimiento:"05/01/2015",clase:"CONQUISTADORES"},
  {id:19,num:12,familia:"Cruz Enciso",padre:"Freddy Alexander Cruz",madre:"Francy Johana Enciso",telPadre:"",telMadre:"",alumno:"Salom Cruz Enciso",edad:"10 aos",cumpleanos:"30/11",nacimiento:"30/11/2014",clase:"CONQUISTADORES"},
  {id:20,num:13,familia:"Miranda Prez",padre:"Javier Miranda",madre:"Lesbia Prez",telPadre:"",telMadre:"",alumno:"Wilson Miranda Prez",edad:"10 aos",cumpleanos:"28/03",nacimiento:"28/03/2014",clase:"CONQUISTADORES"},
  {id:21,num:17,familia:"Sanz Mrquez",padre:null,madre:"Vernica Mrquez",telPadre:"",telMadre:"",alumno:"Jos David Sanz",edad:null,cumpleanos:null,nacimiento:null,clase:"CONQUISTADORES"},
  {id:22,num:18,familia:"Ramos",padre:null,madre:null,telPadre:"",telMadre:"",alumno:"Salom Ramos",edad:null,cumpleanos:null,nacimiento:null,clase:"CONQUISTADORES"},
  {id:23,num:19,familia:"Rendn",padre:null,madre:null,telPadre:"",telMadre:"",alumno:"Javier Rendn",edad:null,cumpleanos:null,nacimiento:null,clase:"VENCEDORES"},
  {id:24,num:20,familia:null,padre:null,madre:null,telPadre:"",telMadre:"",alumno:"Lauren",edad:null,cumpleanos:null,nacimiento:null,clase:"CONQUISTADORES"},
  {id:25,num:21,familia:null,padre:null,madre:"Jennifer",telPadre:"",telMadre:"",alumno:"Liam",edad:null,cumpleanos:null,nacimiento:null,clase:"ADOLESCENTES"},
  {id:26,num:22,familia:"Giraldo Ceballos",padre:null,madre:"Yuliet Ceballos",telPadre:"",telMadre:"",alumno:"Valeria Giraldo",edad:null,cumpleanos:null,nacimiento:null,clase:"ADOLESCENTES"},
];

// Una sola base de datos de alumnos; clases y familias se derivan de aqu.
const INITIAL_ALUMNOS = INITIAL_FAMILIAS.map(f=>({
  id: f.id,
  nombre: (f.alumno||"").trim(),
  clase: (f.clase||"").trim().toUpperCase().replace(/\s+/g,"_")||"CORDERITOS",
  nacimiento: f.nacimiento||null,
  padre: f.padre||"",
  madre: f.madre||"",
  telPadre: f.telPadre||"",
  telMadre: f.telMadre||"",
  familia: f.familia||"",
  bautizado: !!f.bautizado,
  sellado: !!f.sellado,
  foto: f.foto||null,
}));

function normalizarClase(c){ return (c||"").trim().toUpperCase().replace(/\s+/g,"_")||"CORDERITOS"; }

const INITIAL_EVENTOS = [
  {id:1,fecha:"07/02/2026",tipo:"NACIONAL",nombre:"Ayuno Nacional de Maestros"},
  {id:2,fecha:"25/04/2026",tipo:"NACIONAL",nombre:"Congreso Nacional de Maestros"},
  {id:3,fecha:"15/05/2026",tipo:"NACIONAL",nombre:"Seminario Virtual: Innovacin en la enseanza bblica"},
  {id:4,fecha:"20/06/2026",tipo:"NACIONAL",nombre:"Da Nacional de Apologtica Infantil"},
  {id:5,fecha:"18/07/2026",tipo:"NACIONAL",nombre:"Evangelismo Infantil Nacional"},
  {id:6,fecha:"1ra Sem Sep",tipo:"NACIONAL",nombre:"Semana Vuelta al Colegio - Programa de oracin"},
  {id:7,fecha:"13/09/2026",tipo:"NACIONAL",nombre:"Domingo Nacional del Nio Misionero"},
  {id:8,fecha:"07/11/2026",tipo:"NACIONAL",nombre:"Vigilia Nacional para Nios Online"},
  {id:9,fecha:"15/02/2026",tipo:"LOCAL",nombre:"Taller de Maestros: Evaluacin y Capacidad"},
  {id:10,fecha:"15/03/2026",tipo:"LOCAL",nombre:"Taller de Padres: Caja de dudas y sugerencias"},
  {id:11,fecha:"19/04/2026",tipo:"LOCAL",nombre:"Da del Nio (Celebracin local)"},
  {id:12,fecha:"21/06/2026",tipo:"LOCAL",nombre:"Taller de Nios: Contra la ideologa de gnero"},
  {id:13,fecha:"18/07/2026",tipo:"LOCAL",nombre:"Integracin Evangelstica"},
  {id:14,fecha:"11-16 Ago",tipo:"LOCAL",nombre:"Escuela Bblica Vacacional"},
  {id:15,fecha:"20/09/2026",tipo:"LOCAL",nombre:"Nio Misionero"},
  {id:16,fecha:"31/10/2026",tipo:"LOCAL",nombre:"Somos nios de luz, celebramos la vida"},
  {id:17,fecha:"15/11/2026",tipo:"LOCAL",nombre:"Taller de Maestros (Da del maestro)"},
  {id:18,fecha:"20/12/2026",tipo:"LOCAL",nombre:"Taller de Padres"},
  {id:19,fecha:"17/01/2027",tipo:"LOCAL",nombre:"Clausura y Grado de Escuela Dominical"},
];

const INITIAL_EVALUACIONES = [
  {nombre:"Arboleda Diana",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:4,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Bohrquez Luz Mery",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:4,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Cano Ana",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:null,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Castrilln Deisy",dominioBiblico:4,habilidadEnsenar:4,claridadComunicarse:4,recursosVisuales:5,manejoGrupo:4,empatia:5,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Ceballos Yuliet",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:null,manejoGrupo:5,empatia:4,creatividad:null,preparacion:5,compromiso:4,aplicacionPractica:5},
  {nombre:"Cedeo Mabel",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:4,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Cruz Rosy",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:5,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Del Castillo Astrid",dominioBiblico:5,habilidadEnsenar:4,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:4,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Hernndez Blanca",dominioBiblico:4,habilidadEnsenar:4,claridadComunicarse:4,recursosVisuales:4,manejoGrupo:4,empatia:4,creatividad:4,preparacion:4,compromiso:4,aplicacionPractica:5},
  {nombre:"Hernndez Ana Mara",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:5,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:null},
  {nombre:"Mogolln Jos Luis",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:5,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Mora Lucy",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:5,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Mora Ana",dominioBiblico:4,habilidadEnsenar:4,claridadComunicarse:4,recursosVisuales:5,manejoGrupo:4,empatia:4,creatividad:4,preparacion:5,compromiso:4,aplicacionPractica:5},
  {nombre:"Peralta Astrid",dominioBiblico:4,habilidadEnsenar:4,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:4,empatia:4,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Ocampo Alejandro",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:5,creatividad:4,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Rodrguez Michael",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:5,creatividad:5,preparacion:5,compromiso:5,aplicacionPractica:5},
  {nombre:"Rodrguez Carlos",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:5,creatividad:5,preparacion:5,compromiso:4,aplicacionPractica:5},
  {nombre:"Seplveda Andrs",dominioBiblico:5,habilidadEnsenar:5,claridadComunicarse:5,recursosVisuales:5,manejoGrupo:5,empatia:5,creatividad:5,preparacion:4,compromiso:4,aplicacionPractica:5},
];

const CRITERIOS = [
  {logro:"VALORES",key:"valores",item:"Amor, respeto y obediencia"},
  {logro:"CONOCIMIENTO",key:"conocimiento",item:"Historias bblicas"},
  {logro:"ORACIN",key:"oracion",item:"Hbito de oracin"},
  {logro:"SERVICIO",key:"servicio",item:"Compartir y ayudar"},
  {logro:"RESPETO",key:"respeto",item:"Respeto hacia los dems"},
  {logro:"PARTICIPACIN",key:"participacion",item:"Actividades grupales"},
  {logro:"COMPORTAMIENTO",key:"comportamiento",item:"Conducta en aula"},
];

const CLASES_LIST = ["CORDERITOS","VENCEDORES","CONQUISTADORES","ADOLESCENTES"];
const CLASE_COLORS = {CORDERITOS:"#4BBCE0",VENCEDORES:"#F5C842",CONQUISTADORES:"#5B2D8E",ADOLESCENTES:"#E84F9B"};

// Maestros autorizados exclusivamente para la clase ADOLESCENTES (sin auxiliar)
const ADOLESCENTES_MAESTROS = [
  "Mogolln Jos Luis",
  "Caro Martha",
  "Ceballos Yuliet",
  "Hernndez Ana Mara",
  "Daz Jos Hernn",
];

// Helpers para config dinmica de clases
const DEFAULT_CLASES_CONFIG = CLASES_LIST.map(k=>({key:k,nombre:k,color:CLASE_COLORS[k]}));
function getCfgList(clasesConfig){return clasesConfig&&clasesConfig.length?clasesConfig:DEFAULT_CLASES_CONFIG;}
function getCfgColor(key,clasesConfig){return getCfgList(clasesConfig).find(c=>c.key===key)?.color||CLASE_COLORS[key]||"#5B2D8E";}
function getCfgKeys(clasesConfig){return getCfgList(clasesConfig).map(c=>c.key);}
function deriveClases(alumnos,clasesConfig){
  const keys=getCfgKeys(clasesConfig);
  const out={};
  keys.forEach(k=>{ out[k]=[]; });
  (alumnos||[]).forEach(a=>{
    const key=normalizarClase(a.clase);
    if(!out[key])out[key]=[];
    let edad=null,cumpleanos=null;
    if(a.nacimiento){
      try{
        const d=new Date(a.nacimiento);
        const hoy=new Date();
        edad=String(hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0));
        cumpleanos=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;
      }catch(e){}
    }
    out[key].push({ id: a.id, nombre: a.nombre, edad, foto: a.foto||null, nacimiento: a.nacimiento, cumpleanos, bautizado: !!a.bautizado, sellado: !!a.sellado });
  });
  return out;
}
function deriveFamilias(alumnos){
  const groups={};
  (alumnos||[]).forEach(a=>{
    const key=((a.padre||"").trim()+"|"+(a.madre||"").trim())||(a.familia||a.nombre)||"";
    if(!groups[key])groups[key]=[];
    groups[key].push(a);
  });
  let numCounter=0;
  const derived=[];
  Object.values(groups).forEach(members=>{
    numCounter++;
    const first=members[0];
    members.forEach(a=>{
      let edad=null,cumpleanos=null;
      if(a.nacimiento){
        try{
          const d=new Date(a.nacimiento);
          const hoy=new Date();
          edad=String(hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0));
          cumpleanos=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;
        }catch(e){}
      }
      derived.push({ id: a.id, num: numCounter, familia: first.familia||first.padre||first.madre||first.nombre||"", padre: a.padre||"", madre: a.madre||"", telPadre: a.telPadre||"", telMadre: a.telMadre||"", alumno: a.nombre, edad, cumpleanos, nacimiento: a.nacimiento||"", clase: normalizarClase(a.clase), bautizado: !!a.bautizado, sellado: !!a.sellado, foto: a.foto||null });
    });
  });
  return derived;
}
const CLASE_COLORS_FN=(key,cfg)=>getCfgColor(key,cfg);
const EVAL_KEYS = ["dominioBiblico","habilidadEnsenar","claridadComunicarse","recursosVisuales","manejoGrupo","empatia","creatividad","preparacion","compromiso","aplicacionPractica","cumplimientoClases"];
const EVAL_LABELS = ["Dominio Bblico","Habilidad Ensear","Claridad","Recursos Visuales","Manejo Grupo","Empata","Creatividad","Preparacin","Compromiso","Aplicacin Prctica"," Cumplimiento de Clases"];

//  Firebase Firestore + GitHub (sin Vercel). Datos y sincronizacin en tiempo real. 
const FIREBASE_CONFIG={
  apiKey:"AIzaSyDmnkl-h4HoHov3Nb4FV80uEnfC9GpqRxU",
  authDomain:"escueladominicalipuevp.firebaseapp.com",
  projectId:"escueladominicalipuevp",
  storageBucket:"escueladominicalipuevp.firebasestorage.app",
  messagingSenderId:"336792465529",
  appId:"1:336792465529:web:694cd9a6ce7453cd6a64a8"
};
const FIRESTORE_COLLECTION="ed_data";

function getDb(){
  if(typeof firebase==="undefined"||!FIREBASE_CONFIG)return null;
  try{
    if(!firebase.apps.length)firebase.initializeApp(FIREBASE_CONFIG);
    return firebase.firestore();
  }catch(e){return null;}
}
const db=getDb();

async function loadData(key){
  try{
    if(db){
      const snap=await db.collection(FIRESTORE_COLLECTION).doc(key).get();
      const raw=snap.exists?snap.data().value:null;
      return raw!=null?JSON.parse(raw):null;
    }
    if(typeof window.storage!=="undefined"){
      const r=await window.storage.get(key);
      return r?JSON.parse(r.value):null;
    }
    const raw=localStorage.getItem("ed_"+key);
    return raw!=null?JSON.parse(raw):null;
  }catch(e){return null;}
}

async function saveData(key,val){
  try{
    if(db){
      await db.collection(FIRESTORE_COLLECTION).doc(key).set({value:JSON.stringify(val)},{merge:true});
      return;
    }
    if(typeof window.storage!=="undefined"){
      await window.storage.set(key,JSON.stringify(val));
      return;
    }
    localStorage.setItem("ed_"+key,JSON.stringify(val));
  }catch(e){}
}

function subscribeData(onChange){
  if(!db)return ()=>{};
  return db.collection(FIRESTORE_COLLECTION).onSnapshot(snap=>{
    snap.docChanges().forEach(change=>{
      const key=change.doc.id;
      try{
        const v=change.doc.data().value;
        onChange(key,v!=null?JSON.parse(v):null);
      }catch(e){}
    });
  });
}

function getInitials(n){if(!n)return"?";const fn=flipName(n);return fn.split(" ").map(w=>w[0]).slice(0,2).join("").toUpperCase();}
function evalAvg(ev,videoAvg=null){
  const v=EVAL_KEYS.map(k=>ev[k]).filter(x=>x!=null);
  if(!v.length)return "";
  const base=v.reduce((a,b)=>a+b,0)/v.length;
  if(videoAvg!=null){
    // video score (0-5) blends in as 20% of total
    return ((base*0.8)+(videoAvg*0.2)).toFixed(1);
  }
  return base.toFixed(1);
}
// Calcula score de video 0-5 por sesin
function videoScore(v){
  if(!v||!v.hizo)return 0;
  // hizo: base 1 (ya sabemos hizo), calidad 1-5, aTiempo +1 bonus
  const raw=(v.calidad||3)+(v.aTiempo?1:0); // 1-6
  return Math.min(5,(raw/6)*5);
}
// Promedio de videos de un maestro (0-5)
function videoAvgForMaestro(maestroNombre,videos){
  const vs=(videos||[]).filter(v=>v.maestro===maestroNombre);
  if(!vs.length)return null;
  const scored=vs.map(videoScore);
  return scored.reduce((a,b)=>a+b,0)/scored.length;
}
// Clases que requieren video semanal
const VIDEO_CLASES=["CORDERITOS","VENCEDORES","CONQUISTADORES"];
function scoreColor(v){const n=parseFloat(v);if(isNaN(n))return"#9E9E9E";return n>=8?"#4CAF50":n>=6?"#F5A623":"#EF5350";}
function formatFecha(str){if(!str)return"";try{const[y,m,d]=str.split("-");return`${d} ${["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"][parseInt(m)-1]}`;}catch(e){return str;}}

function getBirthdays(maestros,familias){
  const today=new Date();today.setHours(0,0,0,0);
  const parseDDMM=(str)=>{if(!str)return null;const parts=str.split("/");if(parts.length<2)return null;const[d,m]=parts.map(Number);if(!d||!m)return null;let dt=new Date(today.getFullYear(),m-1,d);if(dt<today)dt=new Date(today.getFullYear()+1,m-1,d);return dt;};
  const parseNacimiento=(str)=>{if(!str)return null;try{const d=new Date(str);if(isNaN(d.getTime()))return null;const dd=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;let dt=new Date(today.getFullYear(),d.getMonth(),d.getDate());if(dt<today)dt=new Date(today.getFullYear()+1,d.getMonth(),d.getDate());return {dt,fecha:dd};}catch(e){return null;}};
  const result=[];
  maestros.forEach(mx=>{
    let dt,fecha;
    if(mx.nacimiento){const r=parseNacimiento(mx.nacimiento);if(r){dt=r.dt;fecha=r.fecha;}}
    else{dt=parseDDMM(mx.cumpleanos);fecha=mx.cumpleanos;}
    if(dt&&fecha){const diff=Math.round((dt-today)/86400000);result.push({nombre:flipName(mx.nombre),tipo:mx.cargo,clase:mx.clase,fecha,diff,categoria:"maestro"});}
  });
  familias.forEach(f=>{const dt=parseDDMM(f.cumpleanos);if(dt){const diff=Math.round((dt-today)/86400000);result.push({nombre:flipName(f.alumno),tipo:"ALUMNO",clase:f.clase,fecha:f.cumpleanos,diff,categoria:"alumno"});}});
  return result.sort((a,b)=>a.diff-b.diff);
}

const S={
  card:{background:"#FFFFFF",borderRadius:16,boxShadow:"0 2px 16px rgba(91,45,142,0.09)",padding:"1rem",marginBottom:14},
  btn:(bg="#5B2D8E",color="#FFFFFF",full=false)=>({background:bg,color,border:"none",borderRadius:12,padding:"0.7rem 1.1rem",fontWeight:700,cursor:"pointer",fontSize:"0.875rem",width:full?"100%":undefined,display:"block",textAlign:"center",fontFamily:"inherit",lineHeight:1.2,WebkitTapHighlightColor:"transparent"}),
  input:{border:"2px solid #DDD0F0",borderRadius:12,padding:"0.75rem 1rem",fontSize:"1rem",outline:"none",width:"100%",boxSizing:"border-box",fontFamily:"inherit",color:"#2D1B4E",background:"#FFFFFF"},
  badge:(color)=>({background:color+"22",color,borderRadius:20,padding:"3px 12px",fontSize:"0.75rem",fontWeight:700,display:"inline-block",whiteSpace:"nowrap"}),
  tag:(color)=>({background:color,color:color==="#F5C842"?"#3D1B6B":"#FFFFFF",borderRadius:8,padding:"3px 10px",fontSize:"0.6875rem",fontWeight:700,display:"inline-block"}),
  label:{fontSize:"0.8125rem",fontWeight:700,color:"#7B6B9A",display:"block",marginBottom:6},
  title:{fontSize:"1.25rem",fontWeight:900,color:"#5B2D8E",margin:"0 0 1rem",letterSpacing:-0.5},
};

//  Logo with elegant gradient border & edge fade 
function LogoImg({height=44}){
  return(
    <div style={{display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative"}}>
      <div style={{position:"absolute",inset:-3,borderRadius:18,background:"linear-gradient(135deg,#4BBCE0,#5B2D8E,#E84F9B)",opacity:0.4,filter:"blur(5px)"}}/>
      <div style={{position:"relative",background:"#FFFFFF",borderRadius:16,padding:"5px 12px",overflow:"hidden",boxShadow:"0 4px 18px rgba(91,45,142,0.18)",WebkitMaskImage:"radial-gradient(ellipse 94% 90% at 50% 50%,black 70%,transparent 100%)",maskImage:"radial-gradient(ellipse 94% 90% at 50% 50%,black 70%,transparent 100%)"}}>
        <img src={LOGO_SRC} alt="Escuela Dominical IPUE" style={{height,width:"auto",display:"block"}}/>
      </div>
    </div>
  );
}
function LogoLogin(){
  return(
    <div style={{display:"flex",justifyContent:"center",marginBottom:16}}>
      <div style={{position:"relative"}}>
        <div style={{position:"absolute",inset:-5,borderRadius:24,background:"linear-gradient(135deg,#4BBCE0,#5B2D8E,#E84F9B)",opacity:0.45,filter:"blur(10px)"}}/>
        <div style={{position:"relative",background:"#FFFFFF",borderRadius:20,padding:"10px 20px",boxShadow:"0 8px 32px rgba(91,45,142,0.2)",WebkitMaskImage:"radial-gradient(ellipse 92% 88% at 50% 50%,black 65%,transparent 100%)",maskImage:"radial-gradient(ellipse 92% 88% at 50% 50%,black 65%,transparent 100%)",maxWidth:"100%"}}>
          <img src={LOGO_SRC} alt="Logo" style={{width:240,maxWidth:"100%",height:"auto",display:"block"}}/>
        </div>
      </div>
    </div>
  );
}

// Reusable avatar uploader (compressed)
function AvatarUpload({ photo, onPhoto, size=56, initials="?", color="#5B2D8E" }) {
  const ref = useRef(null);
  const handleChange = async (e) => {
    const file = e.target.files[0];
    if (!file) return;
    const compressed = await compressImage(file, 160, 0.65);
    onPhoto(compressed);
  };
  return (
    <div style={{ position:"relative", width:size, height:size, flexShrink:0 }}>
      {photo
        ? <img src={photo} alt="foto" style={{ width:size, height:size, borderRadius:"50%", objectFit:"cover", border:`3px solid ${color}` }} />
        : <div style={{ width:size, height:size, borderRadius:"50%", background:color+"33", display:"flex", alignItems:"center", justifyContent:"center", fontWeight:800, fontSize:Math.round(size*0.3), color, border:`3px solid ${color}55` }}>{initials}</div>
      }
      <button onClick={(e)=>{e.stopPropagation();ref.current.click();}} style={{ position:"absolute", bottom:-2, right:-2, width:22, height:22, borderRadius:"50%", background:color, border:"2px solid #FFFFFF", cursor:"pointer", fontSize:11, color:"#FFFFFF", display:"flex", alignItems:"center", justifyContent:"center", padding:0 }}></button>
      <input ref={ref} type="file" accept="image/*" style={{ display:"none" }} onChange={handleChange} />
    </div>
  );
}

function Modal({open,onClose,title,children}){
  if(!open)return null;
  return(
    <div data-modal-overlay style={{position:"fixed",inset:0,background:"rgba(30,10,60,0.65)",display:"flex",alignItems:"flex-end",justifyContent:"center",zIndex:1000,backdropFilter:"blur(4px)",overflow:"hidden",overscrollBehavior:"contain"}} onClick={e=>{if(e.target===e.currentTarget)onClose();}}>
      <div data-modal-content style={{background:"#FFFFFF",borderRadius:"24px 24px 0 0",padding:"1rem 1rem 1.5rem",width:"100%",maxWidth:520,maxHeight:"92vh",overflowY:"auto",overflowX:"hidden",boxShadow:"0 -8px 40px rgba(0,0,0,0.25)",minWidth:0,WebkitOverflowScrolling:"touch"}} onClick={e=>e.stopPropagation()}>
        <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",minWidth:0}}>
          <h3 style={{color:"#5B2D8E",fontWeight:800,fontSize:"1.0625rem",margin:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{title}</h3>
          <button onClick={onClose} style={{background:"#F5F0FF",border:"none",borderRadius:"50%",width:32,height:32,fontSize:18,cursor:"pointer",flexShrink:0}}></button>
        </div>
        <div style={{overflowX:"hidden",minWidth:0,maxWidth:"100%"}}>{children}</div>
      </div>
    </div>
  );
}

function BottomNav({tabs,active,onSelect}){
  return(
    <nav style={{position:"fixed",bottom:0,left:0,right:0,background:"#FFFFFF",borderTop:"2px solid #DDD0F0",display:"flex",zIndex:200,boxShadow:"0 -4px 20px rgba(91,45,142,0.12)",paddingBottom:"env(safe-area-inset-bottom,0)"}}>
      {tabs.map(t=>(
        <button key={t.id} onClick={()=>onSelect(t.id)} style={{flex:1,background:"none",border:"none",cursor:"pointer",padding:"10px 2px 8px",display:"flex",flexDirection:"column",alignItems:"center",gap:3,color:active===t.id?"#5B2D8E":"#7B6B9A",fontFamily:"inherit",WebkitTapHighlightColor:"transparent"}}>
          <span style={{fontSize:22}}>{t.icon}</span>
          <span style={{fontSize:9,fontWeight:active===t.id?800:600}}>{t.label}</span>
          {active===t.id&&<div style={{width:18,height:3,background:"#5B2D8E",borderRadius:2}}/>}
        </button>
      ))}
    </nav>
  );
}

function StatCard({icon,value,label,color="#5B2D8E"}){
  return(
    <div style={{background:"#FFFFFF",borderRadius:16,padding:"14px 16px",boxShadow:"0 2px 12px rgba(91,45,142,0.09)",borderLeft:`5px solid ${color}`,display:"flex",alignItems:"center",gap:12}}>
      <div style={{fontSize:26,width:46,height:46,background:color+"20",borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}}>{icon}</div>
      <div><div style={{fontSize:24,fontWeight:900,color,lineHeight:1}}>{value}</div><div style={{fontSize:11,color:"#7B6B9A",fontWeight:600,marginTop:2}}>{label}</div></div>
    </div>
  );
}

function BirthdayBanner({maestros,familias}){
  const all=getBirthdays(maestros,familias);
  const todayBirths=all.filter(b=>b.diff===0);
  const next=all.find(b=>b.diff>0);
  if(!todayBirths.length&&!next)return null;
  return(
    <div style={{margin:"0 16px 14px"}}>
      {todayBirths.map((b,i)=>(
        <div key={i} style={{background:"linear-gradient(135deg,#E84F9B,#F27DB8)",borderRadius:16,padding:"14px 16px",display:"flex",alignItems:"center",gap:12,marginBottom:8,boxShadow:"0 4px 16px rgba(232,79,155,0.3)"}}>
          <span style={{fontSize:32}}></span>
          <div><div style={{color:"#FFFFFF",fontWeight:900,fontSize:16}}>Cumpleaos hoy!</div><div style={{color:"rgba(255,255,255,0.9)",fontWeight:700,fontSize:14}}>{b.nombre}</div><div style={{color:"rgba(255,255,255,0.75)",fontSize:12}}>{b.tipo}{b.clase&&b.categoria==="alumno"?"  "+b.clase:""}</div></div>
        </div>
      ))}
      {next&&(
        <div style={{background:"linear-gradient(135deg,#5B2D8E,#7B4DB2)",borderRadius:16,padding:"0.75rem 1rem",display:"flex",alignItems:"center",gap:12,boxShadow:"0 4px 16px rgba(91,45,142,0.2)"}}>
          <span style={{fontSize:26}}></span>
          <div style={{flex:1}}><div style={{color:"#F5C842",fontWeight:800,fontSize:12}}>Prximo cumpleaos</div><div style={{color:"#FFFFFF",fontWeight:700,fontSize:14}}>{next.nombre}</div><div style={{color:"rgba(255,255,255,0.7)",fontSize:12}}>{next.tipo}{next.clase&&next.categoria==="alumno"?"  "+next.clase:""}  {next.fecha}</div></div>
          <span style={{background:"rgba(255,255,255,0.2)",color:"#FFFFFF",borderRadius:10,padding:"4px 10px",fontWeight:800,fontSize:13}}>En {next.diff}d</span>
        </div>
      )}
    </div>
  );
}


//  ERROR BOUNDARY 
// Catches render errors and shows a friendly message instead of blank page
class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }
  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }
  componentDidCatch(error, info) {
    console.error("ErrorBoundary caught:", error, info);
  }
  render() {
    if (this.state.hasError) {
      return (
        <div style={{padding:32,textAlign:"center",fontFamily:"system-ui"}}>
          <div style={{fontSize:48,marginBottom:16}}></div>
          <div style={{fontSize:20,fontWeight:800,color:"#5B2D8E",marginBottom:8}}>Algo sali mal</div>
          <div style={{fontSize:13,color:"#7B6B9A",marginBottom:24}}>{this.state.error?.message||"Error desconocido"}</div>
          <button
            onClick={()=>this.setState({hasError:false,error:null})}
            style={{background:"#5B2D8E",color:"#FFF",border:"none",borderRadius:10,padding:"10px 24px",fontSize:14,cursor:"pointer",fontWeight:700}}
          > Reintentar</button>
        </div>
      );
    }
    return this.props.children;
  }
}

//  LOGIN 
function LoginScreen({onLogin}){
  const [mode,setMode]=useState("select");
  const [adminPw,setAdminPw]=useState("");
  const [teacherName,setTeacherName]=useState("");
  const [teacherPw,setTeacherPw]=useState("");
  const [error,setError]=useState("");
  const [maestros,setMaestros]=useState(INITIAL_MAESTROS);
  const [passwords,setPasswords]=useState({});
  useEffect(()=>{loadData("maestros").then(d=>{if(d)setMaestros(d);});loadData("teacherPasswords").then(d=>{if(d)setPasswords(d);});},[]);
  const handleTeacher=()=>{
    if(!teacherName){setError("Selecciona tu nombre");return;}
    if(teacherPw!==(passwords[teacherName]||DEFAULT_TEACHER_PASSWORD)){setError("Contrasea incorrecta");return;}
    onLogin({role:"teacher",name:teacherName});
  };
  return(
    <div style={{minHeight:"100dvh",background:"linear-gradient(160deg,#3D1B6B 0%,#5B2D8E 55%,#2A96BC 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1.5rem 1rem",boxSizing:"border-box",position:"relative",overflow:"hidden"}}>
      <div style={{position:"absolute",top:-80,right:-80,width:280,height:280,background:"#E84F9B44",borderRadius:"50%",filter:"blur(40px)"}}/>
      <div style={{position:"absolute",bottom:-60,left:-60,width:240,height:240,background:"#4BBCE044",borderRadius:"50%",filter:"blur(40px)"}}/>
      <div style={{background:"rgba(255,255,255,0.97)",borderRadius:28,padding:"1.5rem 1.25rem",width:"100%",maxWidth:400,boxShadow:"0 24px 80px rgba(0,0,0,0.35)",position:"relative",zIndex:1}}>
        <LogoLogin/>
        <div style={{textAlign:"center",marginBottom:24,fontSize:11,color:"#7B6B9A",fontWeight:700,letterSpacing:2,textTransform:"uppercase"}}>Villanueva del Pardillo</div>
        {mode==="select"&&(
          <div style={{display:"flex",flexDirection:"column",gap:14}}>
            <h3 style={{textAlign:"center",color:"#5B2D8E",fontWeight:800,margin:"0 0 4px",fontSize:18}}>Cmo deseas entrar?</h3>
            <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:"16px",fontSize:16,borderRadius:16}} onClick={()=>setMode("admin")}> Administrador</button>
            <button style={{...S.btn("#4BBCE0","#FFFFFF",true),padding:"16px",fontSize:16,borderRadius:16}} onClick={()=>setMode("teacher")}> Soy Maestro / Auxiliar</button>
          </div>
        )}
        {mode==="admin"&&(
          <div>
            <h3 style={{textAlign:"center",color:"#5B2D8E",fontWeight:800,marginBottom:20,fontSize:18}}>Acceso Administrador</h3>
            <label style={S.label}>Contrasea</label>
            <input type="password" style={{...S.input,marginBottom:16}} value={adminPw} onChange={e=>setAdminPw(e.target.value)} onKeyDown={e=>e.key==="Enter"&&(adminPw===ADMIN_PASSWORD?onLogin("admin"):setError("Contrasea incorrecta"))} placeholder="" autoFocus/>
            {error&&<div style={{color:"#EF5350",fontSize:13,marginBottom:12,textAlign:"center",fontWeight:700}}>{error}</div>}
            <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:"14px",marginBottom:10}} onClick={()=>{if(adminPw===ADMIN_PASSWORD)onLogin("admin");else setError("Contrasea incorrecta");}}>Entrar</button>
            <button style={{...S.btn("transparent","#7B6B9A",true),padding:"10px"}} onClick={()=>{setMode("select");setError("");}}> Volver</button>
          </div>
        )}
        {mode==="teacher"&&(
          <div>
            <h3 style={{textAlign:"center",color:"#5B2D8E",fontWeight:800,marginBottom:20,fontSize:18}}>Acceso Maestro</h3>
            <label style={S.label}>Tu nombre</label>
            <select style={{...S.input,marginBottom:14}} value={teacherName} onChange={e=>{setTeacherName(e.target.value);setError("");}}>
              <option value=""> Selecciona tu nombre </option>
              {[...maestros].sort((a,b)=>flipName(a.nombre).localeCompare(flipName(b.nombre),"es")).map(m=><option key={m.id} value={m.nombre}>{flipName(m.nombre)} ({m.cargo})</option>)}
            </select>
            <label style={S.label}>Contrasea</label>
            <input type="password" style={{...S.input,marginBottom:16}} value={teacherPw} onChange={e=>setTeacherPw(e.target.value)} onKeyDown={e=>e.key==="Enter"&&handleTeacher()} placeholder=""/>
            {error&&<div style={{color:"#EF5350",fontSize:13,marginBottom:12,textAlign:"center",fontWeight:700}}>{error}</div>}
            <button style={{...S.btn("#4BBCE0","#FFFFFF",true),padding:"14px",marginBottom:10}} onClick={handleTeacher}>Entrar</button>
            <button style={{...S.btn("transparent","#7B6B9A",true),padding:"10px"}} onClick={()=>{setMode("select");setError("");}}> Volver</button>
          </div>
        )}
      </div>
    </div>
  );
}

//  ADMIN DASHBOARD 
function AdminDashboard({data}){
  const maestros=Array.isArray(data.maestros)?data.maestros:[];
  const familias=Array.isArray(data.familias)?data.familias:[];
  const eventos=Array.isArray(data.eventos)?data.eventos:[];
  const peticiones=Array.isArray(data.peticiones)?data.peticiones:[];
  const clases=data.clases&&typeof data.clases==="object"?data.clases:{};
  const ninos=Object.values(clases).flat();
  const today=new Date();
  const upcomingEvents=eventos.filter(e=>{try{const[d,m,y]=e.fecha.split("/");const dt=new Date(y,m-1,d);const diff=Math.floor((dt-today)/86400000);return diff>=0&&diff<=60;}catch(e){return false;}}).slice(0,5);
  return(
    <div style={{paddingBottom:10}}>
      <BirthdayBanner maestros={maestros} familias={familias}/>
      <div style={{padding:"0 1rem 6.25rem"}}>
        <h2 style={S.title}>Panel General</h2>
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16}}>
          <StatCard icon="" value={maestros.filter(m=>m.cargo==="MAESTRO").length} label="Maestros" color="#5B2D8E"/>
          <StatCard icon="" value={maestros.filter(m=>m.cargo==="AUXILIAR").length} label="Auxiliares" color="#4BBCE0"/>
          <StatCard icon="" value={ninos.length} label="Nios" color="#E84F9B"/>
          <StatCard icon="" value={[...new Set(familias.map(f=>f.num))].filter(Boolean).length} label="Familias" color="#F5C842"/>
        </div>
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16}}>
          <a href="https://drive.google.com/drive/folders/1PW00hDNw0POgEPW4LiANMH7PgByvX8A5?usp=sharing" target="_blank" rel="noopener noreferrer" style={{textDecoration:"none"}}>
            <div style={{...S.card,cursor:"pointer",display:"flex",alignItems:"center",gap:12,padding:14,border:"2px solid #5B2D8E33"}} onMouseOver={e=>{e.currentTarget.style.borderColor="#5B2D8E88";}} onMouseOut={e=>{e.currentTarget.style.borderColor="#5B2D8E33";}}>
              <div style={{width:44,height:44,borderRadius:12,background:"#5B2D8E22",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22}}></div>
              <div><div style={{fontWeight:800,color:"#5B2D8E",fontSize:14}}>Recursos E.D.</div><div style={{fontSize:11,color:"#7B6B9A"}}>Carpeta Google Drive</div></div>
            </div>
          </a>
          <a href="https://chat.whatsapp.com/D5XEyuz7NWXKtJeZQqG0h2?mode=gi_t" target="_blank" rel="noopener noreferrer" style={{textDecoration:"none"}}>
            <div style={{...S.card,cursor:"pointer",display:"flex",alignItems:"center",gap:12,padding:14,border:"2px solid #25D36633"}} onMouseOver={e=>{e.currentTarget.style.borderColor="#25D36688";}} onMouseOut={e=>{e.currentTarget.style.borderColor="#25D36633";}}>
              <div style={{width:44,height:44,borderRadius:12,background:"#25D36622",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22}}></div>
              <div><div style={{fontWeight:800,color:"#128C7E",fontSize:14}}>Grupo WhatsApp</div><div style={{fontSize:11,color:"#7B6B9A"}}>Maestros</div></div>
            </div>
          </a>
          <a href="https://www.bible.com/es/reading-plans/14400-la-biblia-en-1-ano" target="_blank" rel="noopener noreferrer" style={{textDecoration:"none",gridColumn:"1 / -1"}}>
            <div style={{...S.card,cursor:"pointer",display:"flex",alignItems:"center",gap:12,padding:14,border:"2px solid #8B691433"}} onMouseOver={e=>{e.currentTarget.style.borderColor="#8B691488";}} onMouseOut={e=>{e.currentTarget.style.borderColor="#8B691433";}}>
              <div style={{width:44,height:44,borderRadius:12,background:"#8B691422",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22}}></div>
              <div><div style={{fontWeight:800,color:"#6B4E10",fontSize:14}}>Plan de lectura bblica (1 ao)</div><div style={{fontSize:11,color:"#7B6B9A"}}>Bible.com  Recorrido completo en un ao</div></div>
            </div>
          </a>
        </div>
        <div style={S.card}>
          <h3 style={{color:"#5B2D8E",fontWeight:800,fontSize:15,marginBottom:12}}> Alumnos por Clase</h3>
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10}}>
            {CLASES_LIST.map(cl=>(
              <div key={cl} style={{background:CLASE_COLORS[cl]+"18",border:`2px solid ${CLASE_COLORS[cl]}44`,borderRadius:14,padding:"12px",textAlign:"center"}}>
                <div style={{fontSize:26,fontWeight:900,color:CLASE_COLORS[cl]}}>{(clases[cl]||[]).length}</div>
                <div style={{fontWeight:800,color:CLASE_COLORS[cl],fontSize:11}}>{cl}</div>
                <div style={{fontSize:10,color:"#7B6B9A",marginTop:2}}>{maestros.filter(m=>m.clase===cl).length} maestros</div>
              </div>
            ))}
          </div>
        </div>
        <div style={S.card}>
          <h3 style={{color:"#4BBCE0",fontWeight:800,fontSize:15,marginBottom:12}}> Prximos Eventos (60 das)</h3>
          {upcomingEvents.length===0&&<div style={{color:"#7B6B9A"}}>Sin eventos prximos.</div>}
          {upcomingEvents.map((e,i)=>(
            <div key={e.id} style={{display:"flex",gap:10,marginBottom:10,paddingBottom:10,borderBottom:i<upcomingEvents.length-1?"1px solid #DDD0F0":"none"}}>
              <div style={{background:(e.tipo==="NACIONAL"?"#5B2D8E":"#4BBCE0")+"22",borderRadius:8,padding:"4px 8px",fontSize:11,fontWeight:800,color:e.tipo==="NACIONAL"?"#5B2D8E":"#2A96BC",flexShrink:0}}>{e.fecha}</div>
              <div style={{fontWeight:600,fontSize:13}}>{e.nombre}</div>
            </div>
          ))}
        </div>
        <div style={{...S.card,borderLeft:"5px solid #EF5350"}}>
          <h3 style={{color:"#EF5350",fontWeight:800,fontSize:15,marginBottom:10}}> Certificados Pendientes</h3>
          {maestros.filter(m=>m.certificado==="NO").length===0
            ?<div style={{color:"#4CAF50",fontWeight:700}}> Todos al da</div>
            :maestros.filter(m=>m.certificado==="NO").map((m,i)=>(
              <div key={i} style={{display:"flex",alignItems:"center",gap:8,marginBottom:6}}>
                <div style={{flex:1,fontWeight:700,fontSize:13}}>{flipName(m.nombre)}</div>
                <span style={S.badge(CLASE_COLORS[m.clase]||"#5B2D8E")}>{m.clase}</span>
              </div>
            ))
          }
        </div>
        <PeticionesDashboard peticiones={peticiones} user="admin" onUpdate={()=>{}}/>
      </div>
    </div>
  );
}

//  MAESTROS PANEL 
function MaestrosPanel({maestros,onUpdate}){
  const[search,setSearch]=useState("");
  const[filterCargo,setFilterCargo]=useState("TODOS");
  const[modal,setModal]=useState(false);
  const[form,setForm]=useState({});
  const[editId,setEditId]=useState(null);
  const filtered=maestros.filter(m=>{const q=search.toLowerCase();if(q&&!flipName(m.nombre).toLowerCase().includes(q))return false;if(filterCargo!=="TODOS"&&m.cargo!==filterCargo)return false;return true;});
  const openAdd=()=>{setForm({nombre:"",cargo:"MAESTRO",clase:"CORDERITOS",nacimiento:"",cumpleanos:"",certificado:"SI"});setEditId(null);setModal(true);};
  const openEdit=(m)=>{setForm({...m,nacimiento:m.nacimiento||""});setEditId(m.id);setModal(true);};
  const save=()=>{
    let toSave={...form};
    if(toSave.nacimiento){
      try{
        const d=new Date(toSave.nacimiento);
        toSave.cumpleanos=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;
      }catch(e){}
    }
    onUpdate(editId?maestros.map(m=>m.id===editId?{...toSave,id:editId}:m):[...maestros,{...toSave,id:Date.now()}]);setModal(false);
  };
  const deleteMaestro=()=>{if(!confirmDelete("Eliminar a "+flipName(form.nombre)+"?"))return;onUpdate(maestros.filter(x=>x.id!==editId));setModal(false);};
  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14}}>
        <h2 style={S.title}>Maestros</h2>
        <button style={{...S.btn("#5B2D8E"),padding:"10px 16px",fontSize:14}} onClick={openAdd}>+ Agregar</button>
      </div>
      <input style={{...S.input,marginBottom:10}} placeholder=" Buscar..." value={search} onChange={e=>setSearch(e.target.value)}/>
      <div style={{display:"flex",gap:8,marginBottom:14}}>
        {["TODOS","MAESTRO","AUXILIAR"].map(c=>(
          <button key={c} style={{...S.btn(filterCargo===c?"#5B2D8E":"#F5F0FF",filterCargo===c?"#FFFFFF":"#2D1B4E"),padding:"8px 14px",fontSize:12,borderRadius:20}} onClick={()=>setFilterCargo(c)}>{c}</button>
        ))}
      </div>
      {filtered.map(m=>(
        <div key={m.id} style={{...S.card,display:"flex",alignItems:"center",gap:12}}>
          <div style={{width:44,height:44,borderRadius:"50%",background:(CLASE_COLORS[m.clase]||"#5B2D8E")+"33",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,fontSize:14,color:CLASE_COLORS[m.clase]||"#5B2D8E",flexShrink:0}}>{getInitials(m.nombre)}</div>
          <div style={{flex:1,minWidth:0}}>
            <div style={{fontWeight:800,fontSize:14,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{flipName(m.nombre)}</div>
            <div style={{display:"flex",gap:5,marginTop:4,flexWrap:"wrap"}}>
              <span style={S.badge(m.cargo==="MAESTRO"?"#5B2D8E":"#4BBCE0")}>{m.cargo}</span>
              <span style={S.badge(CLASE_COLORS[m.clase]||"#5B2D8E")}>{m.clase}</span>
              {m.certificado&&<span style={S.badge(m.certificado==="SI"?"#4CAF50":"#EF5350")}>{m.certificado==="SI"?"":""}</span>}
            </div>
          </div>
          <button style={{...S.btn("#4BBCE0"),padding:"8px 12px",fontSize:13}} onClick={()=>openEdit(m)}></button>
        </div>
      ))}
      <Modal open={modal} onClose={()=>setModal(false)} title={editId?"Editar Maestro":"Nuevo Maestro"}>
        <div style={{marginBottom:14}}><label style={S.label}>Nombre completo</label><input type="text" style={S.input} value={form.nombre||""} onChange={e=>setForm(f=>({...f,nombre:e.target.value}))}/></div>
        <div style={{marginBottom:14}}><label style={S.label}>Fecha de Nacimiento</label><input type="date" style={S.input} value={form.nacimiento||""} onChange={e=>setForm(f=>({...f,nacimiento:e.target.value}))}/></div>
        {form.nacimiento&&(function(){try{const d=new Date(form.nacimiento);const dd=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;const hoy=new Date();const edad=hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0);return <div style={{marginBottom:14,background:"#F5F0FF",borderRadius:12,padding:"10px 14px",fontSize:13,color:"#5B2D8E"}}> Cumpleaos: {dd}  {edad} aos</div>;}catch(e){return null;}}())}
        {[["Cargo","cargo",["MAESTRO","AUXILIAR"]],["Clase","clase",CLASES_LIST],["Certificado","certificado",["SI","NO"]]].map(([l,k,opts])=>(
          <div key={k} style={{marginBottom:14}}><label style={S.label}>{l}</label><select style={S.input} value={form[k]||""} onChange={e=>setForm(f=>({...f,[k]:e.target.value}))}>{opts.map(o=><option key={o} value={o}>{o}</option>)}</select></div>
        ))}
        <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14,marginTop:8}} onClick={save}> Guardar</button>
        {editId&&<button style={{...S.btn("#FFF0F0","#EF5350"),padding:12,marginTop:10,border:"1.5px solid #EF535044"}} onClick={deleteMaestro}> Eliminar Maestro</button>}
      </Modal>
    </div>
  );
}

//  CRONOGRAMA 
function CronogramaPanel({cronograma,maestros,onUpdate}){
  const[activeDate,setActiveDate]=useState(null);
  const[subModal,setSubModal]=useState(null);
  const[addModal,setAddModal]=useState(false);
  const[editEntryId,setEditEntryId]=useState(null); // for inline edit/delete of entry
  const[form,setForm]=useState({fecha:"",grupo:"CORDERITOS",leccion:"",tema:"",maestro:"",auxiliar:""});
  const[unavailable,setUnavailable]=useState([]);
  const[unavailModal,setUnavailModal]=useState(false);
  const[statsModal,setStatsModal]=useState(false);
  const dates=[...new Set(cronograma.map(c=>c.fecha))].sort();
  const editEntry=editEntryId?cronograma.find(c=>c.id===editEntryId):null;

  //  Smart rotation helpers 
  const nextSundays=(n=6)=>{
    const res=[];const d=new Date();
    d.setDate(d.getDate()+(7-d.getDay())%7||7);// next sunday
    for(let i=0;i<n;i++){
      res.push(d.toISOString().slice(0,10));
      d.setDate(d.getDate()+7);
    }
    return res;
  };
  const getRotationSuggestion=(grupo)=>{
    // find last entry for this grupo
    const lastEntries=cronograma.filter(c=>c.grupo===grupo).sort((a,b)=>b.fecha.localeCompare(a.fecha));
    const lastMaestro=lastEntries[0]?.maestro||"";
    const lastAuxiliar=lastEntries[0]?.auxiliar||"";
    // count participations per person
    const countMap={};
    cronograma.forEach(c=>{
      if(c.maestro)countMap[c.maestro]=(countMap[c.maestro]||0)+1;
      if(c.auxiliar)countMap[c.auxiliar]=(countMap[c.auxiliar]||0)+1;
    });
    // suggest maestro: different from last, sorted by fewest participations
    const isAdolescentes=grupo==="ADOLESCENTES";
    const eligiblePool=maestros.filter(m=>isAdolescentes?ADOLESCENTES_MAESTROS.includes(m.nombre):true);
    const maestroPool=[...eligiblePool].sort((a,b)=>(countMap[a.nombre]||0)-(countMap[b.nombre]||0));
    const sugMaestro=maestroPool.find(m=>m.nombre!==lastMaestro)?.nombre||maestroPool[0]?.nombre||"";
    const sugAux=isAdolescentes?"":maestroPool.find(m=>m.nombre!==lastAuxiliar&&m.nombre!==sugMaestro&&m.cargo==="AUXILIAR")?.nombre||maestroPool.find(m=>m.cargo==="AUXILIAR"&&m.nombre!==sugMaestro)?.nombre||"";
    // suggest next unscheduled sunday
    const usedDates=new Set(cronograma.map(c=>c.fecha));
    const sundays=nextSundays(12);
    const sugFecha=sundays.find(s=>!usedDates.has(s))||sundays[0]||"";
    // suggest leccion number
    const lastNum=lastEntries[0]?.leccion?.match(/\d+/)?.[0];
    const sugLeccion=lastNum?`Leccin ${parseInt(lastNum)+1}`:"Leccin 1";
    return{maestro:sugMaestro,auxiliar:sugAux,fecha:sugFecha,leccion:sugLeccion};
  };
  const openAdd=()=>{
    const sug=getRotationSuggestion("CORDERITOS");
    setForm({fecha:sug.fecha,grupo:"CORDERITOS",leccion:sug.leccion,tema:"",maestro:sug.maestro,auxiliar:sug.auxiliar});
    setAddModal(true);
  };
  const updateGrupo=(grupo)=>{
    const sug=getRotationSuggestion(grupo);
    setForm(f=>({...f,grupo,maestro:sug.maestro,auxiliar:sug.auxiliar,leccion:sug.leccion,fecha:f.fecha||sug.fecha}));
  };

  //  Participation stats 
  const getMaestroStats=(nombre)=>{
    const asMaestro=cronograma.filter(c=>c.maestro===nombre).length;
    const asAux=cronograma.filter(c=>c.auxiliar===nombre).length;
    const total=asMaestro+asAux;
    // Detect rescheduling: entries where teacher appears but class is "NO HAY CLASE"
    const noClass=cronograma.filter(c=>(c.maestro===nombre||c.auxiliar===nombre)&&(c.leccion==="NO HAY CLASE"||c.leccion==="DIA DEL PADRE")).length;
    const cumplimiento=total>0?Math.round(((total-noClass)/total)*100):100;
    return{total,asMaestro,asAux,noClass,cumplimiento};
  };
  const getSortedSubs=(grupo,role)=>{
    const assigned=cronograma.filter(c=>c.fecha===activeDate).flatMap(c=>[c.maestro,c.auxiliar]).filter(Boolean);
    // ADOLESCENTES: solo maestros autorizados, sin auxiliar
    const isAdolescentes=grupo==="ADOLESCENTES";
    const pool=maestros.filter(m=>{
      if(unavailable.includes(m.nombre)||assigned.includes(m.nombre))return false;
      if(isAdolescentes)return ADOLESCENTES_MAESTROS.includes(m.nombre);
      return true;
    });
    return pool.sort((a,b)=>{
      if(a.clase===grupo&&b.clase!==grupo)return -1;
      if(b.clase===grupo&&a.clase!==grupo)return 1;
      const sa=getMaestroStats(a.nombre),sb=getMaestroStats(b.nombre);
      if(sa.total!==sb.total)return sa.total-sb.total;
      return sb.cumplimiento-sa.cumplimiento;
    });
  };
  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14}}>
        <h2 style={S.title}>Cronograma</h2>
        <button style={{...S.btn("#5B2D8E"),padding:"10px 14px",fontSize:13}} onClick={openAdd}>+ Agregar</button>
      </div>
      <div style={{display:"flex",gap:10,marginBottom:14,flexWrap:"wrap"}}>
        <button style={{...S.btn("#F5C842","#3D1B6B",true),padding:"12px",borderRadius:14,fontSize:14,flex:1}} onClick={()=>setUnavailModal(true)}> Ausencias {unavailable.length>0?`(${unavailable.length})`:""}</button>
        <button style={{...S.btn("#4BBCE0","#FFFFFF",true),padding:"12px",borderRadius:14,fontSize:14,flex:1}} onClick={()=>setStatsModal(true)}> Estadsticas</button>
      </div>
      <div style={{display:"flex",gap:8,overflowX:"auto",paddingBottom:8,marginBottom:14}}>
        <button style={{...S.btn(!activeDate?"#5B2D8E":"#F5F0FF",!activeDate?"#FFFFFF":"#2D1B4E"),padding:"8px 14px",fontSize:12,flexShrink:0,borderRadius:20}} onClick={()=>setActiveDate(null)}>Todos</button>
        {dates.map(d=>(
          <button key={d} style={{...S.btn(activeDate===d?"#5B2D8E":"#F5F0FF",activeDate===d?"#FFFFFF":"#2D1B4E"),padding:"8px 14px",fontSize:12,flexShrink:0,borderRadius:20}} onClick={()=>setActiveDate(d===activeDate?null:d)}>{formatFecha(d)}</button>
        ))}
      </div>
      {(activeDate?[activeDate]:dates).map(d=>{
        const entries=cronograma.filter(c=>c.fecha===d);
        return(
          <div key={d} style={S.card}>
            <div style={{fontWeight:800,color:"#5B2D8E",fontSize:16,marginBottom:12,paddingBottom:10,borderBottom:"2px solid #DDD0F0"}}> {formatFecha(d)} 2026</div>
            {entries.map(e=>(
              <div key={e.id} style={{background:(CLASE_COLORS[e.grupo]||"#5B2D8E")+"12",border:`1.5px solid ${CLASE_COLORS[e.grupo]||"#5B2D8E"}44`,borderRadius:14,padding:"14px",marginBottom:10}}>
                <div style={{display:"flex",justifyContent:"space-between",gap:8}}>
                  <div style={{flex:1}}>
                    <span style={S.tag(CLASE_COLORS[e.grupo]||"#5B2D8E")}>{e.grupo}</span>
                    <div style={{fontWeight:800,fontSize:15,marginTop:6}}>{e.leccion}</div>
                    {e.tema&&<div style={{fontSize:12,color:"#7B6B9A",marginTop:2}}>{e.tema}</div>}
                  </div>
                  <button style={{...S.btn("#EF5350"),padding:"6px 10px",fontSize:13}} onClick={()=>setEditEntryId(e.id)}></button>
                </div>
                {[["maestro","MAESTRO","","#5B2D8E"],["auxiliar","AUXILIAR","","#E84F9B"]].filter(([role])=>!(e.grupo==="ADOLESCENTES"&&role==="auxiliar")).map(([role,label,icon,color])=>(
                  <div key={role} style={{marginTop:8,background:"rgba(255,255,255,0.85)",borderRadius:10,padding:"10px 12px"}}>
                    <div style={{fontSize:11,fontWeight:800,color:"#7B6B9A",marginBottom:4,letterSpacing:1}}>{label}</div>
                    <div style={{display:"flex",alignItems:"center",gap:8}}>
                      <div style={{flex:1,fontWeight:700,fontSize:13,color:e[role]&&unavailable.includes(e[role])?"#EF5350":"#2D1B4E"}}>
                        {e[role]?(unavailable.includes(e[role])?" ":icon+" ")+flipName(e[role]):<span style={{color:"#7B6B9A",fontStyle:"italic"}}>Sin asignar</span>}
                      </div>
                      <button style={{...S.btn(color),padding:"6px 12px",fontSize:12}} onClick={()=>{setSubModal({entryId:e.id,role,grupo:e.grupo});setActiveDate(d);}}></button>
                    </div>
                  </div>
                ))}
              </div>
            ))}
          </div>
        );
      })}
      <Modal open={unavailModal} onClose={()=>setUnavailModal(false)} title="Gestionar Ausencias">
        <div style={{display:"flex",flexDirection:"column",gap:8,maxHeight:380,overflowY:"auto"}}>
          {maestros.map(m=>(
            <div key={m.id} onClick={()=>setUnavailable(u=>u.includes(m.nombre)?u.filter(n=>n!==m.nombre):[...u,m.nombre])}
              style={{display:"flex",alignItems:"center",gap:12,padding:"12px 14px",background:unavailable.includes(m.nombre)?"#EF535018":"#F5F0FF",borderRadius:12,border:`2px solid ${unavailable.includes(m.nombre)?"#EF5350":"#DDD0F0"}`,cursor:"pointer"}}>
              <div style={{flex:1}}><div style={{fontWeight:700}}>{flipName(m.nombre)}</div><div style={{fontSize:12,color:"#7B6B9A"}}>{m.cargo}  {m.clase}</div></div>
              <div style={{width:28,height:28,borderRadius:"50%",background:unavailable.includes(m.nombre)?"#EF5350":"#DDD0F0",display:"flex",alignItems:"center",justifyContent:"center",color:"#FFFFFF",fontWeight:800}}>{unavailable.includes(m.nombre)?"":""}</div>
            </div>
          ))}
        </div>
        <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14,marginTop:14}} onClick={()=>setUnavailModal(false)}>Confirmar</button>
      </Modal>
      <Modal open={statsModal} onClose={()=>setStatsModal(false)} title=" Estadsticas de Participacin">
        <div style={{maxHeight:450,overflowY:"auto"}}>
          {[...maestros].sort((a,b)=>{
            const sa=getMaestroStats(a.nombre),sb=getMaestroStats(b.nombre);
            return sb.total-sa.total;
          }).map(m=>{
            const st=getMaestroStats(m.nombre);
            const barColor=st.cumplimiento>=80?"#4CAF50":st.cumplimiento>=60?"#F5C842":"#EF5350";
            return(
              <div key={m.id} style={{...S.card,padding:"12px 14px",marginBottom:10}}>
                <div style={{display:"flex",alignItems:"center",gap:10,marginBottom:8}}>
                  <div style={{width:36,height:36,borderRadius:"50%",background:(CLASE_COLORS[m.clase]||"#5B2D8E")+"33",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,fontSize:12,color:CLASE_COLORS[m.clase]||"#5B2D8E",flexShrink:0}}>{getInitials(m.nombre)}</div>
                  <div style={{flex:1}}>
                    <div style={{fontWeight:800,fontSize:13}}>{flipName(m.nombre)}</div>
                    <div style={{fontSize:11,color:"#7B6B9A"}}>{m.cargo}  {m.clase}</div>
                  </div>
                  <span style={{...S.badge(barColor),fontSize:12}}>{st.cumplimiento}%</span>
                </div>
                <div style={{display:"flex",gap:8,flexWrap:"wrap"}}>
                  <span style={{...S.badge("#5B2D8E"),fontSize:11}}> {st.asMaestro} veces maestro</span>
                  <span style={{...S.badge("#E84F9B"),fontSize:11}}> {st.asAux} veces auxiliar</span>
                  {st.noClass>0&&<span style={{...S.badge("#EF5350"),fontSize:11}}> {st.noClass} sin clase</span>}
                </div>
                <div style={{marginTop:8,background:"#F5F0FF",borderRadius:8,height:8,overflow:"hidden"}}>
                  <div style={{height:"100%",background:barColor,borderRadius:8,width:st.cumplimiento+"%",transition:"width 0.5s"}}/>
                </div>
              </div>
            );
          })}
        </div>
      </Modal>
      <Modal open={!!subModal} onClose={()=>setSubModal(null)} title="Seleccionar Sustituto">
        {subModal&&(
          <div>
            <p style={{color:"#7B6B9A",fontSize:13,marginBottom:12}}>{subModal.role==="maestro"?"Maestro":"Auxiliar"} para <strong>{subModal.grupo}</strong></p>
            <div style={{background:"#F0FBFF",borderRadius:10,padding:"10px 14px",marginBottom:16,fontSize:12,color:"#2A96BC"}}>
               <strong>Orden por sugerencia:</strong> misma clase  menos clases asignadas  mayor cumplimiento
            </div>
            {["MISMA CLASE","OTRAS CLASES"].map(sec=>{
              const subs=getSortedSubs(subModal.grupo,subModal.role).filter(m=>sec==="MISMA CLASE"?m.clase===subModal.grupo:m.clase!==subModal.grupo);
              if(!subs.length)return null;
              return(
                <div key={sec} style={{marginBottom:16}}>
                  <div style={{fontSize:11,fontWeight:800,color:"#7B6B9A",marginBottom:8,letterSpacing:1}}>{sec}</div>
                  {subs.map((m,mi)=>(
                    (()=>{const st=getMaestroStats(m.nombre);const warn=st.cumplimiento<70||st.total>8;return(
                    <div key={m.id} onClick={()=>{onUpdate(cronograma.map(c=>c.id===subModal.entryId?{...c,[subModal.role]:m.nombre}:c));setSubModal(null);}}
                      style={{display:"flex",alignItems:"center",gap:12,padding:"12px 14px",background:(CLASE_COLORS[m.clase]||"#5B2D8E")+"15",borderRadius:12,marginBottom:8,border:`2px solid ${mi===0?"#4CAF5066":warn?"#F5C842":(CLASE_COLORS[m.clase]||"#5B2D8E")+"44"}`,cursor:"pointer"}}>
                      <div style={{width:40,height:40,borderRadius:"50%",background:(CLASE_COLORS[m.clase]||"#5B2D8E")+"44",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,color:CLASE_COLORS[m.clase]||"#5B2D8E"}}>{getInitials(m.nombre)}</div>
                      <div style={{flex:1}}>
                        <div style={{display:"flex",alignItems:"center",gap:6}}>
                          <div style={{fontWeight:800,fontSize:13}}>{flipName(m.nombre)}</div>
                          {mi===0&&<span style={{...S.badge("#4CAF50"),fontSize:9,padding:"2px 7px"}}> SUGERIDO</span>}
                        </div>
                        <div style={{fontSize:11,color:"#7B6B9A"}}>{m.cargo}  {m.clase}</div>
                        <div style={{display:"flex",gap:6,marginTop:3,flexWrap:"wrap"}}>
                          <span style={{...S.badge(st.total<4?"#4CAF50":st.total>8?"#EF5350":"#4BBCE0"),fontSize:10}}>{st.total} clases</span>
                          <span style={{...S.badge(st.cumplimiento>=80?"#4CAF50":st.cumplimiento>=60?"#F5C842":"#EF5350"),fontSize:10}}>{st.cumplimiento}% cumpl.</span>
                          {warn&&st.total>8&&<span style={{...S.badge("#F5C842"),fontSize:10}}> Muchas clases</span>}
                        </div>
                      </div>
                      <span style={{fontSize:18,color:"#4CAF50"}}></span>
                    </div>
                    );})()
                  ))}
                </div>
              );
            })}
          </div>
        )}
      </Modal>
      <Modal open={addModal} onClose={()=>setAddModal(false)} title=" Nueva Clase">
        {/* Grupo selector */}
        <label style={S.label}>Grupo</label>
        <div style={{display:"flex",gap:6,flexWrap:"wrap",marginBottom:14}}>
          {CLASES_LIST.map(cl=>(
            <button key={cl} style={{...S.btn(form.grupo===cl?CLASE_COLORS[cl]:"#F5F0FF",form.grupo===cl?(cl==="VENCEDORES"?"#3D1B6B":"#FFFFFF"):"#2D1B4E"),padding:"7px 13px",fontSize:12,borderRadius:18,flexShrink:0}} onClick={()=>updateGrupo(cl)}>{cl}</button>
          ))}
        </div>
        {/* Sunday date suggestions */}
        <label style={S.label}> Fecha (Domingos sugeridos)</label>
        <div style={{display:"flex",gap:6,overflowX:"auto",paddingBottom:6,marginBottom:8}}>
          {nextSundays(8).map(d=>{
            const used=cronograma.some(c=>c.fecha===d);
            return <button key={d} onClick={()=>setForm(f=>({...f,fecha:d}))}
              style={{...S.btn(form.fecha===d?"#5B2D8E":used?"#EF535020":"#F5F0FF",form.fecha===d?"#FFFFFF":used?"#EF5350":"#2D1B4E"),padding:"6px 12px",fontSize:11,flexShrink:0,borderRadius:16,border:used?"2px solid #EF535055":"none",whiteSpace:"nowrap"}}>
              {used&&" "}{formatFecha(d)}
            </button>;
          })}
        </div>
        <input type="date" style={{...S.input,marginBottom:14}} value={form.fecha} onChange={e=>setForm(f=>({...f,fecha:e.target.value}))}/>
        {/* Leccin y tema */}
        {[["Leccin","leccion","text"],["Tema (opcional)","tema","text"]].map(([l,k,t])=>(
          <div key={k} style={{marginBottom:12}}><label style={S.label}>{l}</label><input type={t} style={S.input} value={form[k]} onChange={e=>setForm(f=>({...f,[k]:e.target.value}))}/></div>
        ))}
        {/* Rotation suggestion banner */}
        <div style={{background:"linear-gradient(135deg,#4BBCE015,#4BBCE025)",border:"1.5px solid #4BBCE055",borderRadius:12,padding:"10px 14px",marginBottom:14}}>
          <div style={{fontSize:11,fontWeight:800,color:"#2A96BC",letterSpacing:0.5,marginBottom:6}}> ROTACIN SUGERIDA SEGN HISTORIAL</div>
          <div style={{display:"flex",gap:8,flexWrap:"wrap"}}>
            {form.maestro&&<span style={{...S.badge("#5B2D8E"),fontSize:11}}> {flipName(form.maestro)}</span>}
            {form.auxiliar&&<span style={{...S.badge("#E84F9B"),fontSize:11}}> {flipName(form.auxiliar)}</span>}
            {!form.maestro&&!form.auxiliar&&<span style={{fontSize:12,color:"#7B6B9A",fontStyle:"italic"}}>Sin equipo sugerido an</span>}
          </div>
        </div>
        {/* ADOLESCENTES: solo maestros autorizados, sin auxiliar */}
        {form.grupo==="ADOLESCENTES"&&(
          <div style={{background:"linear-gradient(135deg,#E84F9B15,#E84F9B25)",border:"1.5px solid #E84F9B55",borderRadius:12,padding:"10px 14px",marginBottom:14,fontSize:12,color:"#9C1B5B",fontWeight:600}}>
             Clase ADOLESCENTES: solo maestros autorizados. No requiere auxiliar.
          </div>
        )}
        {/* Maestro */}
        <label style={S.label}> Maestro</label>
        <select style={{...S.input,marginBottom:12}} value={form.maestro} onChange={e=>setForm(f=>({...f,maestro:e.target.value}))}>
          <option value=""> Sin asignar </option>
          {form.grupo==="ADOLESCENTES"
            ? maestros.filter(m=>ADOLESCENTES_MAESTROS.includes(m.nombre)).sort((a,b)=>flipName(a.nombre).localeCompare(flipName(b.nombre),"es")).map(m=><option key={m.id} value={m.nombre}>{flipName(m.nombre)}</option>)
            : <>
                <optgroup label="MAESTROS">{maestros.filter(m=>m.cargo==="MAESTRO").sort((a,b)=>flipName(a.nombre).localeCompare(flipName(b.nombre),"es")).map(m=><option key={m.id} value={m.nombre}>{flipName(m.nombre)}  {m.clase}</option>)}</optgroup>
                <optgroup label="AUXILIARES (como maestro)">{maestros.filter(m=>m.cargo==="AUXILIAR").sort((a,b)=>flipName(a.nombre).localeCompare(flipName(b.nombre),"es")).map(m=><option key={m.id} value={m.nombre}>{flipName(m.nombre)}  {m.clase}</option>)}</optgroup>
              </>
          }
        </select>
        {/* Auxiliar: oculto para ADOLESCENTES */}
        {form.grupo!=="ADOLESCENTES"&&(
          <>
            <label style={S.label}> Auxiliar</label>
            <select style={{...S.input,marginBottom:20}} value={form.auxiliar} onChange={e=>setForm(f=>({...f,auxiliar:e.target.value}))}>
              <option value=""> Sin asignar </option>
              <optgroup label="AUXILIARES">{maestros.filter(m=>m.cargo==="AUXILIAR").sort((a,b)=>flipName(a.nombre).localeCompare(flipName(b.nombre),"es")).map(m=><option key={m.id} value={m.nombre}>{flipName(m.nombre)}  {m.clase}</option>)}</optgroup>
              <optgroup label="MAESTROS (como auxiliar)">{maestros.filter(m=>m.cargo==="MAESTRO").sort((a,b)=>flipName(a.nombre).localeCompare(flipName(b.nombre),"es")).map(m=><option key={m.id} value={m.nombre}>{flipName(m.nombre)}  {m.clase}</option>)}</optgroup>
            </select>
          </>
        )}
        <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={()=>{onUpdate([...cronograma,{...form,auxiliar:form.grupo==="ADOLESCENTES"?null:form.auxiliar,id:Date.now()}]);setAddModal(false);setForm({fecha:"",grupo:"CORDERITOS",leccion:"",tema:"",maestro:"",auxiliar:""});}}> Guardar Clase</button>
      </Modal>
      {/*  Modal editar/eliminar entrada del cronograma  */}
      <Modal open={!!editEntryId} onClose={()=>setEditEntryId(null)} title=" Editar Programacin">
        {editEntry&&(
          <div>
            <div style={{background:"#F5F0FF",borderRadius:12,padding:"12px 14px",marginBottom:16}}>
              <div style={{fontWeight:800,color:"#5B2D8E",fontSize:15}}>{editEntry.leccion}</div>
              {editEntry.tema&&<div style={{fontSize:13,color:"#7B6B9A",marginTop:4}}>{editEntry.tema}</div>}
              <div style={{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"}}>
                <span style={S.badge(CLASE_COLORS[editEntry.grupo]||"#5B2D8E")}>{editEntry.grupo}</span>
                <span style={S.badge("#7B6B9A")}> {editEntry.fecha}</span>
              </div>
            </div>
            {[["Leccin","leccion"],["Tema","tema"],["Fecha","fecha"]].map(([l,k])=>(
              <div key={k} style={{marginBottom:12}}>
                <label style={S.label}>{l}</label>
                <input style={S.input} value={editEntry[k]||""} onChange={e=>onUpdate(cronograma.map(c=>c.id===editEntryId?{...c,[k]:e.target.value}:c))}/>
              </div>
            ))}
            <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:13,marginTop:4}} onClick={()=>setEditEntryId(null)}> Listo</button>
            <button style={{...S.btn("#FFF0F0","#EF5350"),padding:12,marginTop:10,border:"1.5px solid #EF535044"}} onClick={()=>{if(confirmDelete("Eliminar esta sesin del cronograma?")){onUpdate(cronograma.filter(c=>c.id!==editEntryId));setEditEntryId(null);}}}> Eliminar Sesin</button>
          </div>
        )}
      </Modal>
    </div>
  );
}

//  CLASES PANEL (Admin, editable) 
const COLORES_PRESET=["#4BBCE0","#F5C842","#5B2D8E","#E84F9B","#4CAF50","#FF7043","#7E57C2","#26A69A","#EF5350","#78909C"];

function ClasesPanel({clases,onUpdate,clasesConfig,onUpdateClasesConfig,calificaciones=[],familias=[],onUpdateFamilias=()=>{},readOnlyStudents=false}){
  const cfg=getCfgList(clasesConfig);
  const[activeClase,setActiveClase]=useState(cfg[0]?.key||"CORDERITOS");
  const[modal,setModal]=useState(false);       // add/edit alumno
  const[mgrModal,setMgrModal]=useState(false); // gestionar clases
  const[form,setForm]=useState({nombre:"",apellido:"",padre:"",madre:"",telPadre:"",telMadre:"",nacimiento:"",bautizado:false,sellado:false,foto:null});
  const[editIdx,setEditIdx]=useState(null);
  const[claseForm,setClaseForm]=useState(null); // editing a class config: {key,nombre,color,isNew}
  const ninos=clases[activeClase]||[];
  const color=getCfgColor(activeClase,clasesConfig);

  // Promedio general del alumno en esta clase (usado solo para mostrar, no editar)
  const getNinoGlobalAvg=(alumno)=>{
    if(!calificaciones||!calificaciones.length)return null;
    const entries=calificaciones.filter(c=>c.alumno===alumno&&c.clase===activeClase);
    if(!entries.length)return null;
    let t=0,cnt=0;
    const KEYS=["valores","conocimiento","oracion","servicio","respeto","participacion","comportamiento"];
    entries.forEach(e=>{
      KEYS.forEach(k=>{
        const v=parseFloat(e[k]);
        if(!isNaN(v)){t+=v;cnt++;}
      });
    });
    return cnt?(t/cnt).toFixed(1):null;
  };

  //  Alumnos CRUD 
  const openAdd=()=>{setForm({nombre:"",apellido:"",padre:"",madre:"",telPadre:"",telMadre:"",nacimiento:"",bautizado:false,sellado:false,foto:null});setEditIdx(null);setModal(true);};
  const openEdit=(n,i)=>{
    const claseNorm=(c)=>(c||"").trim().toUpperCase();
    let fam=familias.find(f=>samePersonName(f.alumno,n.nombre)&&claseNorm(f.clase)===claseNorm(activeClase));
    if(!fam) fam=familias.find(f=>samePersonName(f.alumno,n.nombre));
    const nombreDisplay=n.nombre||"";
    const padre=fam?.padre??"",madre=fam?.madre??"",telPadre=fam?.telPadre??"",telMadre=fam?.telMadre??"",nacimiento=(n.nacimiento||fam?.nacimiento)||"";
    setForm({nombre:nombreDisplay,apellido:"",padre,madre,telPadre,telMadre,nacimiento,bautizado:!!(n.bautizado||fam?.bautizado),sellado:!!(n.sellado||fam?.sellado),foto:n.foto||fam?.foto||null});
    setEditIdx(i);setModal(true);
  };
  const saveAlumno=()=>{
    const nom=(form.nombre||"").trim();
    const ape=(form.apellido||"").trim();
    const nombreCompleto=[nom,ape].filter(Boolean).join(" ");
    if(!nombreCompleto)return;
    let edad=form.edad||null;
    let cumpleanos=null;
    if(form.nacimiento){
      try{
        const d=new Date(form.nacimiento);
        const hoy=new Date();
        edad=String(hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0));
        cumpleanos=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;
      }catch(e){}
    }
    const updated=[...ninos];
    const base={id:editIdx!=null?ninos[editIdx]?.id:(Date.now()+""),nombre:nombreCompleto,edad,foto:form.foto||null,nacimiento:form.nacimiento||null,cumpleanos,bautizado:!!form.bautizado,sellado:!!form.sellado};
    if(editIdx!=null){
      const oldNombre=ninos[editIdx]?.nombre;
      updated[editIdx]=base;
      onUpdate({...clases,[activeClase]:updated});
      const tienePadre=(form.padre||"").trim()||(form.madre||"").trim();
      const claseNorm=(c)=>(c||"").trim().toUpperCase();
      const existingFam=familias.find(f=>samePersonName(f.alumno,oldNombre)&&claseNorm(f.clase)===claseNorm(activeClase));
      if(tienePadre){
        if(existingFam){
          const newFamilias=familias.map(f=>{
            if(samePersonName(f.alumno,oldNombre)&&claseNorm(f.clase)===claseNorm(activeClase))return{...f,alumno:nombreCompleto,padre:(form.padre||"").trim(),madre:(form.madre||"").trim(),telPadre:(form.telPadre||"").trim(),telMadre:(form.telMadre||"").trim(),edad,cumpleanos,nacimiento:form.nacimiento||f.nacimiento,bautizado:!!form.bautizado,sellado:!!form.sellado};
            return f;
          });
          onUpdateFamilias(newFamilias);
        }else{
          const num=Math.max(0,...familias.map(f=>f.num||0))+1;
          const famRec={id:Date.now(),num,familia:ape||(form.padre||form.madre||"Familia"),padre:(form.padre||"").trim(),madre:(form.madre||"").trim(),telPadre:(form.telPadre||"").trim(),telMadre:(form.telMadre||"").trim(),alumno:nombreCompleto,edad,cumpleanos,nacimiento:form.nacimiento||"",clase:activeClase,bautizado:!!form.bautizado,sellado:!!form.sellado};
          onUpdateFamilias([...familias,famRec]);
        }
      }else if(existingFam){
        onUpdateFamilias(familias.filter(f=>!(samePersonName(f.alumno,oldNombre)&&claseNorm(f.clase)===claseNorm(activeClase))));
      }
    }else{
      updated.push(base);
      onUpdate({...clases,[activeClase]:updated});
      const tienePadre=(form.padre||"").trim()||(form.madre||"").trim();
      if(tienePadre){
        const num=Math.max(0,...familias.map(f=>f.num||0))+1;
        const famRec={id:Date.now(),num,familia:ape||(form.padre||form.madre||"Familia"),padre:(form.padre||"").trim(),madre:(form.madre||"").trim(),telPadre:(form.telPadre||"").trim(),telMadre:(form.telMadre||"").trim(),alumno:nombreCompleto,edad,cumpleanos,nacimiento:form.nacimiento||"",clase:activeClase,bautizado:!!form.bautizado,sellado:!!form.sellado};
        onUpdateFamilias([...familias,famRec]);
      }
    }
    setModal(false);
  };
  const deleteAlumno=(i)=>{
    if(!confirmDelete("Eliminar a "+flipName(ninos[i].nombre)+" de la clase?"))return;
    const nombreEliminado=ninos[i].nombre;
    onUpdate({...clases,[activeClase]:ninos.filter((_,j)=>j!==i)});
    const claseNorm=(c)=>(c||"").trim().toUpperCase();
    onUpdateFamilias(familias.filter(f=>!(samePersonName(f.alumno,nombreEliminado)&&claseNorm(f.clase)===claseNorm(activeClase))));
  };
  const updateFoto=(i,foto)=>onUpdate({...clases,[activeClase]:ninos.map((n,j)=>j===i?{...n,foto}:n)});

  //  Gestin de Clases 
  const saveClase=()=>{
    if(!claseForm?.nombre?.trim())return;
    let newCfg=[...cfg];
    if(claseForm.isNew){
      const newKey=claseForm.nombre.trim().toUpperCase().replace(/\s+/g,"_");
      if(newCfg.find(c=>c.key===newKey)){alert("Ya existe una clase con ese nombre");return;}
      newCfg.push({key:newKey,nombre:claseForm.nombre.trim().toUpperCase(),color:claseForm.color||"#5B2D8E"});
      onUpdateClasesConfig(newCfg);
      if(!readOnlyStudents)onUpdate({...clases,[newKey]:[]});
      setActiveClase(newKey);
    } else {
      newCfg=newCfg.map(c=>c.key===claseForm.key?{...c,nombre:claseForm.nombre.trim().toUpperCase(),color:claseForm.color}:c);
      onUpdateClasesConfig(newCfg);
    }
    setClaseForm(null);
  };
  const deleteClase=(key)=>{
    const count=(clases[key]||[]).length;
    if(count>0){alert(`No se puede eliminar: la clase tiene ${count} alumno${count!==1?"s":""}. Elimina los alumnos primero en la pestaa Alumnos.`);return;}
    if(!confirmDelete("Eliminar la clase "+key+"? Esta accin no se puede deshacer."))return;
    const newCfg=cfg.filter(c=>c.key!==key);
    onUpdateClasesConfig(newCfg);
    if(!readOnlyStudents){const newClases={...clases};delete newClases[key];onUpdate(newClases);}
    setActiveClase(newCfg[0]?.key||"CORDERITOS");
  };

  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      {/* Header */}
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14}}>
        <h2 style={S.title}>Clases</h2>
        <div style={{display:"flex",gap:8}}>
          <button style={{...S.btn("#F5F0FF","#5B2D8E"),padding:"9px 13px",fontSize:13,border:"1.5px solid #DDD0F0"}} onClick={()=>setMgrModal(true)}> Gestionar</button>
          {!readOnlyStudents&&<button style={{...S.btn(color),padding:"10px 16px",fontSize:14}} onClick={openAdd}>+ Nio</button>}
        </div>
      </div>
      {readOnlyStudents&&<div style={{fontSize:12,color:"#7B6B9A",marginBottom:10}}>Los alumnos se editan en la pestaa <strong>Alumnos</strong>.</div>}

      {/* Class tabs */}
      <div style={{display:"flex",gap:8,overflowX:"auto",paddingBottom:8,marginBottom:14}}>
        {cfg.map(cl=>{
          const isActive=activeClase===cl.key;
          const textColor=cl.color==="#F5C842"?"#3D1B6B":"#FFFFFF";
          return(
            <button key={cl.key}
              style={{...S.btn(isActive?cl.color:"#F5F0FF",isActive?textColor:"#2D1B4E"),padding:"8px 14px",fontSize:12,flexShrink:0,borderRadius:20}}
              onClick={()=>setActiveClase(cl.key)}>
              {cl.nombre} ({(clases[cl.key]||[]).length})
            </button>
          );
        })}
      </div>

      {/* Student list */}
      {ninos.length===0&&(
        <div style={{textAlign:"center",padding:"40px 20px",color:"#7B6B9A",fontSize:14}}>
          No hay alumnos en esta clase.<br/>
          <span style={{fontSize:12,opacity:0.7}}>{readOnlyStudents?"Agrega alumnos en la pestaa Alumnos.":"Usa el botn \"+ Nio\" para agregar."}</span>
        </div>
      )}
      {ninos.map((n,i)=>(
        <div key={n.id||i} style={{...S.card,display:"flex",alignItems:"center",gap:12}}>
          <AvatarUpload photo={n.foto} onPhoto={readOnlyStudents?()=>{}:(f)=>updateFoto(i,f)} size={48} initials={getInitials(n.nombre)} color={color}/>
          <div style={{flex:1,minWidth:0}}>
            <div style={{fontWeight:700,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{flipName(n.nombre)}</div>
            {n.edad&&<div style={{fontSize:12,color:"#7B6B9A"}}>{n.edad} aos</div>}
          </div>
          {(()=>{
            const avg=getNinoGlobalAvg(n.nombre);
            if(!avg)return <div style={{fontSize:11,color:"#7B6B9A"}}>Sin calificacin</div>;
            return(
              <div style={{background:scoreColor(avg)+"20",borderRadius:10,padding:"6px 10px",textAlign:"center",minWidth:56}}>
                <div style={{fontWeight:900,color:scoreColor(avg),fontSize:16}}>{avg}</div>
                <div style={{fontSize:9,color:"#7B6B9A"}}>prom.</div>
              </div>
            );
          })()}
          {!readOnlyStudents&&<button style={{...S.btn("#4BBCE0"),padding:"8px 10px",fontSize:13,flexShrink:0}} onClick={()=>openEdit(n,i)} title="Editar alumno"></button>}
        </div>
      ))}

      {/* Modal: Agregar/Editar alumno */}
      <Modal open={modal} onClose={()=>setModal(false)} title={editIdx!=null?"Editar Alumno":`Agregar a ${activeClase}`}>
        <div style={{display:"flex",justifyContent:"center",marginBottom:18}}>
          <AvatarUpload photo={form.foto} onPhoto={(f)=>setForm(x=>({...x,foto:f}))} size={72} initials={(form.nombre||form.apellido)?getInitials([form.nombre,form.apellido].filter(Boolean).join(" ")):"?"} color={color}/>
        </div>
        {editIdx==null?(<>
          <label style={S.label}>Nombre</label>
          <input style={{...S.input,marginBottom:12}} placeholder="Ej: Jos Luis" value={form.nombre} onChange={e=>setForm(f=>({...f,nombre:e.target.value}))}/>
          <label style={S.label}>Apellidos</label>
          <input style={{...S.input,marginBottom:12}} placeholder="Ej: Mogolln Muoz" value={form.apellido} onChange={e=>setForm(f=>({...f,apellido:e.target.value}))}/>
        </>):(
          <label style={S.label}>Nombre completo</label>
        )}
        {editIdx!=null&&<input style={{...S.input,marginBottom:12}} value={form.nombre} onChange={e=>setForm(f=>({...f,nombre:e.target.value}))}/>}
        <label style={S.label}>Padre</label>
        <input style={{...S.input,marginBottom:12}} value={form.padre} onChange={e=>setForm(f=>({...f,padre:e.target.value}))}/>
        <label style={S.label}>Madre</label>
        <input style={{...S.input,marginBottom:12}} value={form.madre} onChange={e=>setForm(f=>({...f,madre:e.target.value}))}/>
        <label style={S.label}>Tel. Padre</label>
        <input type="tel" style={{...S.input,marginBottom:12}} placeholder="Ej: +34 600 000 000" value={form.telPadre} onChange={e=>setForm(f=>({...f,telPadre:e.target.value}))}/>
        <label style={S.label}>Tel. Madre</label>
        <input type="tel" style={{...S.input,marginBottom:12}} placeholder="Ej: +34 600 000 000" value={form.telMadre} onChange={e=>setForm(f=>({...f,telMadre:e.target.value}))}/>
        <label style={S.label}>Fecha de nacimiento</label>
        <input type="date" style={{...S.input,marginBottom:12}} value={form.nacimiento} onChange={e=>setForm(f=>({...f,nacimiento:e.target.value}))}/>
        {form.nacimiento&&(function(){try{const d=new Date(form.nacimiento);const dd=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;const hoy=new Date();const edad=hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0);return <div style={{marginBottom:12,background:"#F5F0FF",borderRadius:10,padding:"8px 12px",fontSize:12,color:"#5B2D8E"}}> {dd}  {edad} aos</div>;}catch(e){return null;}}())}
        <div style={{display:"flex",gap:16,marginBottom:18}}>
          <label style={{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#5B2D8E"}}>
            <input type="checkbox" checked={!!form.bautizado} onChange={e=>setForm(f=>({...f,bautizado:e.target.checked,sellado:e.target.checked?false:f.sellado}))}/>
            Bautizado
          </label>
          <label style={{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#5B2D8E"}}>
            <input type="checkbox" checked={!!form.sellado} onChange={e=>setForm(f=>({...f,sellado:e.target.checked,bautizado:e.target.checked?false:f.bautizado}))}/>
            Sellado
          </label>
        </div>
        <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={saveAlumno}> Guardar</button>
        {editIdx!=null&&<button style={{...S.btn("#FFF0F0","#EF5350"),padding:12,marginTop:10,border:"1.5px solid #EF535044"}} onClick={()=>{deleteAlumno(editIdx);setModal(false);}}> Eliminar Alumno</button>}
      </Modal>

      {/* Modal: Gestionar Clases */}
      <Modal open={mgrModal} onClose={()=>{setMgrModal(false);setClaseForm(null);}} title=" Gestionar Clases">
        {!claseForm?(
          <div>
            <div style={{marginBottom:14,fontSize:13,color:"#7B6B9A"}}>Edita el nombre o color de cada clase, o aade una nueva.</div>
            {cfg.map(cl=>(
              <div key={cl.key} style={{display:"flex",alignItems:"center",gap:10,padding:"10px 0",borderBottom:"1px solid #EEE8FF"}}>
                <div style={{width:18,height:18,borderRadius:5,background:cl.color,flexShrink:0}}/>
                <div style={{flex:1}}>
                  <div style={{fontWeight:700,fontSize:14}}>{cl.nombre}</div>
                  <div style={{fontSize:11,color:"#7B6B9A"}}>{(clases[cl.key]||[]).length} alumnos</div>
                </div>
                <button style={{...S.btn("#4BBCE0"),padding:"6px 11px",fontSize:12}} onClick={()=>setClaseForm({...cl,isNew:false})}> Editar</button>
                <button style={{...S.btn("#EF5350"),padding:"6px 11px",fontSize:12}} onClick={()=>deleteClase(cl.key)}></button>
              </div>
            ))}
            <button style={{...S.btn("#4CAF50","#FFFFFF",true),padding:"12px 20px",width:"100%",marginTop:18,borderRadius:12}} onClick={()=>setClaseForm({key:"",nombre:"",color:"#5B2D8E",isNew:true})}>
               Nueva Clase
            </button>
          </div>
        ):(
          <div>
            <div style={{fontWeight:700,fontSize:15,color:"#5B2D8E",marginBottom:14}}>
              {claseForm.isNew?"Nueva Clase":"Editar: "+claseForm.nombre}
            </div>
            <label style={S.label}>Nombre de la clase</label>
            <input style={{...S.input,marginBottom:14}} value={claseForm.nombre}
              onChange={e=>setClaseForm(f=>({...f,nombre:e.target.value.toUpperCase()}))}
              placeholder="Ej: PRVULOS"/>
            <label style={S.label}>Color</label>
            <div style={{display:"flex",gap:8,flexWrap:"wrap",marginBottom:18}}>
              {COLORES_PRESET.map(c=>(
                <div key={c} onClick={()=>setClaseForm(f=>({...f,color:c}))}
                  style={{width:32,height:32,borderRadius:8,background:c,cursor:"pointer",
                    border:claseForm.color===c?"3px solid #2D1B4E":"3px solid transparent",
                    boxShadow:claseForm.color===c?"0 0 0 2px white inset":"none"}}>
                </div>
              ))}
            </div>
            <div style={{display:"flex",gap:8}}>
              <button style={{...S.btn("#F5F0FF","#5B2D8E"),padding:12,flex:1}} onClick={()=>setClaseForm(null)}> Volver</button>
              <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:12,flex:2}} onClick={saveClase}> Guardar Clase</button>
            </div>
          </div>
        )}
      </Modal>
    </div>
  );
}

//  FAMILIAS PANEL 
function FamiliasPanel({familias,onUpdate,clases={},onUpdateClases=()=>{},teacherMode=false,readOnly=false}){
  const[search,setSearch]=useState("");
  const[modal,setModal]=useState(false);
  const[form,setForm]=useState({});
  const[editId,setEditId]=useState(null);
  const empty={familia:"",padre:"",madre:"",telPadre:"",telMadre:"",alumno:"",edad:"",cumpleanos:"",nacimiento:"",clase:"CORDERITOS",bautizado:false,sellado:false};
  const conAlMenosUnPadre=familias.filter(f=>((f.padre||"").trim())||((f.madre||"").trim()));
  const filtered=conAlMenosUnPadre.filter(f=>{const q=search.toLowerCase();return!q||f.alumno?.toLowerCase().includes(q)||f.familia?.toLowerCase().includes(q)||f.padre?.toLowerCase().includes(q)||f.madre?.toLowerCase().includes(q);});
  const grouped={};
  filtered.forEach(f=>{const k=f.familia||f.alumno;if(!grouped[k])grouped[k]=[];grouped[k].push(f);});
  const openEdit=(f)=>{if(!readOnly){setForm({...empty,...f});setEditId(f.id);setModal(true);}};
  const save=()=>{
    const toSave={...form};
    if(toSave.nacimiento){
      try{
        const d=new Date(toSave.nacimiento);
        const hoy=new Date();
        toSave.cumpleanos=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;
        toSave.edad=String(hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0));
      }catch(e){}
    }
    const newFamilias=familias.map(f=>f.id===editId?{...toSave,id:editId}:f);
    onUpdate(newFamilias);
    // Sincronizar al alumno en Clases (mismo nombre y clase)
    const original=familias.find(f=>f.id===editId);
    if(original&&onUpdateClases){
      const oldClaseList=clases[original.clase]||[];
      const idx=oldClaseList.findIndex(n=>samePersonName(n.nombre,original.alumno));
      const alumnoEnClase=idx>=0?oldClaseList[idx]:null;
      const datosAlumno={nombre:(toSave.alumno||"").trim()||original.alumno,edad:toSave.edad||null,nacimiento:toSave.nacimiento||null,cumpleanos:toSave.cumpleanos||null,bautizado:!!toSave.bautizado,sellado:!!toSave.sellado};
      if(toSave.clase===original.clase){
        if(alumnoEnClase){
          const newList=oldClaseList.map((n,i)=>i===idx?{...n,...datosAlumno}:n);
          onUpdateClases({...clases,[original.clase]:newList});
        }
      }else{
        const newListOld=oldClaseList.filter((n,i)=>i!==idx);
        const newListNew=clases[toSave.clase]||[];
        const nuevoReg={...(alumnoEnClase||{id:Date.now(),foto:null}),...datosAlumno};
        onUpdateClases({...clases,[original.clase]:newListOld,[toSave.clase]:[...newListNew,nuevoReg]});
      }
    }
    setModal(false);
  };
  const updateMemberFoto=(id,foto)=>{ if(!readOnly)onUpdate(familias.map(f=>f.id===id?{...f,foto}:f)); };
  const updateFamilyFoto=(key,foto)=>{ if(!readOnly)onUpdate(familias.map(f=>(f.familia||f.alumno)===key?{...f,fotoFamilia:foto}:f)); };
  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14}}>
        <h2 style={S.title}>{teacherMode?" Familias de mi Clase":"Familias"}</h2>
        {readOnly&&<div style={{fontSize:12,color:"#7B6B9A"}}>Los datos se editan en la pestaa <strong>Alumnos</strong>.</div>}
        {!teacherMode&&!readOnly&&<div style={{fontSize:12,color:"#7B6B9A"}}>Los alumnos se agregan en la pestaa Alumnos</div>}
        {teacherMode&&!readOnly&&<div style={{fontSize:12,color:"#7B6B9A",fontStyle:"italic"}}>Edita telfonos y datos</div>}
      </div>
      <input style={{...S.input,marginBottom:14}} placeholder=" Buscar..." value={search} onChange={e=>setSearch(e.target.value)}/>
      {Object.entries(grouped).map(([key,members])=>{
        const fotoFam=members[0].fotoFamilia||null;
        return(
          <div key={key} style={{...S.card,borderLeft:"5px solid #5B2D8E"}}>
            {/* Family header with group photo */}
            <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:10}}>
              <AvatarUpload photo={fotoFam} onPhoto={readOnly?()=>{}:(f)=>updateFamilyFoto(key,f)} size={52} initials={(key||"?")[0].toUpperCase()+(key||"?")[1]?.toUpperCase()||"?"} color="#5B2D8E"/>
              <div style={{flex:1}}>
                <div style={{fontWeight:800,color:"#5B2D8E",fontSize:15}}> {key}</div>
                <div style={{fontSize:11,color:"#7B6B9A"}}>{members.length} alumno{members.length!==1?"s":""}</div>
              </div>
            </div>
            {/* Parents + phones */}
            {(members[0].padre||members[0].madre)&&(
              <div style={{background:"#F5F0FF",borderRadius:10,padding:"10px 12px",marginBottom:10}}>
                {members[0].padre&&members[0].padre!=="(No registra)"&&(
                  <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:6}}>
                    <span></span><span style={{fontSize:13,flex:1,fontWeight:600}}>{members[0].padre}</span>
                    {members[0].telPadre&&<a href={`tel:${members[0].telPadre}`} style={{background:"#4BBCE0",color:"#FFFFFF",borderRadius:10,padding:"5px 11px",fontSize:12,fontWeight:800,textDecoration:"none"}}> {members[0].telPadre}</a>}
                  </div>
                )}
                {members[0].madre&&members[0].madre!=="(No registra)"&&(
                  <div style={{display:"flex",alignItems:"center",gap:8}}>
                    <span></span><span style={{fontSize:13,flex:1,fontWeight:600}}>{members[0].madre}</span>
                    {members[0].telMadre&&<a href={`tel:${members[0].telMadre}`} style={{background:"#E84F9B",color:"#FFFFFF",borderRadius:10,padding:"5px 11px",fontSize:12,fontWeight:800,textDecoration:"none"}}> {members[0].telMadre}</a>}
                  </div>
                )}
              </div>
            )}
            {/* Members with individual photos */}
            {members.map((m,i)=>(
              <div key={m.id} style={{display:"flex",alignItems:"center",gap:10,padding:"10px 0",borderTop:i>0?"1px solid #DDD0F0":"none"}}>
                <AvatarUpload photo={m.foto||null} onPhoto={readOnly?()=>{}:(f)=>updateMemberFoto(m.id,f)} size={40} initials={getInitials(m.alumno)} color={CLASE_COLORS[m.clase]||"#4BBCE0"}/>
                <div style={{flex:1,minWidth:0}}>
                  <div style={{fontWeight:700,fontSize:13}}>{flipName(m.alumno)}</div>
              <div style={{fontSize:12,color:"#7B6B9A"}}>
                {m.edad}
                {m.cumpleanos?"   "+m.cumpleanos:""}
                {m.bautizado&&"   Bautizado"}
                {m.sellado&&"   Sellado"}
              </div>
                </div>
                <span style={S.badge(CLASE_COLORS[m.clase]||"#4BBCE0")}>{m.clase}</span>
                {!readOnly&&<button style={{...S.btn("#4BBCE0"),padding:"6px 10px",fontSize:12}} onClick={()=>openEdit(m)}></button>}
              </div>
            ))}
          </div>
        );
      })}
      <Modal open={modal} onClose={()=>setModal(false)} title={editId?"Editar Alumno":"Nuevo Miembro"}>
        {/* Photo uploader in modal */}
        <div style={{display:"flex",justifyContent:"center",marginBottom:18}}>
          <AvatarUpload photo={form.foto||null} onPhoto={(f)=>setForm(x=>({...x,foto:f}))} size={72} initials={form.alumno?getInitials(form.alumno):"?"} color="#5B2D8E"/>
        </div>
        {(teacherMode
          ?[["Padre","padre"],["Tel. Padre","telPadre"],["Madre","madre"],["Tel. Madre","telMadre"]]
          :[["Familia","familia"],["Padre","padre"],["Tel. Padre","telPadre"],["Madre","madre"],["Tel. Madre","telMadre"],["Alumno","alumno"],["Fecha de Nacimiento","nacimiento"]]
        ).map(([l,k])=>(
          <div key={k} style={{marginBottom:12}}><label style={S.label}>{l}</label><input style={S.input} value={form[k]||""} onChange={e=>setForm(f=>({...f,[k]:e.target.value}))} type={k==="nacimiento"?"date":(k.startsWith("tel")?"tel":"text")}/></div>
        ))}
        {!teacherMode&&form.nacimiento&&(function(){try{const d=new Date(form.nacimiento);const dd=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;const hoy=new Date();const edad=hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0);return <div style={{marginBottom:12,background:"#F5F0FF",borderRadius:10,padding:"8px 12px",fontSize:"0.8125rem",color:"#5B2D8E"}}> Cumpleaos: {dd}  {edad} aos (calculado automticamente)</div>;}catch(e){return null;}}())}
        {!teacherMode&&(
          <>
            <label style={S.label}>Clase</label>
            <select style={{...S.input,marginBottom:18}} value={form.clase||"CORDERITOS"} onChange={e=>setForm(f=>({...f,clase:e.target.value}))}>
              {CLASES_LIST.map(cl=><option key={cl} value={cl}>{cl}</option>)}
            </select>
            <div style={{display:"flex",gap:16,marginBottom:18,marginTop:4}}>
              <label style={{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#5B2D8E"}}>
                <input
                  type="checkbox"
                  checked={!!form.bautizado}
                  onChange={e=>setForm(f=>({
                    ...f,
                    bautizado:e.target.checked,
                    sellado:e.target.checked?false:f.sellado
                  }))}/>
                Bautizado
              </label>
              <label style={{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#5B2D8E"}}>
                <input
                  type="checkbox"
                  checked={!!form.sellado}
                  onChange={e=>setForm(f=>({
                    ...f,
                    sellado:e.target.checked,
                    bautizado:e.target.checked?false:f.bautizado
                  }))}/>
                Sellado
              </label>
            </div>
          </>
        )}
        <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={save}> Guardar</button>
        {editId&&!teacherMode&&<button style={{...S.btn("#FFF0F0","#EF5350"),padding:12,marginTop:10,border:"1.5px solid #EF535044"}} onClick={()=>{if(confirmDelete("Eliminar a "+flipName(form.alumno)+"?")){onUpdate(familias.filter(f=>f.id!==editId));setModal(false);}}}> Eliminar Miembro</button>}
      </Modal>
    </div>
  );
}

//  ALUMNOS PANEL (nica fuente de verdad; aqu se editan todos los alumnos) 
function AlumnosPanel({alumnos=[],onUpdateAlumnos,clasesConfig}){
  const cfg=getCfgList(clasesConfig);
  const[modal,setModal]=useState(false);
  const[editId,setEditId]=useState(null);
  const[form,setForm]=useState({nombre:"",clase:"CORDERITOS",nacimiento:"",padre:"",madre:"",telPadre:"",telMadre:"",familia:"",bautizado:false,sellado:false,foto:null});
  const sorted=[...(alumnos||[])].sort((a,b)=>flipName(a.nombre).localeCompare(flipName(b.nombre),"es"));

  const openAdd=()=>{ setForm({nombre:"",clase:cfg[0]?.key||"CORDERITOS",nacimiento:"",padre:"",madre:"",telPadre:"",telMadre:"",familia:"",bautizado:false,sellado:false,foto:null}); setEditId(null); setModal(true); };
  const openEdit=(a)=>{
    setForm({ nombre: a.nombre, clase: normalizarClase(a.clase), nacimiento: a.nacimiento||"", padre: a.padre||"", madre: a.madre||"", telPadre: a.telPadre||"", telMadre: a.telMadre||"", familia: a.familia||"", bautizado: !!a.bautizado, sellado: !!a.sellado, foto: a.foto||null });
    setEditId(a.id);
    setModal(true);
  };
  const save=()=>{
    const nombre=(form.nombre||"").trim();
    if(!nombre)return;
    let edad=null,cumpleanos=null;
    if(form.nacimiento){
      try{
        const d=new Date(form.nacimiento);
        const hoy=new Date();
        edad=String(hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0));
        cumpleanos=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;
      }catch(e){}
    }
    const claseKey=normalizarClase(form.clase);
    const record={ id: editId||Date.now(), nombre, clase: claseKey, nacimiento: form.nacimiento||null, padre: (form.padre||"").trim(), madre: (form.madre||"").trim(), telPadre: (form.telPadre||"").trim(), telMadre: (form.telMadre||"").trim(), familia: (form.familia||"").trim(), bautizado: !!form.bautizado, sellado: !!form.sellado, foto: form.foto||null };
    if(editId){
      onUpdateAlumnos((alumnos||[]).map(a=>a.id===editId?record:a));
    }else{
      onUpdateAlumnos([...(alumnos||[]),record]);
    }
    setModal(false);
  };
  const deleteAlumno=(a)=>{
    if(!confirmDelete("Eliminar a "+flipName(a.nombre)+"?"))return;
    onUpdateAlumnos((alumnos||[]).filter(x=>x.id!==a.id));
    setModal(false);
  };

  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <div style={{marginBottom:14}}>
        <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:8}}>
          <h2 style={S.title}>Alumnos</h2>
          <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:"10px 16px"}} onClick={openAdd}>+ Agregar alumno</button>
        </div>
        <div style={{fontSize:12,color:"#7B6B9A",marginTop:4}}>Lista nica; las clases y familias se derivan de aqu. Solo aqu se editan alumnos.</div>
      </div>
      {sorted.length===0?(
        <div style={{textAlign:"center",padding:"40px 20px",color:"#7B6B9A",fontSize:14}}>No hay alumnos. Agrega el primero desde el botn superior.</div>
      ):(
        sorted.map(a=>{
          const color=getCfgColor(normalizarClase(a.clase),clasesConfig);
          return(
            <div key={a.id} style={{...S.card,display:"flex",alignItems:"center",gap:12,borderLeft:"4px solid "+color}}>
              <AvatarUpload photo={a.foto} onPhoto={()=>{}} size={44} initials={getInitials(a.nombre)} color={color}/>
              <div style={{flex:1,minWidth:0}}>
                <div style={{fontWeight:700}}>{flipName(a.nombre)}</div>
                <div style={{fontSize:12,color:"#7B6B9A"}}>{normalizarClase(a.clase)}  {(a.padre||a.madre)?"":""}</div>
              </div>
              <span style={S.badge(color)}>{normalizarClase(a.clase)}</span>
              <button style={{...S.btn("#4BBCE0"),padding:"8px 12px"}} onClick={()=>openEdit(a)} title="Editar"></button>
              <button style={{...S.btn("#FFF0F0","#EF5350"),padding:"8px 12px"}} onClick={()=>deleteAlumno(a)} title="Eliminar"></button>
            </div>
          );
        })
      )}

      <Modal open={modal} onClose={()=>setModal(false)} title={editId?"Editar Alumno":"Agregar Alumno"}>
        <div style={{display:"flex",justifyContent:"center",marginBottom:18}}>
          <AvatarUpload photo={form.foto} onPhoto={(f)=>setForm(x=>({...x,foto:f}))} size={72} initials={form.nombre?getInitials(form.nombre):"?"} color="#5B2D8E"/>
        </div>
        <label style={S.label}>Nombre completo</label>
        <input style={{...S.input,marginBottom:12}} placeholder="Ej: Jos Luis Mogolln" value={form.nombre} onChange={e=>setForm(f=>({...f,nombre:e.target.value}))}/>
        <label style={S.label}>Clase</label>
        <select style={{...S.input,marginBottom:12}} value={normalizarClase(form.clase)} onChange={e=>setForm(f=>({...f,clase:e.target.value}))}>
          {cfg.map(c=><option key={c.key} value={c.key}>{c.nombre}</option>)}
        </select>
        <label style={S.label}>Familia (apellido o nombre del grupo)</label>
        <input style={{...S.input,marginBottom:12}} placeholder="Ej: Mogolln Muoz" value={form.familia} onChange={e=>setForm(f=>({...f,familia:e.target.value}))}/>
        <label style={S.label}>Padre</label>
        <input style={{...S.input,marginBottom:12}} value={form.padre} onChange={e=>setForm(f=>({...f,padre:e.target.value}))}/>
        <label style={S.label}>Madre</label>
        <input style={{...S.input,marginBottom:12}} value={form.madre} onChange={e=>setForm(f=>({...f,madre:e.target.value}))}/>
        <label style={S.label}>Tel. Padre</label>
        <input type="tel" style={{...S.input,marginBottom:12}} value={form.telPadre} onChange={e=>setForm(f=>({...f,telPadre:e.target.value}))}/>
        <label style={S.label}>Tel. Madre</label>
        <input type="tel" style={{...S.input,marginBottom:12}} value={form.telMadre} onChange={e=>setForm(f=>({...f,telMadre:e.target.value}))}/>
        <label style={S.label}>Fecha de nacimiento</label>
        <input type="date" style={{...S.input,marginBottom:12}} value={form.nacimiento||""} onChange={e=>setForm(f=>({...f,nacimiento:e.target.value}))}/>
        {form.nacimiento&&(function(){try{const d=new Date(form.nacimiento);const dd=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;const hoy=new Date();const edad=hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0);return <div style={{marginBottom:12,background:"#F5F0FF",borderRadius:10,padding:"8px 12px",fontSize:12,color:"#5B2D8E"}}> {dd}  {edad} aos</div>;}catch(e){return null;}}())}
        <div style={{display:"flex",gap:16,marginBottom:18}}>
          <label style={{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#5B2D8E"}}>
            <input type="checkbox" checked={!!form.bautizado} onChange={e=>setForm(f=>({...f,bautizado:e.target.checked,sellado:e.target.checked?false:f.sellado}))}/>
            Bautizado
          </label>
          <label style={{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#5B2D8E"}}>
            <input type="checkbox" checked={!!form.sellado} onChange={e=>setForm(f=>({...f,sellado:e.target.checked,bautizado:e.target.checked?false:f.bautizado}))}/>
            Sellado
          </label>
        </div>
        <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={save}> Guardar</button>
        {editId&&<button style={{...S.btn("#FFF0F0","#EF5350"),padding:12,marginTop:10,border:"1.5px solid #EF535044"}} onClick={()=>{const a=(alumnos||[]).find(x=>x.id===editId);if(a)deleteAlumno(a);}}> Eliminar</button>}
      </Modal>
    </div>
  );
}

//  CALIFICACIONES ADMIN 
function CalifAdminPanel({calificaciones,clases,criterios,onUpdate,cronograma=[],meriendas=[]}){
  const[activeClase,setActiveClase]=useState("CORDERITOS");
  const[viewMode,setViewMode]=useState("alumnos"); // "alumnos" | "sesiones"
  const ckeys=criterios.map(c=>c.key);
  const rowAvg=(entries)=>{let t=0,cnt=0;entries.forEach(e=>{ckeys.forEach(k=>{const v=parseFloat(e[k]);if(!isNaN(v)){t+=v;cnt++;}});});return cnt?(t/cnt).toFixed(1):null;};
  const getSesClaseCalifs=(sesionId)=>calificaciones.filter(c=>c.clase===activeClase&&c.sesionId===sesionId);
  const getSesAvgAll=(sesionId)=>{
    const entr=getSesClaseCalifs(sesionId);
    if(!entr.length)return null;
    let t=0,cnt=0;entr.forEach(e=>{ckeys.forEach(k=>{const v=parseFloat(e[k]);if(!isNaN(v)){t+=v;cnt++;}});});
    return cnt?(t/cnt).toFixed(1):null;
  };
  const sesiones=[...new Map(calificaciones.filter(c=>c.clase===activeClase).map(c=>[c.sesionId,c])).values()].sort((a,b)=>new Date(a.fecha)-new Date(b.fecha)).map(c=>{
    const cronEntry=cronograma.find(x=>x.id===c.sesionId)||{};
    return{...c,tema:c.tema||cronEntry.tema||""};
  });
  const totalNinos=(clases[activeClase]||[]).length;
  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <h2 style={S.title}>Calificaciones</h2>
      <div style={{display:"flex",gap:8,overflowX:"auto",paddingBottom:8,marginBottom:10}}>
        {CLASES_LIST.map(cl=>(
          <button key={cl} style={{...S.btn(activeClase===cl?CLASE_COLORS[cl]:"#F5F0FF",activeClase===cl?(cl==="VENCEDORES"?"#3D1B6B":"#FFFFFF"):"#2D1B4E"),padding:"8px 14px",fontSize:12,flexShrink:0,borderRadius:20}} onClick={()=>setActiveClase(cl)}>{cl}</button>
        ))}
      </div>
      <div style={{display:"flex",gap:8,marginBottom:16}}>
        <button style={{...S.btn(viewMode==="alumnos"?"#5B2D8E":"#F5F0FF",viewMode==="alumnos"?"#FFFFFF":"#2D1B4E"),flex:1,padding:"10px",borderRadius:12,fontSize:13}} onClick={()=>setViewMode("alumnos")}> Por Alumno</button>
        <button style={{...S.btn(viewMode==="sesiones"?"#4BBCE0":"#F5F0FF",viewMode==="sesiones"?"#FFFFFF":"#2D1B4E"),flex:1,padding:"10px",borderRadius:12,fontSize:13}} onClick={()=>setViewMode("sesiones")}> Por Sesin</button>
      </div>
      {viewMode==="alumnos"&&(clases[activeClase]||[]).map(n=>{
        const entries=calificaciones.filter(c=>c.alumno===n.nombre&&c.clase===activeClase).sort((a,b)=>new Date(a.fecha)-new Date(b.fecha));
        const avg=rowAvg(entries);
        const allObs=entries.filter(e=>e.observacion).map(e=>({texto:e.observacion,fecha:e.fecha,leccion:e.leccion}));
        return(
          <div key={n.nombre||n.id} style={{...S.card,borderLeft:`5px solid ${CLASE_COLORS[activeClase]}`}}>
            <div style={{display:"flex",alignItems:"center",gap:10,marginBottom:10}}>
              {n.foto
                ?<img src={n.foto} alt="" style={{width:40,height:40,borderRadius:"50%",objectFit:"cover",border:`2px solid ${CLASE_COLORS[activeClase]}`,flexShrink:0}}/>
                :<div style={{width:40,height:40,borderRadius:"50%",background:CLASE_COLORS[activeClase]+"33",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,color:CLASE_COLORS[activeClase],flexShrink:0}}>{getInitials(n.nombre)}</div>
              }
              <div style={{flex:1}}><div style={{fontWeight:800,fontSize:14}}>{flipName(n.nombre)}</div><div style={{fontSize:12,color:"#7B6B9A"}}>{entries.length} sesiones</div></div>
              {avg&&<div style={{background:scoreColor(avg)+"20",borderRadius:10,padding:"8px 12px",textAlign:"center"}}><div style={{fontSize:22,fontWeight:900,color:scoreColor(avg)}}>{avg}</div><div style={{fontSize:10,color:"#7B6B9A"}}>prom.</div></div>}
            </div>
            {entries.length===0&&<div style={{display:"flex",alignItems:"center",gap:8,padding:"10px 12px",background:"#EF535012",borderRadius:10,marginBottom:8}}><span style={{fontSize:14}}></span><span style={{fontSize:13,color:"#EF5350",fontWeight:700}}>Ausente  Sin calificaciones registradas</span></div>}
            {entries.map((e)=>(
              <div key={e.id} style={{background:"#F5F0FF",borderRadius:12,padding:"12px 14px",marginBottom:8}}>
                <div style={{display:"flex",justifyContent:"space-between",marginBottom:8}}>
                  <span style={S.badge("#5B2D8E")}>{e.leccion}  {formatFecha(e.fecha)}</span>

                </div>
                <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:5}}>
                  {criterios.map(c=>(
                    <div key={c.key} style={{fontSize:12}}><span style={{color:"#7B6B9A"}}>{c.logro}: </span><strong style={{color:scoreColor(e[c.key])}}>{e[c.key]||""}</strong></div>
                  ))}
                </div>
              </div>
            ))}
            {allObs.length>0&&(
              <div style={{marginTop:10,background:"linear-gradient(135deg,#F5C84215,#F5C84230)",border:"1.5px solid #F5C84255",borderRadius:12,padding:"12px 14px"}}>
                <div style={{fontWeight:800,color:"#7B5A00",fontSize:13,marginBottom:10}}> Registro de Observaciones</div>
                {allObs.map((obs,i)=>(
                  <div key={i} style={{marginBottom:i<allObs.length-1?12:0,paddingBottom:i<allObs.length-1?12:0,borderBottom:i<allObs.length-1?"1px dashed #F5C84280":"none"}}>
                    <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:4}}>
                      <span style={S.badge("#5B2D8E")}>{obs.leccion}</span>
                      <span style={{fontSize:11,color:"#7B6B9A",fontWeight:600}}> {formatFecha(obs.fecha)}</span>
                    </div>
                    <div style={{fontSize:13,color:"#2D1B4E",lineHeight:1.5,background:"#FFFFFF88",borderRadius:8,padding:"8px 10px"}}>{obs.texto}</div>
                  </div>
                ))}
              </div>
            )}
          </div>
        );
      })}
      {viewMode==="sesiones"&&(
        <div>
          {sesiones.length===0&&<div style={{color:"#7B6B9A",textAlign:"center",padding:30}}>Sin sesiones calificadas an.</div>}
          {sesiones.map(ses=>{
            const sesCalifs=getSesClaseCalifs(ses.sesionId);
            const avg=getSesAvgAll(ses.sesionId);
            const m=meriendas.find(x=>x.sesionId===ses.sesionId);
            const totalGasto=((parseFloat(m?.meriendaCosto)||0)+(parseFloat(m?.trabajoManualCosto)||0));
            const asistentes=sesCalifs.length;
            const pct=totalNinos?Math.round((asistentes/totalNinos)*100):0;
            return(
              <div key={ses.sesionId} style={{...S.card,borderLeft:`5px solid ${CLASE_COLORS[activeClase]||"#5B2D8E"}`}}>
                <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:10,flexWrap:"wrap",gap:8}}>
                  <div>
                    <div style={{fontWeight:900,fontSize:15,color:"#2D1B4E"}}>{ses.leccion}</div>
                    <div style={{fontSize:12,color:"#7B6B9A"}}>{formatFecha(ses.fecha)}  {ses.tema||"Sin tema registrado"}</div>
                  </div>
                  {avg&&<div style={{background:scoreColor(avg)+"25",borderRadius:12,padding:"8px 14px",textAlign:"center"}}>
                    <div style={{fontSize:22,fontWeight:900,color:scoreColor(avg)}}>{avg}</div>
                    <div style={{fontSize:10,color:"#7B6B9A"}}>prom. clase</div>
                  </div>}
                </div>
                <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:10}}>
                  <div style={{background:"#5B2D8E12",borderRadius:10,padding:"10px 12px"}}>
                    <div style={{fontSize:10,color:"#5B2D8E",fontWeight:800,marginBottom:4}}>ASISTENCIA</div>
                    <div style={{fontWeight:900,fontSize:18,color:"#5B2D8E"}}>{asistentes}/{totalNinos}</div>
                    <div style={{fontSize:11,color:"#7B6B9A"}}>{pct}% de la clase</div>
                    <div style={{marginTop:6,background:"#DDD0F0",borderRadius:4,height:6,overflow:"hidden"}}>
                      <div style={{height:"100%",background:pct>=80?"#4CAF50":pct>=60?"#F5C842":"#EF5350",width:pct+"%",borderRadius:4}}/>
                    </div>
                  </div>
                  <div style={{background:totalGasto>0?"#4CAF5012":"#F5F0FF",borderRadius:10,padding:"10px 12px",border:totalGasto>0?"2px solid #4CAF5033":"none"}}>
                    <div style={{fontSize:10,color:totalGasto>0?"#2E7D32":"#7B6B9A",fontWeight:800,marginBottom:4}}>GASTOS</div>
                    {totalGasto>0?<>
                      <div style={{fontWeight:900,fontSize:18,color:"#2E7D32"}}>{totalGasto.toFixed(2)}</div>
                      <div style={{fontSize:11,color:"#7B6B9A"}}>{m?.merienda?" Merienda":""}{m?.merienda&&m?.trabajoManual?" + ":""}{m?.trabajoManual?" T.Manual":""}</div>
                    </>:<div style={{fontWeight:700,fontSize:13,color:"#CCC",marginTop:6}}>Sin gastos</div>}
                  </div>
                </div>
                {sesCalifs.length>0&&(
                  <div>
                    <div style={{fontSize:11,fontWeight:800,color:"#7B6B9A",marginBottom:6,letterSpacing:0.5}}>ALUMNOS PRESENTES</div>
                    <div style={{display:"flex",flexWrap:"wrap",gap:6}}>
                      {sesCalifs.map((e,i)=>{
                        let t=0,cnt=0;ckeys.forEach(k=>{const v=parseFloat(e[k]);if(!isNaN(v)){t+=v;cnt++;}});
                        const a=cnt?(t/cnt).toFixed(1):null;
                        return <div key={i} style={{background:a?scoreColor(a)+"20":"#F5F0FF",borderRadius:8,padding:"4px 10px",fontSize:12,border:`1.5px solid ${a?scoreColor(a)+"44":"#DDD0F0"}`}}>
                          <span style={{fontWeight:700}}>{flipName(e.alumno)}</span>{a&&<span style={{color:scoreColor(a),fontWeight:800}}> {a}</span>}
                        </div>;
                      })}
                    </div>
                    {sesCalifs.some(e=>e.observacion)&&(
                      <div style={{marginTop:10,background:"#F5C84210",border:"1.5px solid #F5C84244",borderRadius:10,padding:"10px 12px"}}>
                        <div style={{fontSize:11,fontWeight:800,color:"#7B5A00",marginBottom:6}}> OBSERVACIONES</div>
                        {sesCalifs.filter(e=>e.observacion).map((e,i)=>(
                          <div key={i} style={{fontSize:12,color:"#2D1B4E",marginBottom:4,lineHeight:1.5}}><strong>{flipName(e.alumno)}:</strong> {e.observacion}</div>
                        ))}
                      </div>
                    )}
                  </div>
                )}
              </div>
            );
          })}
        </div>
      )}
    </div>
  );
}

//  EVALUACIONES ADMIN 
function EvaluacionesPanel({evaluaciones,onUpdate,videos=[]}){
  const[editModal,setEditModal]=useState(false);
  const[editForm,setEditForm]=useState(null);
  const[editIdx,setEditIdx]=useState(null);
  const openEdit=(ev,i)=>{setEditForm({...ev});setEditIdx(i);setEditModal(true);};
  const save=()=>{onUpdate(evaluaciones.map((e,i)=>i===editIdx?editForm:e));setEditModal(false);};
  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <h2 style={S.title}>Evaluaciones Maestros</h2>
      {evaluaciones.map((ev,i)=>{
        const vAvg=videoAvgForMaestro(ev.nombre,videos);
        const avg=evalAvg(ev,vAvg);const avgN=parseFloat(avg);const color=avgN>=4.5?"#4CAF50":avgN>=3.5?"#F5A623":"#EF5350";
        return(
          <div key={i} style={{...S.card,borderLeft:`5px solid ${color}`}}>
            <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:10}}>
              <div style={{width:44,height:44,borderRadius:"50%",background:"#5B2D8E22",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,color:"#5B2D8E"}}>{getInitials(ev.nombre)}</div>
              <div style={{flex:1}}><div style={{fontWeight:800,fontSize:14}}>{flipName(ev.nombre)}</div>
                {vAvg!=null&&<div style={{fontSize:11,color:"#4BBCE0",fontWeight:700}}> Video: {vAvg.toFixed(1)}/5  incl. en promedio</div>}
              </div>
              <div style={{textAlign:"center",background:color+"20",borderRadius:12,padding:"8px 14px"}}>
                <div style={{fontSize:22,fontWeight:900,color}}>{avg}</div><div style={{fontSize:10,color:"#7B6B9A"}}>/5.0</div>
              </div>
              <button style={{...S.btn("#4BBCE0"),padding:"8px 12px",fontSize:13}} onClick={()=>openEdit(ev,i)}></button>
            </div>
            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8}}>
              {EVAL_KEYS.map((k,j)=>(
                <div key={k} style={{background:k==="cumplimientoClases"?"linear-gradient(135deg,#5B2D8E15,#5B2D8E25)":"#F5F0FF",borderRadius:10,padding:"8px 10px",border:k==="cumplimientoClases"?"1.5px solid #5B2D8E44":"none"}}>
                  <div style={{fontSize:10,color:k==="cumplimientoClases"?"#5B2D8E":"#7B6B9A",marginBottom:4,fontWeight:k==="cumplimientoClases"?800:400}}>{EVAL_LABELS[j]}</div>
                  <div style={{display:"flex",gap:1}}>{[1,2,3,4,5].map(s=><span key={s} style={{color:s<=(ev[k]||0)?"#F5C842":"#e0e0e0",fontSize:16}}></span>)}</div>
                </div>
              ))}
            </div>
          </div>
        );
      })}
      <Modal open={editModal} onClose={()=>setEditModal(false)} title={`Editar: ${editForm?flipName(editForm.nombre):""}`}>
        {editForm&&EVAL_KEYS.map((k,j)=>(
          <div key={k} style={{marginBottom:16}}>
            <label style={S.label}>{EVAL_LABELS[j]}</label>
            <div style={{display:"flex",gap:8,justifyContent:"center"}}>
              {[1,2,3,4,5].map(s=>(
                <button key={s} onClick={()=>setEditForm(f=>({...f,[k]:s}))}
                  style={{width:44,height:44,borderRadius:12,border:`2px solid ${editForm[k]===s?"#F5C842":"#DDD0F0"}`,background:editForm[k]===s?"#5B2D8E":"#F5F0FF",color:editForm[k]===s?"#F5C842":"#7B6B9A",fontWeight:900,cursor:"pointer",fontSize:22,fontFamily:"inherit"}}></button>
              ))}
            </div>
          </div>
        ))}
        <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14,marginTop:8}} onClick={save}> Guardar</button>
      </Modal>
    </div>
  );
}

//  VIDEOS PANEL 
// Solo para clases que requieren video: CORDERITOS, VENCEDORES, CONQUISTADORES
function VideosPanel({videos,onUpdate,cronograma,maestros}){
  const[selClase,setSelClase]=useState("CORDERITOS");
  const[editModal,setEditModal]=useState(false);
  const[editVideo,setEditVideo]=useState(null); // {sesionId, maestro, hizo, calidad, aTiempo}

  // Sesiones relevantes (con maestro asignado, solo VIDEO_CLASES)
  const sesiones=cronograma
    .filter(c=>VIDEO_CLASES.includes(c.grupo)&&c.maestro&&c.leccion!=="NO HAY CLASE")
    .sort((a,b)=>b.fecha.localeCompare(a.fecha));
  const sesionesFiltradas=sesiones.filter(c=>c.grupo===selClase);

  const getVideo=(sesionId,maestro)=>videos.find(v=>v.sesionId===sesionId&&v.maestro===maestro)||null;

  const openEdit=(ses)=>{
    const v=getVideo(ses.id,ses.maestro)||{sesionId:ses.id,maestro:ses.maestro,grupo:ses.grupo,fecha:ses.fecha,hizo:false,calidad:3,aTiempo:false};
    setEditVideo({...v,leccion:ses.leccion,fecha:ses.fecha});
    setEditModal(true);
  };

  const saveVideo=()=>{
    const {leccion:_,fecha:_f,...toSave}=editVideo;
    const exists=videos.findIndex(v=>v.sesionId===toSave.sesionId&&v.maestro===toSave.maestro);
    if(exists>=0)onUpdate(videos.map((v,i)=>i===exists?toSave:v));
    else onUpdate([...videos,toSave]);
    setEditModal(false);
  };

  // Stats por maestro para la clase seleccionada
  const maestrosClase=[...new Set(sesionesFiltradas.map(s=>s.maestro).filter(Boolean))];

  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <h2 style={S.title}> Videos de Clase</h2>
      <div style={{background:"linear-gradient(135deg,#4BBCE015,#5B2D8E15)",border:"1.5px solid #4BBCE055",borderRadius:14,padding:"12px 14px",marginBottom:16,fontSize:13,color:"#2D1B4E"}}>
        <div style={{fontWeight:800,marginBottom:4}}> Cmo funciona?</div>
        <div style={{color:"#5B2D8E",fontSize:12}}>Cada maestro debe grabar un video de su clase para presentarlo el prximo domingo. Aqu puedes calificar si lo hizo, si qued bien y si lo envi a tiempo. La puntuacin <strong>afecta el promedio de evaluacin</strong> del maestro (20% del total).</div>
      </div>

      {/* Tabs por clase */}
      <div style={{display:"flex",gap:8,marginBottom:16,overflowX:"auto",paddingBottom:4}}>
        {VIDEO_CLASES.map(cl=>(
          <button key={cl}
            style={{...S.btn(selClase===cl?CLASE_COLORS[cl]:"#F5F0FF",selClase===cl?(cl==="VENCEDORES"?"#3D1B6B":"#FFFFFF"):"#2D1B4E"),padding:"8px 16px",fontSize:12,flexShrink:0,borderRadius:20}}
            onClick={()=>setSelClase(cl)}>
            {cl}
          </button>
        ))}
      </div>

      {/* Resumen por maestro */}
      {maestrosClase.length>0&&(
        <div style={{...S.card,borderLeft:"5px solid #4BBCE0",marginBottom:16}}>
          <div style={{fontWeight:800,color:"#2A96BC",fontSize:13,marginBottom:10}}> Resumen de maestros  {selClase}</div>
          {maestrosClase.map(m=>{
            const vs=videos.filter(v=>v.maestro===m&&v.grupo===selClase);
            const hechos=vs.filter(v=>v.hizo).length;
            const avg=videoAvgForMaestro(m,videos.filter(v=>v.grupo===selClase));
            return(
              <div key={m} style={{display:"flex",alignItems:"center",gap:10,padding:"8px 0",borderBottom:"1px solid #EEE8FF"}}>
                <div style={{width:36,height:36,borderRadius:"50%",background:CLASE_COLORS[selClase]+"33",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,color:CLASE_COLORS[selClase],fontSize:12,flexShrink:0}}>{getInitials(m)}</div>
                <div style={{flex:1}}>
                  <div style={{fontWeight:700,fontSize:13}}>{flipName(m)}</div>
                  <div style={{fontSize:11,color:"#7B6B9A"}}>{hechos} de {vs.length} videos enviados</div>
                </div>
                {avg!=null&&(
                  <div style={{textAlign:"center",background:"#4BBCE020",borderRadius:10,padding:"6px 12px"}}>
                    <div style={{fontWeight:900,color:"#2A96BC",fontSize:16}}>{avg.toFixed(1)}</div>
                    <div style={{fontSize:9,color:"#7B6B9A"}}>SCORE</div>
                  </div>
                )}
              </div>
            );
          })}
        </div>
      )}

      {/* Lista de sesiones */}
      {sesionesFiltradas.length===0&&(
        <div style={{textAlign:"center",padding:"40px 20px",color:"#7B6B9A",fontSize:14}}>
          No hay sesiones programadas para {selClase} an.
        </div>
      )}
      {sesionesFiltradas.map(ses=>{
        const v=getVideo(ses.id,ses.maestro);
        const score=v?videoScore(v):null;
        const scoreColor=score==null?"#7B6B9A":score>=4?"#4CAF50":score>=2.5?"#F5A623":"#EF5350";
        return(
          <div key={ses.id} style={{...S.card,borderLeft:`5px solid ${v?scoreColor:"#DDD0F0"}`}}>
            <div style={{display:"flex",alignItems:"center",gap:10,marginBottom:8}}>
              <div style={{flex:1}}>
                <div style={{fontWeight:800,fontSize:14}}>{ses.leccion}</div>
                {ses.tema&&<div style={{fontSize:12,color:"#7B6B9A"}}>{ses.tema}</div>}
                <div style={{fontSize:11,color:"#7B6B9A",marginTop:2}}> {ses.fecha}   {flipName(ses.maestro)}</div>
              </div>
              <button style={{...S.btn("#4BBCE0"),padding:"8px 13px",fontSize:13}} onClick={()=>openEdit(ses)}>
                {v?"":""}
              </button>
            </div>
            {v?(
              <div style={{display:"flex",gap:8,flexWrap:"wrap"}}>
                <span style={{...S.badge(v.hizo?"#4CAF50":"#EF5350"),fontSize:11}}>{v.hizo?" Video enviado":" No enviado"}</span>
                {v.hizo&&<span style={{...S.badge("#F5C842"),fontSize:11}}> Calidad: {v.calidad}/5</span>}
                {v.hizo&&<span style={{...S.badge(v.aTiempo?"#4CAF50":"#FF7043"),fontSize:11}}>{v.aTiempo?" A tiempo":" Tarde"}</span>}
                {score!=null&&<span style={{...S.badge(scoreColor),fontSize:11}}> Score: {score.toFixed(1)}/5</span>}
              </div>
            ):(
              <div style={{fontSize:12,color:"#7B6B9A",fontStyle:"italic"}}>Sin calificar  Toca  para evaluar</div>
            )}
          </div>
        );
      })}

      {/* Modal editar/calificar video */}
      <Modal open={editModal} onClose={()=>setEditModal(false)} title=" Calificar Video">
        {editVideo&&(
          <div>
            <div style={{background:"#F5F0FF",borderRadius:12,padding:"12px 14px",marginBottom:16}}>
              <div style={{fontWeight:800,color:"#5B2D8E"}}>{editVideo.leccion}</div>
              <div style={{fontSize:12,color:"#7B6B9A",marginTop:2}}> {editVideo.fecha}   {flipName(editVideo.maestro)}</div>
            </div>

            {/* Hizo el video? */}
            <label style={S.label}>El maestro envi el video?</label>
            <div style={{display:"flex",gap:10,marginBottom:16}}>
              {[[true," S, lo envi","#4CAF50"],[false," No lo envi","#EF5350"]].map(([val,lbl,col])=>(
                <button key={String(val)} onClick={()=>setEditVideo(v=>({...v,hizo:val}))}
                  style={{flex:1,padding:"12px 8px",borderRadius:12,border:`2px solid ${editVideo.hizo===val?col:"#DDD0F0"}`,background:editVideo.hizo===val?col+"22":"#F5F0FF",color:editVideo.hizo===val?col:"#7B6B9A",fontWeight:700,cursor:"pointer",fontSize:13,fontFamily:"inherit"}}>
                  {lbl}
                </button>
              ))}
            </div>

            {editVideo.hizo&&(
              <>
                {/* Calidad del video */}
                <label style={S.label}> Calidad del video (15)</label>
                <div style={{display:"flex",gap:8,justifyContent:"center",marginBottom:16}}>
                  {[1,2,3,4,5].map(s=>(
                    <button key={s} onClick={()=>setEditVideo(v=>({...v,calidad:s}))}
                      style={{width:46,height:46,borderRadius:12,border:`2px solid ${editVideo.calidad===s?"#F5C842":"#DDD0F0"}`,background:editVideo.calidad===s?"#5B2D8E":"#F5F0FF",color:editVideo.calidad===s?"#F5C842":"#7B6B9A",fontWeight:900,cursor:"pointer",fontSize:22,fontFamily:"inherit"}}></button>
                  ))}
                </div>

                {/* A tiempo? */}
                <label style={S.label}> Lo envi a tiempo?</label>
                <div style={{display:"flex",gap:10,marginBottom:20}}>
                  {[[true," S, a tiempo","#4CAF50"],[false," No, tarde","#FF7043"]].map(([val,lbl,col])=>(
                    <button key={String(val)} onClick={()=>setEditVideo(v=>({...v,aTiempo:val}))}
                      style={{flex:1,padding:"12px 8px",borderRadius:12,border:`2px solid ${editVideo.aTiempo===val?col:"#DDD0F0"}`,background:editVideo.aTiempo===val?col+"22":"#F5F0FF",color:editVideo.aTiempo===val?col:"#7B6B9A",fontWeight:700,cursor:"pointer",fontSize:13,fontFamily:"inherit"}}>
                      {lbl}
                    </button>
                  ))}
                </div>

                {/* Preview del score calculado */}
                <div style={{background:"linear-gradient(135deg,#4BBCE015,#5B2D8E15)",borderRadius:12,padding:"0.75rem 1rem",marginBottom:16,textAlign:"center"}}>
                  <div style={{fontSize:12,color:"#7B6B9A",marginBottom:4}}>Score calculado para este video</div>
                  <div style={{fontSize:28,fontWeight:900,color:"#5B2D8E"}}>{videoScore(editVideo).toFixed(1)}<span style={{fontSize:14,color:"#7B6B9A"}}>/5</span></div>
                  <div style={{fontSize:11,color:"#7B6B9A",marginTop:4}}>Este score afecta el 20% del promedio de evaluacin</div>
                </div>
              </>
            )}

            <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={saveVideo}> Guardar Calificacin</button>
          </div>
        )}
      </Modal>
    </div>
  );
}

//  EVENTOS PANEL 
function EventosPanel({eventos,onUpdate,readOnly=false}){
  const[modal,setModal]=useState(false);
  const[form,setForm]=useState({fecha:"",tipo:"LOCAL",nombre:""});
  const[editId,setEditId]=useState(null);
  const openAdd=()=>{setForm({fecha:"",tipo:"LOCAL",nombre:""});setEditId(null);setModal(true);};
  const openEdit=(e)=>{setForm({...e});setEditId(e.id);setModal(true);};
  const save=()=>{if(editId)onUpdate(eventos.map(e=>e.id===editId?{...form,id:editId}:e));else onUpdate([...eventos,{...form,id:Date.now()}]);setModal(false);};
  //  Detect past events (cumplidos)
  const isCumplido=(fechaStr)=>{
    if(!fechaStr)return false;
    // Try DD/MM/AAAA or DD/MM/YYYY
    const m=fechaStr.match(/(\d{1,2})\/(\d{1,2})(?:\/(\d{4}))?/);
    if(!m)return false;
    const day=parseInt(m[1]),month=parseInt(m[2])-1,year=m[3]?parseInt(m[3]):new Date().getFullYear();
    const d=new Date(year,month,day);
    return d<new Date(new Date().toDateString()); // before today (midnight)
  };
  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14}}>
        <h2 style={S.title}>Eventos</h2>
        {!readOnly&&<button style={{...S.btn("#5B2D8E"),padding:"10px 16px",fontSize:14}} onClick={openAdd}>+ Agregar</button>}
      </div>
      {["NACIONAL","LOCAL"].map(tipo=>(
        <div key={tipo} style={{...S.card,borderTop:`5px solid ${tipo==="NACIONAL"?"#5B2D8E":"#4BBCE0"}`}}>
          <h3 style={{color:tipo==="NACIONAL"?"#5B2D8E":"#2A96BC",fontWeight:800,marginBottom:14,fontSize:15}}>{tipo==="NACIONAL"?" Nacionales / Distritales":" Eventos Locales"}</h3>
          {eventos.filter(e=>e.tipo===tipo).map((e)=>{
            const cumplido=isCumplido(e.fecha);
            return(
              <div key={e.id} style={{display:"flex",alignItems:"flex-start",gap:10,marginBottom:12,paddingBottom:12,borderBottom:"1px solid #DDD0F0",opacity:cumplido?0.7:1}}>
                <div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:4,flexShrink:0}}>
                  <div style={{background:(tipo==="NACIONAL"?"#5B2D8E":"#4BBCE0")+"22",borderRadius:10,padding:"6px 10px",fontSize:11,fontWeight:800,color:tipo==="NACIONAL"?"#5B2D8E":"#2A96BC",minWidth:64,textAlign:"center"}}>{e.fecha}</div>
                  {cumplido&&<span style={{background:"#4CAF5022",color:"#2E7D32",borderRadius:8,padding:"2px 8px",fontSize:10,fontWeight:800}}> Cumplido</span>}
                </div>
                <div style={{flex:1,fontWeight:600,fontSize:13,textDecoration:cumplido?"line-through":undefined,color:cumplido?"#7B6B9A":undefined}}>{e.nombre}</div>
                {!readOnly&&(
                  <button style={{...S.btn("#4BBCE0"),padding:"5px 9px",fontSize:12}} onClick={()=>openEdit(e)}></button>
                )}
              </div>
            );
          })}
        </div>
      ))}
      {!readOnly&&(
        <Modal open={modal} onClose={()=>setModal(false)} title={editId?"Editar Evento":"Nuevo Evento"}>
          <label style={S.label}>Nombre</label><input style={{...S.input,marginBottom:12}} value={form.nombre} onChange={e=>setForm(f=>({...f,nombre:e.target.value}))}/>
          <label style={S.label}>Fecha</label><input style={{...S.input,marginBottom:12}} value={form.fecha} onChange={e=>setForm(f=>({...f,fecha:e.target.value}))} placeholder="DD/MM/AAAA"/>
          <label style={S.label}>Tipo</label>
          <select style={{...S.input,marginBottom:14}} value={form.tipo} onChange={e=>setForm(f=>({...f,tipo:e.target.value}))}><option value="LOCAL">Local</option><option value="NACIONAL">Nacional / Distrital</option></select>
          <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={save}> Guardar</button>
          {editId&&<button style={{...S.btn("#FFF0F0","#EF5350"),padding:12,marginTop:10,border:"1.5px solid #EF535044"}} onClick={()=>{if(confirmDelete("Eliminar el evento: "+form.nombre+"?")){onUpdate(eventos.filter(ev=>ev.id!==editId));setModal(false);}}}> Eliminar Evento</button>}
        </Modal>
      )}
    </div>
  );
}

//  CUMPLEAOS PANEL 
function CumpleanosPanel({maestros,familias}){
  const months=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
  const mColors=["#4BBCE0","#5B2D8E","#E84F9B","#F5C842","#2A96BC","#E84F9B","#5B2D8E","#4BBCE0","#F5C842","#E84F9B","#7B4DB2","#4BBCE0"];
  const all=[
    ...maestros.filter(m=>m.cumpleanos).map(m=>({nombre:flipName(m.nombre),fecha:m.cumpleanos,tipo:m.cargo,categoria:"maestro"})),
    ...familias.filter(f=>f.cumpleanos).map(f=>({nombre:flipName(f.alumno),fecha:f.cumpleanos,tipo:"ALUMNO",clase:f.clase,categoria:"alumno"})),
  ].sort((a,b)=>{const[da,ma]=a.fecha.split("/").map(Number);const[db,mb]=b.fecha.split("/").map(Number);return ma-mb||da-db;});
  const byMonth={};
  all.forEach(b=>{const m=parseInt(b.fecha.split("/")[1])-1;if(!byMonth[m])byMonth[m]=[];byMonth[m].push(b);});
  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <h2 style={S.title}>Cumpleaos</h2>
      <BirthdayBanner maestros={maestros} familias={familias}/>
      {months.map((month,mi)=>{const list=byMonth[mi]||[];if(!list.length)return null;
        return(
          <div key={mi} style={{...S.card,borderTop:`5px solid ${mColors[mi]}`}}>
            <div style={{fontWeight:800,color:mColors[mi],marginBottom:10,fontSize:15}}> {month} ({list.length})</div>
            {list.map((b,i)=>(
              <div key={i} style={{display:"flex",alignItems:"center",gap:10,marginBottom:8,padding:"8px 10px",background:"#F5F0FF",borderRadius:10}}>
                <span style={{fontSize:20}}></span>
                <div style={{flex:1}}><div style={{fontWeight:700,fontSize:13}}>{b.nombre}</div><div style={{fontSize:11,color:"#7B6B9A"}}>{b.tipo}{b.clase&&b.categoria==="alumno"?"  "+b.clase:""}</div></div>
                <span style={{fontWeight:800,fontSize:13,color:"#5B2D8E"}}>{b.fecha}</span>
              </div>
            ))}
          </div>
        );
      })}
    </div>
  );
}


//  Sub-componente: badges de merienda/taller por sesin 
function MeriendaBadges({ses, meriendas, openSesModal}) {
  const m = meriendas.find(x => x.sesionId === ses.id);
  const totalSes = (parseFloat(m?.meriendaCosto) || 0) + (parseFloat(m?.trabajoManualCosto) || 0);
  return (
    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10,flexWrap:"wrap",gap:6}}>
      <div style={{display:"flex",gap:6,flexWrap:"wrap"}}>
        {m?.merienda && <span style={{...S.badge("#4BBCE0"),fontSize:11}}> Merienda{m.meriendaCosto?"  "+m.meriendaCosto:""}</span>}
        {m?.trabajoManual && <span style={{...S.badge("#E84F9B"),fontSize:11}}> T.Manual{m.trabajoManualCosto?"  "+m.trabajoManualCosto:""}</span>}
        {totalSes>0 && <span style={{...S.badge("#4CAF50"),fontSize:11}}> Total: {totalSes.toFixed(2)}</span>}
      </div>
      <button style={{...S.btn("#2A96BC"),padding:"5px 12px",fontSize:12,flexShrink:0}} onClick={()=>openSesModal(ses)}> {m?"Ver sesin":"Datos sesin"}</button>
    </div>
  );
}

//  Sub-componente: observaciones anteriores de un alumno 
function PrevObsSection({selNino, calificaciones, miClase, selSes}) {
  if (!selNino) return null;
  const prevObs = calificaciones
    .filter(c => c.alumno === selNino.nombre && c.clase === miClase && c.observacion && c.sesionId !== selSes?.id)
    .sort((a,b) => (b.fecha||"").localeCompare(a.fecha||""))
    .slice(0, 3);
  if (!prevObs.length) return null;
  return (
    <div style={{background:"linear-gradient(135deg,#F5C84210,#F5C84225)",border:"1.5px solid #F5C84255",borderRadius:12,padding:"10px 14px",marginBottom:16}}>
      <div style={{fontWeight:800,color:"#7B5A00",fontSize:12,letterSpacing:0.5,marginBottom:8}}> OBSERVACIONES ANTERIORES</div>
      {prevObs.map((obs,i) => (
        <div key={obs.id||i} style={{marginBottom:i<prevObs.length-1?10:0,paddingBottom:i<prevObs.length-1?10:0,borderBottom:i<prevObs.length-1?"1px dashed #F5C84255":"none"}}>
          <div style={{display:"flex",gap:6,marginBottom:3}}>
            <span style={{fontSize:11,fontWeight:800,color:"#5B2D8E",background:"#5B2D8E15",borderRadius:6,padding:"2px 6px"}}>{obs.leccion||"Sesin"}</span>
            <span style={{fontSize:11,color:"#7B6B9A"}}> {formatFecha(obs.fecha)}</span>
          </div>
          <div style={{fontSize:12,color:"#2D1B4E",lineHeight:1.5,background:"#FFFFFFAA",borderRadius:8,padding:"6px 10px"}}>{obs.observacion}</div>
        </div>
      ))}
    </div>
  );
}

//  TEACHER CALIFICACIONES 
function TeacherCalif({user,data,onUpdateCalif,onUpdateMerienda}){
  const{calificaciones,cronograma,clases,maestros,meriendas=[]}=data;
  const criterios=data.criterios||CRITERIOS;
  const teacherInfo=maestros.find(m=>m.nombre===user.name)||{};
  const miClase=teacherInfo.clase;
  const misNinos=clases[miClase]||[];
  const misSesiones=cronograma.filter(c=>(c.maestro===user.name||c.auxiliar===user.name)&&c.leccion&&c.leccion!=="NO HAY CLASE"&&c.leccion!=="DIA DEL PADRE");
  const[modal,setModal]=useState(false);
  const[form,setForm]=useState({});
  const[selNino,setSelNino]=useState(null);
  const[selSes,setSelSes]=useState(null);
  const open=(nino,ses)=>{
    const ex=calificaciones.find(c=>c.alumno===nino.nombre&&c.clase===miClase&&c.sesionId===ses.id)||{};
    setForm({alumno:nino.nombre,clase:miClase,sesionId:ses.id,fecha:ses.fecha,grupo:ses.grupo,leccion:ses.leccion,
      valores:ex.valores||"",conocimiento:ex.conocimiento||"",oracion:ex.oracion||"",servicio:ex.servicio||"",
      respeto:ex.respeto||"",participacion:ex.participacion||"",comportamiento:ex.comportamiento||"",
      merienda:ex.merienda||false,meriendaCosto:ex.meriendaCosto||"",trabajoManual:ex.trabajoManual||false,observacion:ex.observacion||""});
    setSelNino(nino);setSelSes(ses);setModal(true);
  };
  const saveCalif=()=>{
    const ex=calificaciones.find(c=>c.alumno===form.alumno&&c.clase===miClase&&c.sesionId===form.sesionId);
    onUpdateCalif(ex?calificaciones.map(c=>c.alumno===form.alumno&&c.clase===miClase&&c.sesionId===form.sesionId?{...c,...form}:c):[...calificaciones,{...form,id:Date.now()}]);
    setModal(false);
  };
  // Session data (merienda/trabajo manual)
  const[sesModal,setSesModal]=useState(false);
  const[sesData,setSesData]=useState({});
  const[sesSesId,setSesSesId]=useState(null);
  const openSesModal=(ses)=>{
    const ex=meriendas.find(m=>m.sesionId===ses.id)||{};
    setSesData({merienda:ex.merienda||false,meriendaCosto:ex.meriendaCosto||"",meriendaFecha:ex.meriendaFecha||"",trabajoManual:ex.trabajoManual||false,trabajoManualCosto:ex.trabajoManualCosto||""});
    setSesSesId(ses.id);
    setSesModal(true);
  };
  const saveSesData=(ses)=>{
    const mData={sesionId:sesSesId,fecha:ses?.fecha||"",clase:miClase,maestro:user.name,...sesData};
    const existingM=meriendas.find(m=>m.sesionId===sesSesId);
    const newMeriendas=existingM?meriendas.map(m=>m.sesionId===sesSesId?mData:m):[...meriendas,mData];
    if(onUpdateMerienda)onUpdateMerienda(newMeriendas);
    setSesModal(false);
  };
  const getSesAvg=(alumno,sesId)=>{
    const e=calificaciones.find(c=>c.alumno===alumno&&c.clase===miClase&&c.sesionId===sesId);if(!e)return null;
    const vals=criterios.map(c=>parseFloat(e[c.key])).filter(v=>!isNaN(v));
    return vals.length?(vals.reduce((a,b)=>a+b,0)/vals.length).toFixed(1):null;
  };
  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <h2 style={S.title}>Calificaciones  {miClase}</h2>
      {misSesiones.length===0&&<div style={{color:"#7B6B9A",textAlign:"center",padding:40}}>Sin sesiones asignadas.</div>}
      {misSesiones.map(ses=>(
        <div key={ses.id} style={{...S.card,borderLeft:`5px solid ${CLASE_COLORS[ses.grupo]||"#5B2D8E"}`}}>
          <div style={{fontWeight:800,color:CLASE_COLORS[ses.grupo]||"#5B2D8E",marginBottom:4}}>{formatFecha(ses.fecha)}  {ses.leccion}</div>
          <div style={{fontSize:12,color:"#7B6B9A",marginBottom:6}}>{ses.tema}</div>
          <MeriendaBadges ses={ses} meriendas={meriendas} openSesModal={openSesModal}/>
          <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8}}>
            <div style={{fontSize:11,fontWeight:700,color:"#7B6B9A",letterSpacing:0.5}}>ASISTENCIA AUTOMTICA</div>
            <div style={{fontSize:11,color:"#7B6B9A"}}>{calificaciones.filter(c=>c.clase===miClase&&c.sesionId===ses.id).length}/{misNinos.length} asistieron</div>
          </div>
          {misNinos.map(n=>{
            const avg=getSesAvg(n.nombre,ses.id);
            const calif=calificaciones.find(c=>c.alumno===n.nombre&&c.clase===miClase&&c.sesionId===ses.id);
            const asistio=!!calif;
            return(
              <div key={n.nombre||n.id} style={{display:"flex",alignItems:"center",gap:10,paddingBottom:10,marginBottom:10,borderBottom:"1px solid #DDD0F0",opacity:asistio?1:0.55}}>
                {n.foto
                  ?<img src={n.foto} alt="" style={{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:`2px solid ${asistio?(CLASE_COLORS[miClase]||"#5B2D8E"):"#CCC"}`,flexShrink:0}}/>
                  :<div style={{width:36,height:36,borderRadius:"50%",background:(asistio?(CLASE_COLORS[miClase]||"#5B2D8E"):"#CCC")+"33",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,fontSize:12,color:asistio?(CLASE_COLORS[miClase]||"#5B2D8E"):"#999",flexShrink:0}}>{getInitials(n.nombre)}</div>
                }
                <div style={{flex:1}}>
                  <div style={{fontWeight:700,fontSize:13}}>{flipName(n.nombre)}</div>
                  {avg?<div style={{fontSize:12,color:scoreColor(avg),fontWeight:700}}>Prom: {avg}</div>:<div style={{fontSize:12,color:"#7B6B9A",fontStyle:"italic"}}>Sin calificar  ausente</div>}
                  {calif?.observacion&&<div style={{fontSize:11,color:"#7B6B9A"}}> {calif.observacion.slice(0,50)}{calif.observacion.length>50?"...":""}</div>}
                </div>
                <button style={{...S.btn(calif?"#4BBCE0":"#5B2D8E","#FFFFFF"),padding:"8px 13px",fontSize:calif?13:18,fontWeight:900,borderRadius:12}} onClick={()=>open(n,ses)}>{calif?"":"+"}</button>
              </div>
            );
          })}
        </div>
      ))}
      <Modal open={sesModal} onClose={()=>setSesModal(false)} title=" Datos de la Sesin">
        <div style={{background:"#F0FBFF",borderRadius:12,padding:"12px 14px",marginBottom:14,fontSize:13,color:"#2A96BC",fontWeight:600}}>Estos datos son de la clase en general, no del alumno individual.</div>
        <div style={{marginBottom:16}}>
          <label style={{display:"flex",alignItems:"center",gap:10,cursor:"pointer",padding:"12px 14px",background:"#F5F0FF",borderRadius:12,marginBottom:10}}>
            <input type="checkbox" checked={!!sesData.merienda} onChange={e=>setSesData(d=>({...d,merienda:e.target.checked}))} style={{width:22,height:22,accentColor:"#4BBCE0"}}/>
            <div><div style={{fontWeight:700,fontSize:14}}> Llev merienda?</div></div>
          </label>
          {sesData.merienda&&(
            <div style={{marginBottom:10}}>
              <label style={S.label}> Costo merienda ()</label>
              <input type="number" step="0.01" min="0" style={{...S.input,padding:"10px 12px"}} value={sesData.meriendaCosto||""} onChange={e=>setSesData(d=>({...d,meriendaCosto:e.target.value}))} placeholder="0.00"/>
            </div>
          )}
          <label style={{display:"flex",alignItems:"center",gap:10,cursor:"pointer",padding:"12px 14px",background:"#FFF0F8",borderRadius:12,marginBottom:10}}>
            <input type="checkbox" checked={!!sesData.trabajoManual} onChange={e=>setSesData(d=>({...d,trabajoManual:e.target.checked}))} style={{width:22,height:22,accentColor:"#E84F9B"}}/>
            <div><div style={{fontWeight:700,fontSize:14}}> Us trabajo manual?</div></div>
          </label>
          {sesData.trabajoManual&&(
            <div style={{marginBottom:6}}>
              <label style={S.label}> Costo trabajo manual ()</label>
              <input type="number" step="0.01" min="0" style={{...S.input,padding:"10px 12px"}} value={sesData.trabajoManualCosto||""} onChange={e=>setSesData(d=>({...d,trabajoManualCosto:e.target.value}))} placeholder="0.00"/>
            </div>
          )}
          {(sesData.merienda||sesData.trabajoManual)&&(
            <div style={{background:"linear-gradient(135deg,#4CAF5020,#4CAF5035)",border:"2px solid #4CAF5055",borderRadius:14,padding:"14px",marginTop:10,textAlign:"center"}}>
              <div style={{fontSize:12,color:"#7B6B9A",marginBottom:4}}>GASTO TOTAL DE LA SESIN</div>
              <div style={{fontSize:28,fontWeight:900,color:"#2E7D32"}}>{((parseFloat(sesData.meriendaCosto)||0)+(parseFloat(sesData.trabajoManualCosto)||0)).toFixed(2)}</div>
            </div>
          )}
        </div>
        <button style={{...S.btn("#2A96BC","#FFFFFF",true),padding:14}} onClick={()=>saveSesData(misSesiones.find(s=>s.id===sesSesId))}> Guardar Datos de Sesin</button>
      </Modal>
      <Modal open={modal} onClose={()=>setModal(false)} title={`Calificar: ${selNino?flipName(selNino.nombre):""}`}>
        {selSes&&<div style={{background:"#F5F0FF",borderRadius:12,padding:"10px 14px",marginBottom:16}}>
          <div style={{fontWeight:700,color:"#5B2D8E"}}>{selSes.leccion}  {selSes.tema}</div>
          <div style={{fontSize:12,color:"#7B6B9A"}}>{formatFecha(selSes.fecha)}  {miClase}</div>
        </div>}
        {/* Previous observations for this student */}
        <PrevObsSection selNino={selNino} calificaciones={calificaciones} miClase={miClase} selSes={selSes}/>
        {criterios.map(c=>(
          <div key={c.key} style={{marginBottom:16}}>
            <label style={S.label}>{c.logro} (110)  <span style={{fontWeight:400}}>{c.item}</span></label>
            <div style={{display:"flex",gap:5,flexWrap:"wrap"}}>
              {[1,2,3,4,5,6,7,8,9,10].map(v=>(
                <button key={v} onClick={()=>setForm(f=>({...f,[c.key]:v}))}
                  style={{width:38,height:38,borderRadius:10,border:`2px solid ${form[c.key]===v?scoreColor(v):"#DDD0F0"}`,background:form[c.key]===v?scoreColor(v):"#FFFFFF",color:form[c.key]===v?"#FFFFFF":"#2D1B4E",fontWeight:800,cursor:"pointer",fontSize:14,fontFamily:"inherit"}}>{v}</button>
              ))}
            </div>
          </div>
        ))}
        <div style={{marginBottom:16}}>
          <label style={S.label}> Observacin (opcional)</label>
          <textarea style={{...S.input,height:80,resize:"vertical"}} value={form.observacion||""} onChange={e=>setForm(f=>({...f,observacion:e.target.value}))} placeholder="Notas sobre el alumno..."/>
        </div>
        <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={saveCalif}> Guardar</button>
      </Modal>
    </div>
  );
}

//  TEACHER APP 
function TeacherApp({user,data,onLogout,onUpdateData,teacherPasswords,onUpdatePasswords}){
  const[activeTab,setActiveTab]=useState("inicio");
  const[masTab,setMasTab]=useState("evaluacion");
  const[pwForm,setPwForm]=useState({old:"",new1:"",new2:""});
  const[pwError,setPwError]=useState("");
  const[pwOk,setPwOk]=useState(false);
  const[photoSrc,setPhotoSrc]=useState(null);
  const fileRef=useRef(null);
  const[phoneModal,setPhoneModal]=useState(false);
  const[phoneForm,setPhoneForm]=useState({});
  const[phoneEditId,setPhoneEditId]=useState(null);
  const[editNinoModal,setEditNinoModal]=useState(false);
  const[editNinoForm,setEditNinoForm]=useState({});
  const[editNinoTarget,setEditNinoTarget]=useState(null);
  const openEditNino=(n)=>{setEditNinoForm({nombre:n.nombre,edad:n.edad||"",cumpleanos:n.cumpleanos||"",nacimiento:n.nacimiento||""});setEditNinoTarget(n);setEditNinoModal(true);};
  const saveEditNino=()=>{
    if(alumnosSource)return;
    if(!editNinoTarget)return;
    let form={...editNinoForm};
    // Auto-derive cumpleaos and edad from nacimiento
    if(form.nacimiento){
      try{
        const d=new Date(form.nacimiento);
        const hoy=new Date();
        const edad=hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0);
        form.cumpleanos=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;
        form.edad=String(edad);
      }catch(e){}
    }
    const updated={...editNinoTarget,...form};
    const newClases={...clases,[miClase]:(clases[miClase]||[]).map(x=>x.id===editNinoTarget.id?updated:x)};
    onUpdateData("clases",newClases);
    if(form.nombre!==editNinoTarget.nombre||form.nacimiento||form.edad){
      const newFamilias=familias.map(f=>f.alumno===editNinoTarget.nombre?{...f,alumno:form.nombre||f.alumno,cumpleanos:form.cumpleanos||f.cumpleanos,nacimiento:form.nacimiento||f.nacimiento,edad:form.edad||f.edad}:f);
      onUpdateData("familias",newFamilias);
    }
    setEditNinoModal(false);
  };
  const{maestros,cronograma,clases,calificaciones,eventos,familias,evaluaciones,alumnos}=data;
  const alumnosSource=alumnos&&Array.isArray(alumnos)&&alumnos.length>0;
  const teacherInfo=maestros.find(m=>m.nombre===user.name)||{};
  const miClase=teacherInfo.clase;
  const misNinos=clases[miClase]||[];
  const misClases=cronograma.filter(c=>c.maestro===user.name||c.auxiliar===user.name).sort((a,b)=>a.fecha.localeCompare(b.fecha));
  const miEval=evaluaciones.find(e=>{const n1=(e.nombre||"").toLowerCase();const n2=user.name.toLowerCase();return n1.includes(n2.split(" ")[0])||n2.includes(n1.split(" ")[0]);});

  const matchFamilia=(cNombre,fAlumno)=>{
    if(!cNombre||!fAlumno)return false;
    if(cNombre.trim()===fAlumno.trim())return true;
    const w1=cNombre.toLowerCase().split(" ").filter(w=>w.length>2);
    const w2=fAlumno.toLowerCase().split(" ").filter(w=>w.length>2);
    return w1.some(w=>w2.includes(w));
  };
  const getParents=(alumnoNombre)=>familias.find(f=>matchFamilia(alumnoNombre,f.alumno)&&f.clase===miClase)||familias.find(f=>matchFamilia(alumnoNombre,f.alumno));
  const[phoneEditTarget,setPhoneEditTarget]=useState(null);
  const openPhoneEdit=(p)=>{
    setPhoneForm({telPadre:p.telPadre||"",telMadre:p.telMadre||"",padre:p.padre||"",madre:p.madre||""});
    setPhoneEditId(p.id||null);
    setPhoneEditTarget(p);
    setPhoneModal(true);
  };
  const savePhone=()=>{
    if(alumnosSource){setPhoneModal(false);return;}
    if(phoneEditId){
      onUpdateData("familias",familias.map(f=>f.id===phoneEditId?{...f,...phoneForm}:f));
    } else {
      // New family record for student with no family data
      const target=phoneEditTarget||{};
      const newRec={id:Date.now(),familia:phoneForm.padre||phoneForm.madre||target.alumno||"",alumno:target.alumno||target.nombre||"",clase:target.clase||miClase,...phoneForm};
      onUpdateData("familias",[...familias,newRec]);
    }
    setPhoneModal(false);
  };

  const changePw=()=>{
    const cur=teacherPasswords[user.name]||DEFAULT_TEACHER_PASSWORD;
    if(pwForm.old!==cur){setPwError("Contrasea actual incorrecta");return;}
    if(pwForm.new1.length<4){setPwError("Mnimo 4 caracteres");return;}
    if(pwForm.new1!==pwForm.new2){setPwError("Las contraseas no coinciden");return;}
    onUpdatePasswords({...teacherPasswords,[user.name]:pwForm.new1});setPwOk(true);setPwForm({old:"",new1:"",new2:""});setPwError("");
  };
  const handlePhoto=async(e)=>{const file=e.target.files[0];if(!file)return;const compressed=await compressImage(file,200,0.7);setPhotoSrc(compressed);};

  const getNinoGlobalAvg=(alumno)=>{
    const entries=calificaciones.filter(c=>c.alumno===alumno&&c.clase===miClase);if(!entries.length)return null;
    let t=0,cnt=0;entries.forEach(e=>{["valores","conocimiento","oracion","servicio","respeto","participacion","comportamiento"].forEach(k=>{const v=parseFloat(e[k]);if(!isNaN(v)){t+=v;cnt++;}});});
    return cnt?(t/cnt).toFixed(1):null;
  };

  const tabs=[{id:"inicio",label:"Inicio",icon:""},{id:"cronograma",label:"Horario",icon:""},{id:"calificaciones",label:"Calific.",icon:""},{id:"clase",label:"Clase",icon:""},{id:"mas",label:"Ms",icon:""}];

  return(
    <div style={{background:"#F5F0FF",minHeight:"100dvh",paddingBottom:70}}>
      <div style={{background:"linear-gradient(135deg,#3D1B6B,#5B2D8E)",padding:"0.75rem 1rem",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 2px 12px rgba(0,0,0,0.15)",position:"sticky",top:0,zIndex:100}}>
        <LogoImg height={38}/>
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          <div style={{textAlign:"right"}}>
            <div style={{color:"#F5C842",fontWeight:800,fontSize:12,lineHeight:1.2}}>{flipName(user.name).split(" ").slice(0,2).join(" ")}</div>
            <div style={{color:"rgba(255,255,255,0.65)",fontSize:10}}>{teacherInfo.cargo}  {miClase}</div>
          </div>
          <button style={{background:"rgba(255,255,255,0.18)",border:"none",borderRadius:10,padding:"8px 12px",color:"#FFFFFF",fontWeight:700,fontSize:13,cursor:"pointer"}} onClick={onLogout}> Salir</button>
        </div>
      </div>

      <div style={{paddingBottom:10}}>
        {activeTab==="inicio"&&(
          <div style={{padding:"1rem 1rem 0"}}>
            <h2 style={S.title}>Hola, {flipName(user.name).split(" ")[0]} </h2>
            <BirthdayBanner maestros={maestros} familias={familias}/>
            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16}}>
              <StatCard icon="" value={misNinos.length} label="Mis alumnos" color={CLASE_COLORS[miClase]||"#5B2D8E"}/>
              <StatCard icon="" value={misClases.length} label="Clases asig." color="#4BBCE0"/>
            </div>
            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16}}>
              <a href="https://drive.google.com/drive/folders/1PW00hDNw0POgEPW4LiANMH7PgByvX8A5?usp=sharing" target="_blank" rel="noopener noreferrer" style={{textDecoration:"none"}}>
                <div style={{...S.card,cursor:"pointer",display:"flex",alignItems:"center",gap:12,padding:14,border:"2px solid #5B2D8E33",transition:"border-color 0.2s"}} onMouseOver={e=>{e.currentTarget.style.borderColor="#5B2D8E88";}} onMouseOut={e=>{e.currentTarget.style.borderColor="#5B2D8E33";}}>
                  <div style={{width:44,height:44,borderRadius:12,background:"#5B2D8E22",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22}}></div>
                  <div><div style={{fontWeight:800,color:"#5B2D8E",fontSize:14}}>Recursos E.D.</div><div style={{fontSize:11,color:"#7B6B9A"}}>Carpeta Google Drive</div></div>
                </div>
              </a>
              <a href="https://chat.whatsapp.com/D5XEyuz7NWXKtJeZQqG0h2?mode=gi_t" target="_blank" rel="noopener noreferrer" style={{textDecoration:"none"}}>
                <div style={{...S.card,cursor:"pointer",display:"flex",alignItems:"center",gap:12,padding:14,border:"2px solid #25D36633",transition:"border-color 0.2s"}} onMouseOver={e=>{e.currentTarget.style.borderColor="#25D36688";}} onMouseOut={e=>{e.currentTarget.style.borderColor="#25D36633";}}>
                  <div style={{width:44,height:44,borderRadius:12,background:"#25D36622",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22}}></div>
                  <div><div style={{fontWeight:800,color:"#128C7E",fontSize:14}}>Grupo WhatsApp</div><div style={{fontSize:11,color:"#7B6B9A"}}>Maestros</div></div>
                </div>
              </a>
              <a href="https://www.bible.com/es/reading-plans/14400-la-biblia-en-1-ano" target="_blank" rel="noopener noreferrer" style={{textDecoration:"none",gridColumn:"1 / -1"}}>
                <div style={{...S.card,cursor:"pointer",display:"flex",alignItems:"center",gap:12,padding:14,border:"2px solid #8B691433"}} onMouseOver={e=>{e.currentTarget.style.borderColor="#8B691488";}} onMouseOut={e=>{e.currentTarget.style.borderColor="#8B691433";}}>
                  <div style={{width:44,height:44,borderRadius:12,background:"#8B691422",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22}}></div>
                  <div><div style={{fontWeight:800,color:"#6B4E10",fontSize:14}}>Plan de lectura bblica (1 ao)</div><div style={{fontSize:11,color:"#7B6B9A"}}>Bible.com  Recorrido completo en un ao</div></div>
                </div>
              </a>
            </div>
            <div style={S.card}>
              <h3 style={{color:"#5B2D8E",fontWeight:800,fontSize:15,marginBottom:12}}> Prximas Clases</h3>
              {misClases.slice(0,3).map((c,i)=>(
                <div key={i} style={{marginBottom:10,background:(CLASE_COLORS[c.grupo]||"#5B2D8E")+"15",border:`1.5px solid ${CLASE_COLORS[c.grupo]||"#5B2D8E"}44`,borderRadius:12,padding:"12px 14px"}}>
                  <div style={{fontWeight:800,color:CLASE_COLORS[c.grupo]||"#5B2D8E",fontSize:12}}>{formatFecha(c.fecha)}  {c.grupo}</div>
                  <div style={{fontSize:15,fontWeight:700,margin:"4px 0 2px"}}>{c.leccion}</div>
                  <div style={{fontSize:12,color:"#7B6B9A"}}>{c.tema}</div>
                  <div style={{marginTop:6}}><span style={S.badge(c.maestro===user.name?"#5B2D8E":"#4BBCE0")}>{c.maestro===user.name?" Maestro":" Auxiliar"}</span></div>
                </div>
              ))}
              {misClases.length===0&&<div style={{color:"#7B6B9A",fontSize:13}}>Sin clases asignadas.</div>}
            </div>
            <PeticionesDashboard peticiones={data.peticiones} user={user.name} onUpdate={()=>{}}/>
          </div>
        )}
        {activeTab==="cronograma"&&(
          <div style={{padding:"1rem 1rem 0"}}>
            <h2 style={S.title}>Mi Cronograma</h2>
            {misClases.map((c,i)=>(
              <div key={i} style={{...S.card,borderLeft:`5px solid ${CLASE_COLORS[c.grupo]||"#5B2D8E"}`}}>
                <div style={{fontWeight:800,color:CLASE_COLORS[c.grupo]||"#5B2D8E",fontSize:13}}>{formatFecha(c.fecha)} 2026  {c.grupo}</div>
                <div style={{fontSize:17,fontWeight:900,margin:"6px 0 4px"}}>{c.leccion}</div>
                <div style={{fontSize:13,color:"#7B6B9A",marginBottom:8}}>{c.tema}</div>
                <div style={{display:"flex",gap:10}}>
                  <span style={S.badge(c.maestro===user.name?"#5B2D8E":"#4BBCE0")}>{c.maestro===user.name?" Maestro":" Auxiliar"}</span>
                  <span style={{fontSize:12,color:"#7B6B9A"}}>Aux: {c.auxiliar?flipName(c.auxiliar):""}</span>
                </div>
              </div>
            ))}
          </div>
        )}
        {activeTab==="calificaciones"&&<TeacherCalif user={user} data={data} onUpdateCalif={v=>onUpdateData("calificaciones",v)} onUpdateMerienda={v=>onUpdateData("meriendas",v)}/>}
        {activeTab==="clase"&&(
          <div style={{padding:"1rem 1rem 0"}}>
            <h2 style={S.title}>Mi Clase: {miClase}</h2>
            {misNinos.map((n,i)=>{
              const avg=getNinoGlobalAvg(n.nombre);
              const p=getParents(n.nombre);
              // All observations for this student across all sessions
              const obsHistorial=calificaciones
                .filter(c=>c.alumno===n.nombre&&c.clase===miClase&&c.observacion)
                .sort((a,b)=>b.fecha?.localeCompare(a.fecha||"")||0)
                .slice(0,5);
              const totalSesiones=calificaciones.filter(c=>c.alumno===n.nombre&&c.clase===miClase).length;
              return(
                <div key={n.id||i} style={{...S.card,borderLeft:`5px solid ${CLASE_COLORS[miClase]||"#5B2D8E"}`}}>
                  <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:10}}>
                    {n.foto
                      ?<img src={n.foto} alt="" style={{width:44,height:44,borderRadius:"50%",objectFit:"cover",border:`3px solid ${CLASE_COLORS[miClase]||"#5B2D8E"}`,flexShrink:0}}/>
                      :<div style={{width:44,height:44,borderRadius:"50%",background:(CLASE_COLORS[miClase]||"#5B2D8E")+"33",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,fontSize:14,color:CLASE_COLORS[miClase]||"#5B2D8E",flexShrink:0}}>{getInitials(n.nombre)}</div>
                    }
                    <div style={{flex:1}}>
                      <div style={{fontWeight:800}}>{flipName(n.nombre)}</div>
                      <div style={{fontSize:12,color:"#7B6B9A"}}>
                        {n.edad?n.edad+" aos  ":""}
                        {totalSesiones} sesiones asistidas
                        {p?.bautizado&&"   Bautizado"}
                        {p?.sellado&&"   Sellado"}
                      </div>
                    </div>
                    {avg&&<div style={{background:scoreColor(avg)+"20",borderRadius:10,padding:"6px 10px",textAlign:"center"}}><div style={{fontWeight:900,color:scoreColor(avg),fontSize:18}}>{avg}</div><div style={{fontSize:10,color:"#7B6B9A"}}>prom.</div></div>}
                  </div>
                  {/* Observation history - visible to teacher/auxiliary */}
                  {obsHistorial.length>0&&(
                    <div style={{background:"linear-gradient(135deg,#F5C84212,#F5C84228)",border:"1.5px solid #F5C84255",borderRadius:12,padding:"10px 14px",marginBottom:10}}>
                      <div style={{fontWeight:800,color:"#7B5A00",fontSize:12,letterSpacing:0.5,marginBottom:8,display:"flex",alignItems:"center",gap:6}}>
                         HISTORIAL DE OBSERVACIONES
                        <span style={{background:"#F5C842",color:"#3D1B00",borderRadius:20,padding:"1px 7px",fontSize:11,fontWeight:900}}>{obsHistorial.length}</span>
                      </div>
                      {obsHistorial.map((obs,oi)=>(
                        <div key={obs.id||oi} style={{marginBottom:oi<obsHistorial.length-1?10:0,paddingBottom:oi<obsHistorial.length-1?10:0,borderBottom:oi<obsHistorial.length-1?"1px dashed #F5C84255":"none"}}>
                          <div style={{display:"flex",alignItems:"center",gap:6,marginBottom:3}}>
                            <span style={{fontSize:11,fontWeight:800,color:"#5B2D8E",background:"#5B2D8E15",borderRadius:8,padding:"2px 7px"}}>{obs.leccion||"Sesin"}</span>
                            <span style={{fontSize:11,color:"#7B6B9A"}}> {formatFecha(obs.fecha)}</span>
                          </div>
                          <div style={{fontSize:13,color:"#2D1B4E",lineHeight:1.5,background:"#FFFFFF88",borderRadius:8,padding:"6px 10px"}}>{obs.observacion}</div>
                        </div>
                      ))}
                    </div>
                  )}
                  {obsHistorial.length===0&&totalSesiones>0&&(
                    <div style={{fontSize:12,color:"#7B6B9A",fontStyle:"italic",padding:"4px 0 8px",borderBottom:"1px solid #F0ECF8",marginBottom:8}}>Sin observaciones registradas an</div>
                  )}
                  {p&&(p.padre||p.madre)&&(
                    <div style={{background:"#F5F0FF",borderRadius:12,padding:"10px 14px"}}>
                      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8}}>
                        <div style={{fontSize:11,fontWeight:800,color:"#7B6B9A",letterSpacing:1}}>PADRES / TUTORES</div>
                        {!alumnosSource&&<button style={{...S.btn("#F5C842","#3D1B6B"),padding:"4px 10px",fontSize:11}} onClick={()=>openPhoneEdit(p)}> Editar Tel.</button>}
                        {alumnosSource&&<span style={{fontSize:10,color:"#7B6B9A"}}>Editar en Admin  Alumnos</span>}
                      </div>
                      {p.padre&&p.padre!=="(No registra)"&&(
                        <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:p.madre?8:0}}>
                          <span style={{fontSize:14}}></span>
                          <span style={{fontSize:13,fontWeight:600,flex:1}}>{p.padre}</span>
                          {p.telPadre?<a href={`tel:${p.telPadre}`} style={{background:"#4BBCE0",color:"#FFFFFF",borderRadius:10,padding:"6px 12px",fontSize:12,fontWeight:800,textDecoration:"none",whiteSpace:"nowrap"}}> {p.telPadre}</a>:<span style={{fontSize:11,color:"#EF5350",fontStyle:"italic"}}>Sin tel.</span>}
                        </div>
                      )}
                      {p.madre&&p.madre!=="(No registra)"&&(
                        <div style={{display:"flex",alignItems:"center",gap:8}}>
                          <span style={{fontSize:14}}></span>
                          <span style={{fontSize:13,fontWeight:600,flex:1}}>{p.madre}</span>
                          {p.telMadre?<a href={`tel:${p.telMadre}`} style={{background:"#E84F9B",color:"#FFFFFF",borderRadius:10,padding:"6px 12px",fontSize:12,fontWeight:800,textDecoration:"none",whiteSpace:"nowrap"}}> {p.telMadre}</a>:<span style={{fontSize:11,color:"#EF5350",fontStyle:"italic"}}>Sin tel.</span>}
                        </div>
                      )}
                    </div>
                  )}
                  {!p&&!alumnosSource&&(
                    <div style={{background:"#FFF0E6",borderRadius:10,padding:"10px 14px",display:"flex",alignItems:"center",gap:10}}>
                      <div style={{flex:1,fontSize:12,color:"#7B6B9A",fontStyle:"italic"}}>Sin datos de familia registrados</div>
                      <button style={{...S.btn("#F5C842","#3D1B6B"),padding:"6px 12px",fontSize:12,whiteSpace:"nowrap"}} onClick={()=>openPhoneEdit({alumno:n.nombre,clase:miClase,padre:"",madre:"",telPadre:"",telMadre:""})}>+ Agregar</button>
                    </div>
                  )}
                  {!p&&alumnosSource&&(
                    <div style={{background:"#F5F0FF",borderRadius:10,padding:"10px 14px",fontSize:12,color:"#7B6B9A"}}>Editar en Admin  Alumnos</div>
                  )}
                  {p&&!(p.padre&&p.padre!=="(No registra)")&&!(p.madre&&p.madre!=="(No registra)")&&!alumnosSource&&(
                    <div style={{background:"#FFF0E6",borderRadius:10,padding:"10px 14px",display:"flex",alignItems:"center",gap:10}}>
                      <div style={{flex:1,fontSize:12,color:"#7B6B9A"}}> Padres sin nombre registrado</div>
                      <button style={{...S.btn("#F5C842","#3D1B6B"),padding:"6px 12px",fontSize:12}} onClick={()=>openPhoneEdit(p)}> Editar</button>
                    </div>
                  )}
                </div>
              );
            })}
          </div>
        )}
        <Modal open={phoneModal} onClose={()=>setPhoneModal(false)} title="Editar Telfonos de Padres">
          <div style={{background:"#F5F0FF",borderRadius:12,padding:"10px 14px",marginBottom:16,fontSize:13,color:"#7B6B9A"}}>Agrega o actualiza los telfonos de contacto</div>
          {[[" Padre / Tutor","padre"],[" Tel. Padre","telPadre"],[" Madre / Tutora","madre"],[" Tel. Madre","telMadre"]].map(([l,k])=>(
            <div key={k} style={{marginBottom:14}}>
              <label style={S.label}>{l}</label>
              <input style={S.input} type={k.startsWith("tel")?"tel":"text"} value={phoneForm[k]||""} onChange={e=>setPhoneForm(f=>({...f,[k]:e.target.value}))} placeholder={k.startsWith("tel")?"Ej: +34 600 000 000":""}/>
            </div>
          ))}
          <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={savePhone}> Guardar Telfonos</button>
        </Modal>
        <Modal open={editNinoModal} onClose={()=>setEditNinoModal(false)} title=" Editar Alumno">
          <div style={{background:"#F0FBFF",borderRadius:12,padding:"10px 14px",marginBottom:14,fontSize:13,color:"#2A96BC",lineHeight:1.6}}>El cumpleaos y la edad se calculan automticamente a partir de la fecha de nacimiento.</div>
          {[["Nombre completo (Apellido Nombre)","nombre","text"],["Fecha de nacimiento","nacimiento","date"]].map(([l,k,t])=>(
            <div key={k} style={{marginBottom:14}}>
              <label style={S.label}>{l}</label>
              <input type={t} style={S.input} value={editNinoForm[k]||""} onChange={e=>setEditNinoForm(f=>({...f,[k]:e.target.value}))}/>
            </div>
          ))}
          {editNinoForm.nacimiento&&(()=>{
            try{
              const d=new Date(editNinoForm.nacimiento);
              const hoy=new Date();
              const edad=hoy.getFullYear()-d.getFullYear()-(hoy<new Date(hoy.getFullYear(),d.getMonth(),d.getDate())?1:0);
              const cumple=`${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}`;
              return <div style={{background:"#F5FFF5",border:"2px solid #4CAF5044",borderRadius:12,padding:"12px 14px",marginBottom:14}}>
                <div style={{fontSize:12,color:"#7B6B9A",marginBottom:4}}>Calculado automticamente:</div>
                <div style={{display:"flex",gap:16}}>
                  <div><span style={{fontSize:11,color:"#7B6B9A"}}> Cumpleaos</span><div style={{fontWeight:800,color:"#4CAF50"}}>{cumple}</div></div>
                  <div><span style={{fontSize:11,color:"#7B6B9A"}}> Edad</span><div style={{fontWeight:800,color:"#4CAF50"}}>{edad} aos</div></div>
                </div>
              </div>;
            }catch(e){return null;}
          })()}
          <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={saveEditNino}> Guardar Cambios</button>
        </Modal>
        {activeTab==="mas"&&(
          <div style={{padding:"1rem 1rem 0"}}>
            <div style={{display:"flex",gap:8,overflowX:"auto",marginBottom:16,paddingBottom:4}}>
              {[["evaluacion"," Evaluac."],["eventos"," Eventos"],["cumpleanos"," Cumple."],["oracion"," Oracin"],["perfil"," Perfil"]].map(([id,label])=>(
                <button key={id} style={{...S.btn(masTab===id?"#5B2D8E":"#F5F0FF",masTab===id?"#FFFFFF":"#2D1B4E"),padding:"8px 14px",fontSize:13,flexShrink:0,borderRadius:20}} onClick={()=>setMasTab(id)}>{label}</button>
              ))}
            </div>
            {masTab==="evaluacion"&&(
              <div>
                <h2 style={S.title}>Mi Evaluacin</h2>
                {miEval?(
                  <div style={S.card}>
                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
                      <div><div style={{fontWeight:800,fontSize:16}}>{flipName(user.name)}</div><div style={{color:"#7B6B9A",fontSize:13}}>{teacherInfo.cargo}  {miClase}</div></div>
                      <div style={{background:"#5B2D8E15",borderRadius:14,padding:"12px 18px",textAlign:"center"}}>
                        <div style={{fontSize:32,fontWeight:900,color:"#5B2D8E"}}>{evalAvg(miEval,videoAvgForMaestro(user.name,data.videos||[]))}</div><div style={{fontSize:11,color:"#7B6B9A"}}>/5.0</div>
                      </div>
                    </div>
                    {EVAL_KEYS.map((k,j)=>(
                      <div key={k} style={{marginBottom:12,background:k==="cumplimientoClases"?"linear-gradient(135deg,#5B2D8E18,#5B2D8E30)":"#F5F0FF",borderRadius:12,padding:"12px 14px",border:k==="cumplimientoClases"?"2px solid #5B2D8E55":"none"}}>
                        <div style={{fontSize:12,color:k==="cumplimientoClases"?"#5B2D8E":"#7B6B9A",marginBottom:6,fontWeight:k==="cumplimientoClases"?800:400}}>{EVAL_LABELS[j]}</div>
                        <div style={{display:"flex",justifyContent:"space-between",alignItems:"center"}}>
                          <div style={{display:"flex",gap:2}}>{[1,2,3,4,5].map(s=><span key={s} style={{color:s<=(miEval[k]||0)?"#F5C842":"#e0e0e0",fontSize:20}}></span>)}</div>
                          <span style={{fontWeight:800,color:miEval[k]>=4?"#4CAF50":miEval[k]>=3?"#F5A623":"#EF5350"}}>{miEval[k]||""}/5</span>
                        </div>
                      </div>
                    ))}
                  </div>
                ):<div style={{color:"#7B6B9A"}}>No hay evaluacin disponible.</div>}
              </div>
            )}
            {masTab==="eventos"&&<EventosPanel eventos={data.eventos} onUpdate={()=>{}} readOnly/>}
            {masTab==="oracion"&&<PeticionesPanel peticiones={data.peticiones} user={user.name} onUpdate={v=>onUpdateData("peticiones",v)}/>}
            {masTab==="cumpleanos"&&(
              <div>
                <h2 style={S.title}>Cumpleaos  {miClase}</h2>
                <BirthdayBanner maestros={data.maestros} familias={familias.filter(f=>f.clase===miClase)}/>
                {familias.filter(f=>f.clase===miClase&&f.cumpleanos).sort((a,b)=>{const[da,ma]=a.cumpleanos.split("/").map(Number);const[db,mb]=b.cumpleanos.split("/").map(Number);return ma-mb||da-db;}).map((f,i)=>(
                  <div key={i} style={{...S.card,display:"flex",alignItems:"center",gap:10}}>
                    <span style={{fontSize:22}}></span>
                    <div style={{flex:1}}><div style={{fontWeight:700}}>{flipName(f.alumno)}</div><div style={{fontSize:12,color:"#7B6B9A"}}>{f.edad}</div></div>
                    <span style={{fontWeight:800,color:"#E84F9B",fontSize:14}}>{f.cumpleanos}</span>
                  </div>
                ))}
              </div>
            )}
            {masTab==="perfil"&&(
              <div>
                <h2 style={S.title}>Mi Perfil</h2>
                <div style={{...S.card,textAlign:"center",padding:24}}>
                  <div style={{position:"relative",width:90,height:90,margin:"0 auto 14px"}}>
                    {photoSrc?<img src={photoSrc} alt="foto" style={{width:90,height:90,borderRadius:"50%",objectFit:"cover",border:"4px solid #5B2D8E"}}/>
                      :<div style={{width:90,height:90,borderRadius:"50%",background:"#5B2D8E22",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:900,fontSize:32,color:"#5B2D8E",border:"4px solid #DDD0F0"}}>{getInitials(user.name)}</div>}
                    <button onClick={()=>fileRef.current.click()} style={{position:"absolute",bottom:0,right:0,width:28,height:28,borderRadius:"50%",background:"#5B2D8E",border:"none",cursor:"pointer",fontSize:14,color:"#FFFFFF"}}></button>
                    <input ref={fileRef} type="file" accept="image/*" style={{display:"none"}} onChange={handlePhoto}/>
                  </div>
                  <div style={{fontWeight:800,fontSize:18}}>{flipName(user.name)}</div>
                  <div style={{color:"#7B6B9A",marginTop:4}}>{teacherInfo.cargo}  {miClase}</div>
                  {teacherInfo.cumpleanos&&<div style={{marginTop:8,color:"#E84F9B",fontWeight:700}}> {teacherInfo.cumpleanos}</div>}
                  <div style={{marginTop:10}}><span style={S.badge(teacherInfo.certificado==="SI"?"#4CAF50":"#EF5350")}>{teacherInfo.certificado==="SI"?" Certificado al da":" Pendiente"}</span></div>
                </div>
                <div style={S.card}>
                  <h3 style={{color:"#5B2D8E",fontWeight:800,marginBottom:16,fontSize:16}}> Cambiar Contrasea</h3>
                  {pwOk?<div style={{color:"#4CAF50",fontWeight:700,textAlign:"center",padding:"20px 0"}}> Contrasea cambiada</div>:(
                    <>
                      {[["Contrasea actual","old"],["Nueva contrasea","new1"],["Confirmar nueva","new2"]].map(([l,k])=>(
                        <div key={k} style={{marginBottom:14}}><label style={S.label}>{l}</label><input type="password" style={S.input} value={pwForm[k]} onChange={e=>{setPwForm(f=>({...f,[k]:e.target.value}));setPwError("");setPwOk(false);}}/></div>
                      ))}
                      {pwError&&<div style={{color:"#EF5350",fontSize:13,marginBottom:10,fontWeight:700}}>{pwError}</div>}
                      <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:14}} onClick={changePw}>Cambiar Contrasea</button>
                    </>
                  )}
                </div>
                <button style={{...S.btn("#EF5350","#FFFFFF",true),padding:14,marginTop:8}} onClick={onLogout}> Cerrar Sesin</button>
              </div>
            )}
          </div>
        )}
      </div>
      <BottomNav tabs={tabs} active={activeTab} onSelect={setActiveTab}/>
    </div>
  );
}

//  PDF REPORTS 
function generarPDF(titulo, htmlContent){
  const estilos=`
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
      *{margin:0;padding:0;box-sizing:border-box;}
      body{font-family:'Inter',sans-serif;background:#fff;color:#1a1a2e;font-size:13px;line-height:1.5;}
      .header{background:linear-gradient(135deg,#3D1B6B,#5B2D8E);color:#fff;padding:20px 24px;display:flex;align-items:center;gap:16px;margin-bottom:20px;}
      .header h1{font-size:18px;font-weight:900;}
      .header .sub{font-size:12px;opacity:0.75;margin-top:2px;}
      .section{margin:0 20px 20px;background:#fff;border-radius:12px;border:1.5px solid #DDD0F0;overflow:hidden;}
      .section-title{background:linear-gradient(135deg,#5B2D8E15,#5B2D8E25);padding:10px 16px;font-weight:800;font-size:14px;color:#5B2D8E;border-bottom:1.5px solid #DDD0F0;}
      table{width:100%;border-collapse:collapse;}
      th{background:#F5F0FF;padding:8px 12px;text-align:left;font-size:11px;font-weight:700;color:#5B2D8E;letter-spacing:0.5px;text-transform:uppercase;}
      td{padding:9px 12px;border-bottom:1px solid #EEE8FF;font-size:12px;}
      tr:last-child td{border-bottom:none;}
      tr:nth-child(even) td{background:#FAFAF8;}
      .badge{display:inline-block;padding:2px 8px;border-radius:20px;font-size:10px;font-weight:700;}
      .avatar{width:36px;height:36px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-weight:800;font-size:13px;color:#fff;}
      .score{font-weight:800;font-size:14px;}
      .card{border-radius:12px;border:1.5px solid #DDD0F0;padding:14px 16px;margin:0 20px 12px;}
      .card-title{font-weight:800;font-size:15px;margin-bottom:4px;}
      .card-sub{font-size:11px;color:#7B6B9A;margin-bottom:10px;}
      .grid2{display:grid;grid-template-columns:1fr 1fr;gap:8px;}
      .stat{background:#F5F0FF;border-radius:8px;padding:8px 10px;}
      .stat-val{font-size:20px;font-weight:900;color:#5B2D8E;}
      .stat-lbl{font-size:10px;color:#7B6B9A;}
      .obs{background:#F5C84215;border:1px dashed #F5C84255;border-radius:8px;padding:8px 10px;font-size:11px;margin-top:6px;color:#5A4000;}
      .presente{color:#4CAF50;font-weight:700;} .ausente{color:#EF5350;font-weight:700;}
      .bar-wrap{height:8px;background:#EEE8FF;border-radius:4px;overflow:hidden;margin-top:4px;}
      .bar-fill{height:100%;border-radius:4px;}
      .footer{text-align:center;padding:16px;font-size:10px;color:#AAA;border-top:1px solid #EEE8FF;margin:0 20px;}
      .firmas{margin:32px 20px 20px;padding-top:24px;border-top:2px solid #DDD0F0;display:grid;grid-template-columns:1fr 1fr;gap:40px;align-items:end;}
      .firma-item{text-align:center;}
      .firma-linea{border-bottom:1px solid #1a1a2e;height:36px;margin-bottom:6px;max-width:220px;margin-left:auto;margin-right:auto;}
      .firma-nombre{font-size:12px;font-weight:700;color:#5B2D8E;}
      .firma-cargo{font-size:10px;color:#7B6B9A;}
      .print-btn{display:block;margin:20px auto;padding:12px 30px;background:#5B2D8E;color:#fff;border:none;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer;}
      @media print{.print-btn{display:none!important;}body{-webkit-print-color-adjust:exact;print-color-adjust:exact;}}
    </style>`;
  const fecha=new Date().toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"});
  const firmasHtml=`
    <div class="firmas">
      <div class="firma-item"><div class="firma-linea"></div><div class="firma-nombre">Jos Hernn Daz</div><div class="firma-cargo">Pastor</div></div>
      <div class="firma-item"><div class="firma-linea"></div><div class="firma-nombre">Cindy Vanessa Muoz</div><div class="firma-cargo">Directora de Escuela Dominical</div></div>
    </div>`;
  const full=`<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8">${estilos}<title>${titulo}</title></head><body>
    <div class="header">
      <div>
        <h1> ${titulo}</h1>
        <div class="sub">Escuela Dominical IPUE  Villanueva del Pardillo  ${fecha}</div>
      </div>
    </div>
    ${htmlContent}
    ${firmasHtml}
    <div class="footer">Generado por Sistema Escuela Dominical IPUE  ${fecha}</div>
    <button class="print-btn" onclick="window.print()"> Imprimir / Guardar PDF</button>
  </body></html>`;
  const blob=new Blob([full],{type:"text/html;charset=utf-8"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url;
  a.target="_blank";
  a.rel="noopener noreferrer";
  a.click();
  setTimeout(()=>URL.revokeObjectURL(url),10000);
}

function scoreColorHex(v){const n=parseFloat(v);if(isNaN(n))return"#AAA";if(n>=8)return"#4CAF50";if(n>=6)return"#F5A623";return"#EF5350";}
function claseColorHex(cl){return CLASE_COLORS[cl]||"#5B2D8E";}

function InformesPanel({data}){
  const{maestros,clases,familias,calificaciones,cronograma,evaluaciones,meriendas=[],criterios,videos=[]}=data;
  const crit=criterios||CRITERIOS;
  const ckeys=crit.map(c=>c.key);
  const ninos=Object.entries(clases).flatMap(([cl,arr])=>arr.map(n=>({...n,clase:cl})));

  const ninoAvg=(nombre,clase)=>{
    const e=calificaciones.filter(c=>c.alumno===nombre&&c.clase===clase);
    let t=0,cnt=0;e.forEach(ex=>{ckeys.forEach(k=>{const v=parseFloat(ex[k]);if(!isNaN(v)){t+=v;cnt++;}});});
    return cnt?(t/cnt).toFixed(1):null;
  };
  const maestroSesiones=(nombre)=>cronograma.filter(c=>c.maestro===nombre||c.auxiliar===nombre);
  const evalMaestro=(nombre)=>evaluaciones.find(e=>{const n1=(e.nombre||"").toLowerCase();const n2=nombre.toLowerCase();return n1.includes(n2.split(" ")[0])||n2.includes(n1.split(" ")[0]);});

  //  Report 1: All Students 
  const reportAlumnos=()=>{
    const rows=ninos.map(n=>{
      const avg=ninoAvg(n.nombre,n.clase);
      const fam=familias.find(f=>f.alumno===n.nombre);
      const asistencias=calificaciones.filter(c=>c.alumno===n.nombre&&c.clase===n.clase).length;
      const totalSes=maestroSesiones(maestros.find(m=>m.clase===n.clase&&m.cargo==="MAESTRO")?.nombre||"").length||0;
      const pct=totalSes>0?Math.round((asistencias/totalSes)*100):0;
      const scoreC=avg?scoreColorHex(avg):"#AAA";
      const obsCount=calificaciones.filter(c=>c.alumno===n.nombre&&c.clase===n.clase&&c.observacion).length;
      const bautizado=fam?.bautizado?"S":"No";
      const sellado=fam?.sellado?"S":"No";
      return `<tr>
        <td><strong>${flipName(n.nombre)}</strong></td>
        <td><span class="badge" style="background:${claseColorHex(n.clase)}22;color:${claseColorHex(n.clase)};border:1px solid ${claseColorHex(n.clase)}44">${n.clase}</span></td>
        <td>${n.edad||""}</td>
        <td>${fam?.cumpleanos||""}</td>
        <td>${fam?.padre||fam?.madre?" S":" No"}</td>
        <td>${bautizado}</td>
        <td>${sellado}</td>
        <td>${asistencias}/${totalSes} <small style="color:#7B6B9A">(${pct}%)</small></td>
        <td style="color:${scoreC};font-weight:800">${avg||""}</td>
        <td>${obsCount>0?obsCount+" obs.":""}</td>
      </tr>`;
    }).join("");
    const html=`
      <div class="section">
        <div class="section-title"> Resumen General  ${ninos.length} Alumnos</div>
        <table>
          <thead><tr><th>Alumno</th><th>Clase</th><th>Edad</th><th>Cumpleaos</th><th>Familia</th><th>Bautizado</th><th>Sellado</th><th>Asistencia</th><th>Promedio</th><th>Observac.</th></tr></thead>
          <tbody>${rows}</tbody>
        </table>
      </div>`;
    generarPDF("Informe de Alumnos",html);
  };

  //  Report states (hooks must be at top level) 
  const[selMaestro,setSelMaestro]=useState(maestros[0]?.nombre||"");
  const[selNino,setSelNino]=useState(ninos[0]?.nombre||"");

  //  Report 2: Individual Teacher 
  const reportMaestro=()=>{
    const m=maestros.find(x=>x.nombre===selMaestro);
    if(!m)return;
    const sesiones=maestroSesiones(m.nombre).sort((a,b)=>a.fecha.localeCompare(b.fecha));
    const ev=evalMaestro(m.nombre);
    const avgEv=ev?evalAvg(ev,videoAvgForMaestro(m.nombre,videos)):videoAvgForMaestro(m.nombre,videos);
    const misNinos=clases[m.clase]||[];
    const cumpl=sesiones.length>0?Math.round((sesiones.filter(s=>s.leccion&&s.leccion!=="NO HAY CLASE"&&s.leccion!=="DIA DEL PADRE").length/sesiones.length)*100):100;
    const sesRows=sesiones.map(s=>{
      const mer=meriendas.find(x=>x.sesionId===s.id);
      const gastos=(parseFloat(mer?.meriendaCosto)||0)+(parseFloat(mer?.trabajoManualCosto)||0);
      return `<tr>
      <td>${formatFecha(s.fecha)}</td>
      <td><strong>${s.leccion||""}</strong></td>
      <td>${s.tema||""}</td>
      <td><span class="${s.maestro===m.nombre?"presente":"ausente"}">${s.maestro===m.nombre?" Maestro":" Auxiliar"}</span></td>
      <td>${gastos>0?""+gastos.toFixed(2):""}</td>
    </tr>`;
    }).join("");
    const ninoRows=misNinos.map(n=>{
      const avg=ninoAvg(n.nombre,m.clase);
      const asist=calificaciones.filter(c=>c.alumno===n.nombre&&c.clase===m.clase).length;
      return`<tr>
        <td><strong>${flipName(n.nombre)}</strong></td>
        <td>${asist} sesiones</td>
        <td style="color:${avg?scoreColorHex(avg):"#AAA"};font-weight:800">${avg||"Sin calificar"}</td>
      </tr>`;
    }).join("");
    const evalRows=ev?EVAL_KEYS.map((k,j)=>`<tr><td>${EVAL_LABELS[j]}</td><td>${"".repeat(ev[k]||0)}${"".repeat(5-(ev[k]||0))}</td><td style="font-weight:700">${ev[k]||0}/5</td></tr>`).join(""):"";
    const sesionesConVideo=sesiones.filter(s=>s.maestro===m.nombre&&VIDEO_CLASES.includes(s.grupo)&&s.leccion&&s.leccion!=="NO HAY CLASE");
    const getV=(sesionId)=>videos.find(v=>v.sesionId===sesionId&&v.maestro===m.nombre);
    const videoRows=sesionesConVideo.map(s=>{
      const v=getV(s.id);
      const score=v?videoScore(v):null;
      return`<tr>
        <td>${formatFecha(s.fecha)}</td>
        <td><strong>${s.leccion||""}</strong></td>
        <td>${s.grupo}</td>
        <td>${v?.hizo?" S":" No"}</td>
        <td>${v?.hizo?(v.calidad||"")+"/5":""}</td>
        <td>${v?.hizo?(v.aTiempo?" S":"No"):""}</td>
        <td style="font-weight:700">${score!=null?score.toFixed(1)+"/5":""}</td>
      </tr>`;
    }).join("");
    const videoSection=sesionesConVideo.length>0?`
      <div class="section">
        <div class="section-title"> Envo de Videos de Clase</div>
        <p style="font-size:11px;color:#7B6B9A;padding:8px 16px 0">Videos requeridos para clases Corderitos, Vencedores y Conquistadores. Calidad 1-5 y envo a tiempo.</p>
        <table><thead><tr><th>Fecha</th><th>Leccin</th><th>Grupo</th><th>Envi</th><th>Calidad</th><th>A tiempo</th><th>Score</th></tr></thead><tbody>${videoRows}</tbody></table>
      </div>`:"";
    const html=`
      <div class="card">
        <div class="card-title">${flipName(m.nombre)}</div>
        <div class="card-sub">${m.cargo}  Clase ${m.clase}  Certificado: ${m.certificado||""}</div>
        <div class="grid2">
          <div class="stat"><div class="stat-val">${sesiones.length}</div><div class="stat-lbl">Clases asignadas</div></div>
          <div class="stat"><div class="stat-val" style="color:${cumpl>=80?"#4CAF50":cumpl>=60?"#F5A623":"#EF5350"}">${cumpl}%</div><div class="stat-lbl">Cumplimiento</div></div>
          ${avgEv!=null?`<div class="stat"><div class="stat-val">${typeof avgEv==="number"?avgEv.toFixed(1):avgEv}/5</div><div class="stat-lbl">Evaluacin (incl. videos)</div></div>`:""}
          <div class="stat"><div class="stat-val">${misNinos.length}</div><div class="stat-lbl">Alumnos en clase</div></div>
        </div>
      </div>
      <div class="section">
        <div class="section-title"> Historial de Clases</div>
        <table><thead><tr><th>Fecha</th><th>Leccin</th><th>Tema</th><th>Rol</th><th>Gastos</th></tr></thead><tbody>${sesRows||"<tr><td colspan='5' style='text-align:center;color:#AAA'>Sin clases asignadas</td></tr>"}</tbody></table>
      </div>
      ${videoSection}
      <div class="section">
        <div class="section-title"> Alumnos de ${m.clase}</div>
        <table><thead><tr><th>Alumno</th><th>Asistencia</th><th>Promedio</th></tr></thead><tbody>${ninoRows||"<tr><td colspan='3' style='text-align:center;color:#AAA'>Sin alumnos</td></tr>"}</tbody></table>
      </div>
      ${ev?`<div class="section"><div class="section-title"> Evaluacin del Administrador</div><table><thead><tr><th>Criterio</th><th>Calificacin</th><th>Puntos</th></tr></thead><tbody>${evalRows}</tbody></table></div>`:""}`;
    generarPDF(`Informe de ${flipName(m.nombre)}`,html);
  };

  //  Report 4: Individual Student 
  const reportNino=()=>{
    const n=ninos.find(x=>x.nombre===selNino);
    if(!n)return;
    const entries=calificaciones.filter(c=>c.alumno===n.nombre&&c.clase===n.clase).sort((a,b)=>new Date(a.fecha)-new Date(b.fecha));
    const fam=familias.find(f=>f.alumno===n.nombre);
    const avg=ninoAvg(n.nombre,n.clase);
    const totalSes=(cronograma.filter(c=>c.grupo===n.clase&&c.leccion&&c.leccion!=="NO HAY CLASE").length)||1;
    const asistPct=Math.round((entries.length/totalSes)*100);
    const scoreC=avg?scoreColorHex(avg):"#AAA";
    const sesRows=entries.map(e=>{
      let t=0,cnt=0;ckeys.forEach(k=>{const v=parseFloat(e[k]);if(!isNaN(v)){t+=v;cnt++;}});
      const ea=cnt?(t/cnt).toFixed(1):null;
      return"<tr><td>"+formatFecha(e.fecha)+"</td><td><strong>"+(e.leccion||"")+"</strong></td>"+
        ckeys.map(k=>"<td style=\"color:"+scoreColorHex(e[k])+";font-weight:700\">"+(e[k]||"")+"</td>").join("")+
        "<td style=\"color:"+(ea?scoreColorHex(ea):"#AAA")+";font-weight:800\">"+(ea||"")+"</td>"+
        "<td style=\"font-size:11px;color:#7B6B9A\">"+(e.observacion||"")+"</td></tr>";
    }).join("");
    const obsRows=entries.filter(e=>e.observacion).map(e=>
      "<div style=\"padding:10px 14px;border-bottom:1px solid #EEE8FF\">"+
      "<div style=\"font-size:11px;color:#5B2D8E;font-weight:700\">"+(e.leccion||"")+"  "+formatFecha(e.fecha)+"</div>"+
      "<div style=\"font-size:12px;color:#2D1B4E\">"+(e.observacion)+"</div></div>"
    ).join("");
    const padreRow=fam&&fam.padre&&fam.padre!=="(No registra)"?"<div style=\"font-size:12px;color:#7B6B9A\"> "+fam.padre+(fam.telPadre?"   "+fam.telPadre:"")+"</div>":"";
    const madreRow=fam&&fam.madre&&fam.madre!=="(No registra)"?"<div style=\"font-size:12px;color:#7B6B9A\"> "+fam.madre+(fam.telMadre?"   "+fam.telMadre:"")+"</div>":"";
    const bautizadoSellado="<div style=\"margin-top:8px;font-size:12px\">"+(fam?.bautizado?"<span style=\"color:#2E7D32;font-weight:700\"> Bautizado</span>":"<span style=\"color:#7B6B9A\">Bautizado: No</span>")+" &nbsp; "+(fam?.sellado?"<span style=\"color:#5B2D8E;font-weight:700\"> Sellado</span>":"<span style=\"color:#7B6B9A\">Sellado: No</span>")+"</div>";
    const avgBox=avg?"<div style=\"text-align:center;background:"+scoreC+"22;border-radius:12px;padding:10px 14px\"><div style=\"font-size:28px;font-weight:900;color:"+scoreC+"\">"+avg+"</div><div style=\"font-size:10px;color:#7B6B9A\">/10</div></div>":"";
    const historial=entries.length>0?
      "<div class=\"section\"><div class=\"section-title\"> Historial de Calificaciones ("+entries.length+" sesiones)</div>"+
      "<table><thead><tr><th>Fecha</th><th>Leccin</th>"+crit.map(c=>"<th>"+c.logro+"</th>").join("")+"<th>Prom.</th><th>Observacin</th></tr></thead>"+
      "<tbody>"+sesRows+"</tbody></table></div>"+
      (obsRows?"<div class=\"section\"><div class=\"section-title\"> Observaciones</div>"+obsRows+"</div>":"")
      :"<div style=\"text-align:center;padding:30px;color:#7B6B9A;font-style:italic\">Sin calificaciones registradas.</div>";
    const html=
      "<div class=\"card\" style=\"margin:0 20px 16px;border-left:4px solid "+claseColorHex(n.clase)+"\">"+
      "<div style=\"display:flex;gap:14px;align-items:center;margin-bottom:12px\">"+
      "<div style=\"width:52px;height:52px;border-radius:50%;background:"+claseColorHex(n.clase)+"33;display:flex;align-items:center;justify-content:center;font-size:22px;font-weight:900;color:"+claseColorHex(n.clase)+"\">"+n.nombre.charAt(0)+"</div>"+
      "<div style=\"flex:1\"><div style=\"font-size:20px;font-weight:900;color:#2D1B4E\">"+flipName(n.nombre)+"</div>"+
      "<div style=\"font-size:12px;color:#7B6B9A\">Clase: <strong>"+n.clase+"</strong>  Edad: <strong>"+(n.edad||"")+"</strong></div>"+
      padreRow+madreRow+bautizadoSellado+"</div>"+avgBox+"</div>"+
      "<div style=\"display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-top:8px\">"+
      "<div class=\"stat\"><div class=\"stat-val\">"+entries.length+"</div><div class=\"stat-lbl\">Sesiones asistidas</div></div>"+
      "<div class=\"stat\"><div class=\"stat-val\">"+asistPct+"%</div><div class=\"stat-lbl\">Asistencia</div></div>"+
      "<div class=\"stat\"><div class=\"stat-val\" style=\"color:"+scoreC+"\">"+( avg||"")+"</div><div class=\"stat-lbl\">Promedio general</div></div>"+
      "</div></div>"+historial;
    generarPDF("Informe: "+flipName(n.nombre),html);
  };

  //  Report 3: Class Summary 
  const[selClase,setSelClase]=useState("CORDERITOS");
  const reportClase=()=>{
    const claseMaestro=maestros.find(m=>m.clase===selClase&&m.cargo==="MAESTRO");
    const claseAux=maestros.filter(m=>m.clase===selClase&&m.cargo==="AUXILIAR");
    const claseSesiones=cronograma.filter(c=>c.grupo===selClase&&c.leccion&&c.leccion!=="NO HAY CLASE").sort((a,b)=>a.fecha.localeCompare(b.fecha));
    const claseNinos=clases[selClase]||[];
    const totalGasto=meriendas.filter(m=>m.clase===selClase).reduce((s,m)=>s+(parseFloat(m.meriendaCosto)||0)+(parseFloat(m.trabajoManualCosto)||0),0);
    const sesRows=claseSesiones.map(s=>{
      const sesCalifs=calificaciones.filter(c=>c.clase===selClase&&c.sesionId===s.id);
      const m2=meriendas.find(x=>x.sesionId===s.id);
      let t=0,cnt=0;sesCalifs.forEach(e=>{ckeys.forEach(k=>{const v=parseFloat(e[k]);if(!isNaN(v)){t+=v;cnt++;}});});
      const avg2=cnt?(t/cnt).toFixed(1):null;
      const gasto=((parseFloat(m2?.meriendaCosto)||0)+(parseFloat(m2?.trabajoManualCosto)||0));
      const pct2=claseNinos.length?Math.round((sesCalifs.length/claseNinos.length)*100):0;
      return`<tr>
        <td>${formatFecha(s.fecha)}</td>
        <td><strong>${s.leccion}</strong></td>
        <td>${s.tema||""}</td>
        <td><div class="bar-wrap"><div class="bar-fill" style="width:${pct2}%;background:${pct2>=80?"#4CAF50":pct2>=60?"#F5A623":"#EF5350"}"></div></div><small>${sesCalifs.length}/${claseNinos.length} (${pct2}%)</small></td>
        <td style="color:${avg2?scoreColorHex(avg2):"#AAA"};font-weight:800">${avg2||""}</td>
        <td style="color:${gasto>0?"#2E7D32":"#AAA"}">${gasto>0?""+gasto.toFixed(2):""}</td>
      </tr>`;
    }).join("");
    const ninoRows2=claseNinos.map(n=>{
      const avg2=ninoAvg(n.nombre,selClase);
      const asist=calificaciones.filter(c=>c.alumno===n.nombre&&c.clase===selClase).length;
      const fam=familias.find(f=>f.alumno===n.nombre);
      const obsCount=calificaciones.filter(c=>c.alumno===n.nombre&&c.clase===selClase&&c.observacion).length;
      return`<tr>
        <td><strong>${flipName(n.nombre)}</strong></td>
        <td>${n.edad||""}</td>
        <td>${fam?.cumpleanos||""}</td>
        <td>${fam?.bautizado?"S":"No"}</td>
        <td>${fam?.sellado?"S":"No"}</td>
        <td>${asist}/${claseSesiones.length}</td>
        <td style="color:${avg2?scoreColorHex(avg2):"#AAA"};font-weight:800">${avg2||""}</td>
        <td>${obsCount>0?obsCount+" obs.":""}</td>
      </tr>`;
    }).join("");
    const promedioClase=(()=>{let t=0,cnt=0;claseNinos.forEach(n=>{const a=ninoAvg(n.nombre,selClase);if(a){t+=parseFloat(a);cnt++;}});return cnt?(t/cnt).toFixed(1):"";})();
    const html=`
      <div class="card">
        <div class="card-title" style="color:${claseColorHex(selClase)};font-size:18px"> Clase ${selClase}</div>
        <div class="card-sub">${claseMaestro?`Maestro: ${flipName(claseMaestro.nombre)}`:"Sin maestro asignado"} ${claseAux.length?` Auxiliar(es): ${claseAux.map(a=>flipName(a.nombre)).join(", ")}`:""}
        </div>
        <div class="grid2">
          <div class="stat"><div class="stat-val">${claseNinos.length}</div><div class="stat-lbl">Alumnos</div></div>
          <div class="stat"><div class="stat-val">${claseSesiones.length}</div><div class="stat-lbl">Sesiones realizadas</div></div>
          <div class="stat"><div class="stat-val" style="color:#2E7D32">${totalGasto.toFixed(2)}</div><div class="stat-lbl">Gasto total</div></div>
          <div class="stat"><div class="stat-val" style="color:${claseColorHex(selClase)}">${promedioClase}</div><div class="stat-lbl">Promedio general</div></div>
        </div>
      </div>
      <div class="section">
        <div class="section-title"> Sesiones de Clase</div>
        <table><thead><tr><th>Fecha</th><th>Leccin</th><th>Tema</th><th>Asistencia</th><th>Promedio</th><th>Gasto</th></tr></thead>
        <tbody>${sesRows||"<tr><td colspan='6' style='text-align:center;color:#AAA'>Sin sesiones registradas</td></tr>"}</tbody></table>
      </div>
      <div class="section">
        <div class="section-title"> Alumnos</div>
        <table><thead><tr><th>Alumno</th><th>Edad</th><th>Cumpleaos</th><th>Bautizado</th><th>Sellado</th><th>Asistencia</th><th>Promedio</th><th>Observac.</th></tr></thead>
        <tbody>${ninoRows2||"<tr><td colspan='8' style='text-align:center;color:#AAA'>Sin alumnos</td></tr>"}</tbody></table>
      </div>`;
    generarPDF(`Informe Clase ${selClase}`,html);
  };

  return(
    <div style={{padding:"1rem 1rem 6.25rem"}}>
      <h2 style={S.title}> Generar Informes PDF</h2>
      <div style={{background:"#F0FBFF",borderRadius:14,padding:"14px",marginBottom:18,fontSize:13,color:"#2A96BC",fontWeight:600}}>
        Los informes se abrirn en una nueva pestaa listos para imprimir o guardar como PDF.
      </div>

      {/* Report 1 - All Students */}
      <div style={{...S.card,borderLeft:"5px solid #5B2D8E",marginBottom:14}}>
        <div style={{fontWeight:800,fontSize:15,color:"#5B2D8E",marginBottom:4}}> Informe de Alumnos</div>
        <div style={{fontSize:12,color:"#7B6B9A",marginBottom:14}}>Todos los alumnos con asistencia, promedio, cumpleaos y datos de familia.</div>
        <button style={{...S.btn("#5B2D8E","#FFFFFF",true),padding:"12px 20px",borderRadius:12,fontSize:14,width:"100%"}} onClick={reportAlumnos}>
           Generar PDF  Todos los Alumnos ({ninos.length})
        </button>
      </div>

      {/* Report 2 - Individual Teacher */}
      <div style={{...S.card,borderLeft:"5px solid #E84F9B",marginBottom:14}}>
        <div style={{fontWeight:800,fontSize:15,color:"#E84F9B",marginBottom:4}}> Informe Individual de Maestro/Auxiliar</div>
        <div style={{fontSize:12,color:"#7B6B9A",marginBottom:12}}>Historial de clases, alumnos, evaluacin y estadsticas personales.</div>
        <label style={S.label}>Seleccionar Maestro/Auxiliar</label>
        <select style={{...S.input,marginBottom:14}} value={selMaestro} onChange={e=>setSelMaestro(e.target.value)}>
          {[...maestros].sort((a,b)=>flipName(a.nombre).localeCompare(flipName(b.nombre),"es")).map(m=>(
            <option key={m.id} value={m.nombre}>{flipName(m.nombre)}  {m.cargo} ({m.clase})</option>
          ))}
        </select>
        <button style={{...S.btn("#E84F9B","#FFFFFF",true),padding:"12px 20px",borderRadius:12,fontSize:14,width:"100%"}} onClick={reportMaestro}>
           Generar PDF  {selMaestro?flipName(selMaestro):"Selecciona uno"}
        </button>
      </div>

      {/* Report 3 - Class Summary */}
      <div style={{...S.card,borderLeft:"5px solid #4BBCE0",marginBottom:14}}>
        <div style={{fontWeight:800,fontSize:15,color:"#2A96BC",marginBottom:4}}> Informe General de Clase</div>
        <div style={{fontSize:12,color:"#7B6B9A",marginBottom:12}}>Resumen completo de la clase: sesiones, asistencia, promedios y gastos.</div>
        <label style={S.label}>Seleccionar Clase</label>
        <div style={{display:"flex",gap:8,flexWrap:"wrap",marginBottom:14}}>
          {CLASES_LIST.map(cl=>(
            <button key={cl} style={{...S.btn(selClase===cl?CLASE_COLORS[cl]:"#F5F0FF",selClase===cl?(cl==="VENCEDORES"?"#3D1B6B":"#FFFFFF"):"#2D1B4E"),padding:"8px 16px",borderRadius:20,fontSize:13}} onClick={()=>setSelClase(cl)}>{cl}</button>
          ))}
        </div>
        <button style={{...S.btn("#4BBCE0","#FFFFFF",true),padding:"12px 20px",borderRadius:12,fontSize:14,width:"100%"}} onClick={reportClase}>
           Generar PDF  Clase {selClase} ({(clases[selClase]||[]).length} alumnos)
        </button>
      </div>

      {/* Report 4 - Individual Student */}
      <div style={{...S.card,borderLeft:"5px solid #4CAF50"}}>
        <div style={{fontWeight:800,fontSize:15,color:"#2E7D32",marginBottom:4}}> Informe Individual de Alumno</div>
        <div style={{fontSize:12,color:"#7B6B9A",marginBottom:12}}>Ficha personal con historial completo de asistencias, calificaciones y observaciones.</div>
        <label style={S.label}>Seleccionar Alumno</label>
        <select style={{...S.input,marginBottom:14}} value={selNino} onChange={e=>setSelNino(e.target.value)}>
          {ninos.sort((a,b)=>flipName(a.nombre).localeCompare(flipName(b.nombre),"es")).map(n=>(
            <option key={n.nombre+n.clase} value={n.nombre}>{flipName(n.nombre)}  {n.clase}</option>
          ))}
        </select>
        <button style={{...S.btn("#4CAF50","#FFFFFF",true),padding:"12px 20px",borderRadius:12,fontSize:14,width:"100%"}} onClick={reportNino}>
           Generar Informe  {selNino?flipName(selNino):"Selecciona uno"}
        </button>
      </div>
    </div>
  );
}

//  PETICIONES DE ORACIN 
function PeticionesDashboard({peticiones,user,onUpdate}){
  const recent=(peticiones||[]).slice().sort((a,b)=>new Date(b.fecha)-new Date(a.fecha)).slice(0,5);
  if(!recent.length) return null;
  return(
    <div style={{...S.card,borderLeft:"5px solid #E84F9B",margin:"0 0 14px"}}>
      <div style={{fontWeight:800,color:"#E84F9B",fontSize:15,marginBottom:10}}> Peticiones de Oracin</div>
      {recent.map((p,i)=>(
        <div key={p.id} style={{padding:"8px 0",borderBottom:i<recent.length-1?"1px solid #DDD0F0":"none"}}>
          <div style={{fontSize:13,color:"#2D1B4E",lineHeight:1.5}}>{p.texto}</div>
          <div style={{fontSize:11,color:"#7B6B9A",marginTop:3}}>
            {p.anonimo?" Annimo":flipName(p.autor)}  {p.fecha?new Date(p.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"short"}):""}
          </div>
        </div>
      ))}
    </div>
  );
}

function PeticionesPanel({peticiones,user,onUpdate,isAdmin=false}){
  const[modal,setModal]=useState(false);
  const[form,setForm]=useState({texto:"",anonimo:false});
  const[editId,setEditId]=useState(null);
  const sorted=(peticiones||[]).slice().sort((a,b)=>new Date(b.fecha)-new Date(a.fecha));
  const canEdit=(p)=>isAdmin||p.autor===user;
  const openAdd=()=>{setForm({texto:"",anonimo:false});setEditId(null);setModal(true);};
  const openEdit=(p)=>{setForm({texto:p.texto,anonimo:p.anonimo});setEditId(p.id);setModal(true);};
  const save=()=>{
    if(!form.texto.trim())return;
    if(editId){
      onUpdate((peticiones||[]).map(p=>p.id===editId?{...p,texto:form.texto,anonimo:form.anonimo}:p));
    } else {
      onUpdate([...((peticiones||[])),{id:Date.now(),texto:form.texto,autor:user,anonimo:form.anonimo,fecha:new Date().toISOString()}]);
    }
    setModal(false);
  };
  return(
    <div style={{padding:"16px 0 20px"}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
        <h2 style={{...S.title,margin:0}}> Peticiones</h2>
        <button style={{...S.btn("#E84F9B"),padding:"10px 16px",fontSize:14}} onClick={openAdd}>+ Nueva</button>
      </div>
      {sorted.length===0&&<div style={{color:"#7B6B9A",textAlign:"center",padding:30,fontStyle:"italic"}}>Sin peticiones. Aade la primera!</div>}
      {sorted.map(p=>(
        <div key={p.id} style={{...S.card,borderLeft:"5px solid #E84F9B",padding:"14px 16px"}}>
          <div style={{fontSize:14,color:"#2D1B4E",lineHeight:1.6,marginBottom:8}}>{p.texto}</div>
          <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:6}}>
            <div style={{fontSize:12,color:"#7B6B9A",display:"flex",alignItems:"center",gap:6}}>
              {p.anonimo?<span style={{...S.badge("#7B6B9A"),fontSize:11}}> Annimo</span>:<span style={{...S.badge("#5B2D8E"),fontSize:11}}> {flipName(p.autor)}</span>}
              <span> {p.fecha?new Date(p.fecha).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}):""}</span>
            </div>
            {canEdit(p)&&(
              <button style={{...S.btn("#4BBCE0"),padding:"5px 10px",fontSize:12}} onClick={()=>openEdit(p)}></button>
            )}
          </div>
        </div>
      ))}
      <Modal open={modal} onClose={()=>setModal(false)} title={editId?"Editar Peticin":"Nueva Peticin de Oracin"}>
        <div style={{background:"#FFF0F8",borderRadius:12,padding:"12px 14px",marginBottom:14,fontSize:13,color:"#7B6B9A"}}>Las peticiones son visibles para todos los maestros y auxiliares. Puedes hacerla annima si lo prefieres.</div>
        <label style={S.label}>Peticin</label>
        <textarea style={{...S.input,height:100,resize:"vertical",marginBottom:16}} value={form.texto} onChange={e=>setForm(f=>({...f,texto:e.target.value}))} placeholder="Escribe tu peticin de oracin..."/>
        <label style={{display:"flex",alignItems:"center",gap:10,cursor:"pointer",marginBottom:20,padding:"12px 14px",background:"#F5F0FF",borderRadius:12}}>
          <input type="checkbox" checked={!!form.anonimo} onChange={e=>setForm(f=>({...f,anonimo:e.target.checked}))} style={{width:22,height:22,accentColor:"#5B2D8E"}}/>
          <div>
            <div style={{fontWeight:700,fontSize:14}}> Peticin annima</div>
            <div style={{fontSize:12,color:"#7B6B9A"}}>Tu nombre no aparecer</div>
          </div>
        </label>
        <button style={{...S.btn("#E84F9B","#FFFFFF",true),padding:14}} onClick={save}> Guardar Peticin</button>
        {editId&&<button style={{...S.btn("#FFF0F0","#EF5350"),padding:12,marginTop:10,border:"1.5px solid #EF535044"}} onClick={()=>{if(confirmDelete("Eliminar esta peticin de oracin?")){onUpdate((peticiones||[]).filter(x=>x.id!==editId));setModal(false);}}}> Eliminar Peticin</button>}
      </Modal>
    </div>
  );
}

//  ADMIN APP 
function AdminApp({data,onUpdateData,onLogout}){
  const[activeTab,setActiveTab]=useState("dashboard");
  const[masTab,setMasTab]=useState("clases");
  const tabs=[{id:"alumnos",label:"Alumnos",icon:""},{id:"dashboard",label:"Inicio",icon:""},{id:"cronograma",label:"Horario",icon:""},{id:"calificaciones",label:"Calif.",icon:""},{id:"maestros",label:"Maestros",icon:""},{id:"mas",label:"Ms",icon:""}];
  const useAlumnosSource=!(data.alumnos&&Array.isArray(data.alumnos)&&data.alumnos.length>0)?false:true;
  return(
    <div style={{background:"#F5F0FF",minHeight:"100dvh",paddingBottom:70}}>
      <div style={{background:"linear-gradient(135deg,#3D1B6B,#5B2D8E)",padding:"0.75rem 1rem",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 2px 12px rgba(0,0,0,0.15)",position:"sticky",top:0,zIndex:100}}>
        <LogoImg height={38}/>
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          <span style={{background:"#F5C84233",color:"#F5C842",borderRadius:20,padding:"4px 12px",fontSize:12,fontWeight:800}}> ADMIN</span>
          <button style={{background:"rgba(255,255,255,0.18)",border:"none",borderRadius:10,padding:"8px 12px",color:"#FFFFFF",fontWeight:700,fontSize:13,cursor:"pointer"}} onClick={onLogout}> Salir</button>
        </div>
      </div>
      <div>
        {activeTab==="alumnos"&&<AlumnosPanel alumnos={data.alumnos||[]} onUpdateAlumnos={v=>onUpdateData("alumnos",v)} clasesConfig={data.clasesConfig}/>}
        {activeTab==="dashboard"&&<AdminDashboard data={data}/>}
        {activeTab==="cronograma"&&<CronogramaPanel cronograma={data.cronograma} maestros={data.maestros} onUpdate={v=>onUpdateData("cronograma",v)}/>}
        {activeTab==="calificaciones"&&<CalifAdminPanel calificaciones={data.calificaciones} clases={data.clases} criterios={data.criterios||CRITERIOS} onUpdate={v=>onUpdateData("calificaciones",v)} cronograma={data.cronograma} meriendas={data.meriendas||[]}/>}
        {activeTab==="maestros"&&<MaestrosPanel maestros={data.maestros} onUpdate={v=>onUpdateData("maestros",v)}/>}
        {activeTab==="mas"&&(
          <div style={{padding:"1rem 1rem 0"}}>
            <div style={{display:"flex",gap:8,overflowX:"auto",marginBottom:16,paddingBottom:4}}>
              {[["clases"," Clases"],["familias"," Familias"],["eventos"," Eventos"],["videos"," Videos"],["evaluaciones"," Evaluac."],["cumpleanos"," Cumple."],["peticiones"," Oracin"],["informes"," Informes"]].map(([id,label])=>(
                <button key={id} style={{...S.btn(masTab===id?"#5B2D8E":"#F5F0FF",masTab===id?"#FFFFFF":"#2D1B4E"),padding:"8px 14px",fontSize:13,flexShrink:0,borderRadius:20,whiteSpace:"nowrap"}} onClick={()=>setMasTab(id)}>{label}</button>
              ))}
            </div>
            {masTab==="clases"&&<ClasesPanel readOnlyStudents={useAlumnosSource} clases={data.clases} onUpdate={useAlumnosSource?()=>{}:v=>onUpdateData("clases",v)} clasesConfig={data.clasesConfig} onUpdateClasesConfig={v=>onUpdateData("clasesConfig",v)} calificaciones={data.calificaciones} familias={data.familias} onUpdateFamilias={useAlumnosSource?()=>{}:v=>onUpdateData("familias",v)}/>}
            {masTab==="familias"&&<FamiliasPanel readOnly={useAlumnosSource} familias={data.familias} onUpdate={useAlumnosSource?()=>{}:v=>onUpdateData("familias",v)} clases={data.clases} onUpdateClases={useAlumnosSource?()=>{}:v=>onUpdateData("clases",v)}/>}
            {masTab==="eventos"&&<EventosPanel eventos={data.eventos} onUpdate={v=>onUpdateData("eventos",v)}/>}
            {masTab==="videos"&&<VideosPanel videos={data.videos||[]} onUpdate={v=>onUpdateData("videos",v)} cronograma={data.cronograma} maestros={data.maestros}/>}
            {masTab==="evaluaciones"&&<EvaluacionesPanel evaluaciones={data.evaluaciones} onUpdate={v=>onUpdateData("evaluaciones",v)} videos={data.videos||[]}/>}
            {masTab==="cumpleanos"&&<CumpleanosPanel maestros={data.maestros} familias={data.familias}/>}
            {masTab==="peticiones"&&<PeticionesPanel peticiones={data.peticiones} user="admin" onUpdate={v=>onUpdateData("peticiones",v)} isAdmin/>}
            {masTab==="informes"&&<InformesPanel data={data}/>}
          </div>
        )}
      </div>
      <BottomNav tabs={tabs} active={activeTab} onSelect={setActiveTab}/>
    </div>
  );
}

//  MAIN 
function App(){
  const[user,setUser]=useState(null);
  const[loading,setLoading]=useState(true);
  const[teacherPasswords,setTeacherPasswords]=useState({});
  const[data,setData]=useState({
    maestros:INITIAL_MAESTROS,
    clases:INITIAL_CLASES,
    cronograma:INITIAL_CRONOGRAMA,
    familias:INITIAL_FAMILIAS,
    alumnos:INITIAL_ALUMNOS,
    eventos:INITIAL_EVENTOS,
    evaluaciones:INITIAL_EVALUACIONES,
    calificaciones:[],
    criterios:CRITERIOS,
    peticiones:[],
    meriendas:[],
    clasesConfig:DEFAULT_CLASES_CONFIG,
    videos:[],
  });
  useEffect(()=>{
    (async()=>{
      try{
        const loaded={};
        for(const k of["maestros","clases","cronograma","familias","alumnos","eventos","evaluaciones","calificaciones","peticiones","meriendas","clasesConfig","videos"]){
          const v=await loadData(k);if(v!==null)loaded[k]=v;
        }
        const familias=loaded.familias??INITIAL_FAMILIAS;
        let alumnos=loaded.alumnos;
        if(alumnos==null||!Array.isArray(alumnos)||alumnos.length===0){
          if(familias&&Array.isArray(familias)&&familias.length>0){
            alumnos=familias.map(f=>({ id:f.id, nombre:(f.alumno||"").trim(), clase:(f.clase||"").trim().toUpperCase().replace(/\s+/g,"_")||"CORDERITOS", nacimiento:f.nacimiento||null, padre:f.padre||"", madre:f.madre||"", telPadre:f.telPadre||"", telMadre:f.telMadre||"", familia:f.familia||"", bautizado:!!f.bautizado, sellado:!!f.sellado, foto:f.foto||null }));
            saveData("alumnos",alumnos);
          }else alumnos=INITIAL_ALUMNOS;
        }
        const dataToSet={ maestros:loaded.maestros??INITIAL_MAESTROS, clases:loaded.clases??INITIAL_CLASES, cronograma:loaded.cronograma??INITIAL_CRONOGRAMA, familias, alumnos, eventos:loaded.eventos??INITIAL_EVENTOS, evaluaciones:loaded.evaluaciones??INITIAL_EVALUACIONES, calificaciones:loaded.calificaciones??[], criterios:CRITERIOS, peticiones:loaded.peticiones??[], meriendas:loaded.meriendas??[], clasesConfig:loaded.clasesConfig??DEFAULT_CLASES_CONFIG, videos:loaded.videos??[] };
        setData(dataToSet);
        const pw=await loadData("teacherPasswords");if(pw)setTeacherPasswords(pw);
      }catch(e){}
      setLoading(false);
    })();
  },[]);
  useEffect(()=>{
    if(!db)return;
    const unsub=subscribeData((key,val)=>{
      if(key==="teacherPasswords")setTeacherPasswords(val||{});
      else setData(d=>({...d,[key]:val}));
    });
    return unsub;
  },[]);
  const updateData=useCallback(async(key,val)=>{setData(d=>({...d,[key]:val}));await saveData(key,val);},[]);
  const updatePw=useCallback(async(pws)=>{setTeacherPasswords(pws);await saveData("teacherPasswords",pws);},[]);
  if(loading){
    return(
      <div style={{minHeight:"100dvh",background:"linear-gradient(160deg,#3D1B6B,#5B2D8E)",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:20}}>
        <LogoLogin/>
        <div style={{color:"#FFFFFF",fontSize:16,fontWeight:700}}>Cargando...</div>
      </div>
    );
  }
  const dataWithDerived=useMemo(()=>{
    try {
      const d=data||{};
      const alumnos=d.alumnos;
      const cfg=d.clasesConfig||DEFAULT_CLASES_CONFIG;
      let clases=d.clases;
      let familias=d.familias;
      if(alumnos&&Array.isArray(alumnos)&&alumnos.length>0){
        clases=deriveClases(alumnos,cfg);
        familias=deriveFamilias(alumnos);
      }
      if(!clases||typeof clases!=="object")clases=INITIAL_CLASES;
      if(!Array.isArray(familias))familias=INITIAL_FAMILIAS;
      return { ...d, clases, familias };
    }catch(err){ console.error("dataWithDerived",err); return { ...(data||{}), clases: data?.clases||INITIAL_CLASES, familias: Array.isArray(data?.familias)?data.familias:INITIAL_FAMILIAS }; }
  },[data]);
  const screen = !user
    ? <LoginScreen onLogin={setUser}/>
    : user==="admin"
      ? <AdminApp data={dataWithDerived} onUpdateData={updateData} onLogout={()=>setUser(null)}/>
      : <TeacherApp user={user} data={dataWithDerived} onLogout={()=>setUser(null)} onUpdateData={updateData} teacherPasswords={teacherPasswords} onUpdatePasswords={updatePw}/>;
  return (
    <ErrorBoundary>
      <div style={{width:"100%",maxWidth:"100vw",overflowX:"hidden",minHeight:"100dvh",touchAction:"pan-y pinch-zoom",position:"relative"}}>
        {screen}
      </div>
    </ErrorBoundary>
  );
}

const rootElement = document.getElementById("root");
if (rootElement) {
  const root = ReactDOM.createRoot(rootElement);
  root.render(<App />);
}
